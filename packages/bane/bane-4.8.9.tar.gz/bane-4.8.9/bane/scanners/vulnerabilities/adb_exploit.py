from bane.scanners.vulnerabilities.utils import *


def adb_exploit(u, timeout=5, p=5555):
    try:
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.settimeout(timeout)
        s.connect((u, p))
        s.send(
            b"CNXN\x00\x00\x00\x01\x00\x10\x00\x00\x07\x00\x00\x00\x32\x02\x00\x00\xbc\xb1\xa7\xb1host::\x00"
        )
        c = s.recv(4096)
        s.close()
        if "CNXN" in str(c):
            return True
    except:
        pass
    return False

