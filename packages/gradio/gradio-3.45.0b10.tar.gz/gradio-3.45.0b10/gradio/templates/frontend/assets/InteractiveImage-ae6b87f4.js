import{a as be,i as ve,s as le,I as $,b as m,d as O,f as Q,n as Y,h as T,e as J,y as ee,c as j,k as y,B as we,l as E,C as ye,H as st,aa as Gt,J as ie,a2 as gr,w as q,j as L,m as H,o as P,G as Pe,F as V,V as ge,U as ri,a3 as Ft,a9 as qi,W as _r,R as Le,af as pr,ag as ni,Y as ai,M as br,O as Gi,K as Fi,Z as kt,a5 as vr,x as _e,D as pe,p as wr,u as yr,q as kr,r as Dr,v as Er,S as Mr,z as Or,A as Tr}from"./index-921c1568.js";import{f as si,n as Je,B as Cr}from"./Button-b905ffac.js";import{B as Rr}from"./BlockLabel-08158c7f.js";import{I as oi}from"./Image-de9e2d13.js";import{g as Ar}from"./utils-90f3612b.js";import{I as rt}from"./IconButton-a3e6052f.js";import{C as Sr,M as Ot}from"./ModifyUpload-c1ac23d5.js";import{U as Ir}from"./Undo-835ec982.js";import{U as Nr}from"./Upload-d8f7bd1a.js";import{U as zr}from"./UploadText-f0c0dac9.js";function Br(r){let e,t,i;return{c(){e=$("svg"),t=$("path"),i=$("path"),m(t,"d","M28.828 3.172a4.094 4.094 0 0 0-5.656 0L4.05 22.292A6.954 6.954 0 0 0 2 27.242V30h2.756a6.952 6.952 0 0 0 4.95-2.05L28.828 8.829a3.999 3.999 0 0 0 0-5.657zM10.91 18.26l2.829 2.829l-2.122 2.121l-2.828-2.828zm-2.619 8.276A4.966 4.966 0 0 1 4.756 28H4v-.759a4.967 4.967 0 0 1 1.464-3.535l1.91-1.91l2.829 2.828zM27.415 7.414l-12.261 12.26l-2.829-2.828l12.262-12.26a2.047 2.047 0 0 1 2.828 0a2 2 0 0 1 0 2.828z"),m(t,"fill","currentColor"),m(i,"d","M6.5 15a3.5 3.5 0 0 1-2.475-5.974l3.5-3.5a1.502 1.502 0 0 0 0-2.121a1.537 1.537 0 0 0-2.121 0L3.415 5.394L2 3.98l1.99-1.988a3.585 3.585 0 0 1 4.95 0a3.504 3.504 0 0 1 0 4.949L5.439 10.44a1.502 1.502 0 0 0 0 2.121a1.537 1.537 0 0 0 2.122 0l4.024-4.024L13 9.95l-4.025 4.024A3.475 3.475 0 0 1 6.5 15z"),m(i,"fill","currentColor"),m(e,"width","100%"),m(e,"height","100%"),m(e,"viewBox","0 0 32 32")},m(a,n){O(a,e,n),Q(e,t),Q(e,i)},p:Y,i:Y,o:Y,d(a){a&&T(e)}}}class Lr extends be{constructor(e){super(),ve(this,e,null,Br,le,{})}}function Hr(r){let e,t,i;return{c(){e=$("svg"),t=$("path"),i=$("circle"),m(t,"d","M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"),m(i,"cx","12"),m(i,"cy","13"),m(i,"r","4"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"width","100%"),m(e,"height","100%"),m(e,"viewBox","0 0 24 24"),m(e,"fill","none"),m(e,"stroke","currentColor"),m(e,"stroke-width","1.5"),m(e,"stroke-linecap","round"),m(e,"stroke-linejoin","round"),m(e,"class","feather feather-camera")},m(a,n){O(a,e,n),Q(e,t),Q(e,i)},p:Y,i:Y,o:Y,d(a){a&&T(e)}}}class Pr extends be{constructor(e){super(),ve(this,e,null,Hr,le,{})}}function Wr(r){let e,t;return{c(){e=$("svg"),t=$("circle"),m(t,"cx","12"),m(t,"cy","12"),m(t,"r","10"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"width","100%"),m(e,"height","100%"),m(e,"viewBox","0 0 24 24"),m(e,"fill","red"),m(e,"stroke","red"),m(e,"stroke-width","1.5"),m(e,"stroke-linecap","round"),m(e,"stroke-linejoin","round"),m(e,"class","feather feather-circle")},m(i,a){O(i,e,a),Q(e,t)},p:Y,i:Y,o:Y,d(i){i&&T(e)}}}class Yr extends be{constructor(e){super(),ve(this,e,null,Wr,le,{})}}function Xr(r){let e,t,i,a,n,s,l;return{c(){e=$("svg"),t=$("circle"),i=$("circle"),a=$("circle"),n=$("circle"),s=$("circle"),l=$("path"),m(t,"cx","10"),m(t,"cy","12"),m(t,"r","2"),m(t,"fill","currentColor"),m(i,"cx","16"),m(i,"cy","9"),m(i,"r","2"),m(i,"fill","currentColor"),m(a,"cx","22"),m(a,"cy","12"),m(a,"r","2"),m(a,"fill","currentColor"),m(n,"cx","23"),m(n,"cy","18"),m(n,"r","2"),m(n,"fill","currentColor"),m(s,"cx","19"),m(s,"cy","23"),m(s,"r","2"),m(s,"fill","currentColor"),m(l,"fill","currentColor"),m(l,"d","M16.54 2A14 14 0 0 0 2 16a4.82 4.82 0 0 0 6.09 4.65l1.12-.31a3 3 0 0 1 3.79 2.9V27a3 3 0 0 0 3 3a14 14 0 0 0 14-14.54A14.05 14.05 0 0 0 16.54 2Zm8.11 22.31A11.93 11.93 0 0 1 16 28a1 1 0 0 1-1-1v-3.76a5 5 0 0 0-5-5a5.07 5.07 0 0 0-1.33.18l-1.12.31A2.82 2.82 0 0 1 4 16A12 12 0 0 1 16.47 4A12.18 12.18 0 0 1 28 15.53a11.89 11.89 0 0 1-3.35 8.79Z"),m(e,"width","100%"),m(e,"height","100%"),m(e,"viewBox","0 0 32 32")},m(o,h){O(o,e,h),Q(e,t),Q(e,i),Q(e,a),Q(e,n),Q(e,s),Q(e,l)},p:Y,i:Y,o:Y,d(o){o&&T(e)}}}class Ur extends be{constructor(e){super(),ve(this,e,null,Xr,le,{})}}function jr(r){let e,t;return{c(){e=$("svg"),t=$("path"),m(t,"fill","currentColor"),m(t,"d","M7 27h23v2H7zm20.38-16.49l-7.93-7.92a2 2 0 0 0-2.83 0l-14 14a2 2 0 0 0 0 2.83L7.13 24h9.59l10.66-10.66a2 2 0 0 0 0-2.83zM15.89 22H8l-4-4l6.31-6.31l7.93 7.92zm3.76-3.76l-7.92-7.93L18 4l8 7.93z"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"width","100%"),m(e,"height","100%"),m(e,"viewBox","0 0 32 32")},m(i,a){O(i,e,a),Q(e,t)},p:Y,i:Y,o:Y,d(i){i&&T(e)}}}class Vr extends be{constructor(e){super(),ve(this,e,null,jr,le,{})}}function qr(r){let e,t;return{c(){e=$("svg"),t=$("path"),m(t,"d","M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"width","100%"),m(e,"height","100%"),m(e,"viewBox","0 0 24 24"),m(e,"fill","none"),m(e,"stroke","currentColor"),m(e,"stroke-width","1.5"),m(e,"stroke-linecap","round"),m(e,"stroke-linejoin","round"),m(e,"class","feather feather-edit-2")},m(i,a){O(i,e,a),Q(e,t)},p:Y,i:Y,o:Y,d(i){i&&T(e)}}}let li=class extends be{constructor(e){super(),ve(this,e,null,qr,le,{})}};function Gr(r){let e,t;return{c(){e=$("svg"),t=$("rect"),m(t,"x","3"),m(t,"y","3"),m(t,"width","18"),m(t,"height","18"),m(t,"rx","2"),m(t,"ry","2"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"width","100%"),m(e,"height","100%"),m(e,"viewBox","0 0 24 24"),m(e,"fill","red"),m(e,"stroke","red"),m(e,"stroke-width","1.5"),m(e,"stroke-linecap","round"),m(e,"stroke-linejoin","round"),m(e,"class","feather feather-square")},m(i,a){O(i,e,a),Q(e,t)},p:Y,i:Y,o:Y,d(i){i&&T(e)}}}class Fr extends be{constructor(e){super(),ve(this,e,null,Gr,le,{})}}function hi(r){let e,t,i,a,n,s;const l=[Kr,Zr],o=[];function h(u,c){return u[1]==="video"?0:1}return t=h(r),i=o[t]=l[t](r),{c(){e=J("button"),i.c(),m(e,"class","svelte-425ent")},m(u,c){O(u,e,c),o[t].m(e,null),a=!0,n||(s=ie(e,"click",function(){gr(r[1]==="image"?r[5]:r[6])&&(r[1]==="image"?r[5]:r[6]).apply(this,arguments)}),n=!0)},p(u,c){r=u;let f=t;t=h(r),t===f?o[t].p(r,c):(we(),E(o[f],1,1,()=>{o[f]=null}),ye(),i=o[t],i?i.p(r,c):(i=o[t]=l[t](r),i.c()),y(i,1),i.m(e,null))},i(u){a||(y(i),a=!0)},o(u){E(i),a=!1},d(u){u&&T(e),o[t].d(),n=!1,s()}}}function Zr(r){let e,t,i;return t=new Pr({}),{c(){e=J("div"),L(t.$$.fragment),m(e,"class","icon svelte-425ent")},m(a,n){O(a,e,n),H(t,e,null),i=!0},p:Y,i(a){i||(y(t.$$.fragment,a),i=!0)},o(a){E(t.$$.fragment,a),i=!1},d(a){a&&T(e),P(t)}}}function Kr(r){let e,t,i,a;const n=[Jr,Qr],s=[];function l(o,h){return o[4]?0:1}return e=l(r),t=s[e]=n[e](r),{c(){t.c(),i=Pe()},m(o,h){s[e].m(o,h),O(o,i,h),a=!0},p(o,h){let u=e;e=l(o),e!==u&&(we(),E(s[u],1,1,()=>{s[u]=null}),ye(),t=s[e],t||(t=s[e]=n[e](o),t.c()),y(t,1),t.m(i.parentNode,i))},i(o){a||(y(t),a=!0)},o(o){E(t),a=!1},d(o){o&&T(i),s[e].d(o)}}}function Qr(r){let e,t,i;return t=new Yr({}),{c(){e=J("div"),L(t.$$.fragment),m(e,"class","icon svelte-425ent")},m(a,n){O(a,e,n),H(t,e,null),i=!0},i(a){i||(y(t.$$.fragment,a),i=!0)},o(a){E(t.$$.fragment,a),i=!1},d(a){a&&T(e),P(t)}}}function Jr(r){let e,t,i;return t=new Fr({}),{c(){e=J("div"),L(t.$$.fragment),m(e,"class","icon svelte-425ent")},m(a,n){O(a,e,n),H(t,e,null),i=!0},i(a){i||(y(t.$$.fragment,a),i=!0)},o(a){E(t.$$.fragment,a),i=!1},d(a){a&&T(e),P(t)}}}function xr(r){let e,t,i,a,n=!r[0]&&hi(r);return{c(){e=J("div"),t=J("video"),i=ee(),n&&n.c(),m(t,"class","svelte-425ent"),j(t,"flip",r[2]),m(e,"class","wrap svelte-425ent")},m(s,l){O(s,e,l),Q(e,t),r[10](t),Q(e,i),n&&n.m(e,null),a=!0},p(s,[l]){(!a||l&4)&&j(t,"flip",s[2]),s[0]?n&&(we(),E(n,1,1,()=>{n=null}),ye()):n?(n.p(s,l),l&1&&y(n,1)):(n=hi(s),n.c(),y(n,1),n.m(e,null))},i(s){a||(y(n),a=!0)},o(s){E(n),a=!1},d(s){s&&T(e),r[10](null),n&&n.d()}}}function $r(r,e,t){let i,a,{streaming:n=!1}=e,{pending:s=!1}=e,{mode:l="image"}=e,{mirror_webcam:o}=e,{include_audio:h}=e,{i18n:u}=e;const c=st();Gt(()=>a=document.createElement("canvas"));async function f(){try{D=await navigator.mediaDevices.getUserMedia({video:!0,audio:h}),t(3,i.srcObject=D,i),t(3,i.muted=!0,i),i.play()}catch(w){if(w instanceof DOMException&&w.name=="NotAllowedError")c("error",u("image.allow_webcam_access"));else throw w}}function d(){var w=a.getContext("2d");if(i.videoWidth&&i.videoHeight){a.width=i.videoWidth,a.height=i.videoHeight,w.drawImage(i,0,0,i.videoWidth,i.videoHeight);var g=a.toDataURL("image/png");c(n?"stream":"capture",g)}}let _=!1,v=[],D,I,A;function N(){if(_){A.stop();let w=new Blob(v,{type:I}),g=new FileReader;g.onload=function(M){M.target&&(c("capture",{data:M.target.result,name:"sample."+I.substring(6),is_example:!1,is_file:!1}),c("stop_recording"))},g.readAsDataURL(w)}else{c("start_recording"),v=[];let w=["video/webm","video/mp4"];for(let g of w)if(MediaRecorder.isTypeSupported(g)){I=g;break}if(I===null){console.error("No supported MediaRecorder mimeType");return}A=new MediaRecorder(D,{mimeType:I}),A.addEventListener("dataavailable",function(g){v.push(g.data)}),A.start(200)}t(4,_=!_)}f(),n&&l==="image"&&window.setInterval(()=>{i&&!s&&d()},500);function W(w){q[w?"unshift":"push"](()=>{i=w,t(3,i)})}return r.$$set=w=>{"streaming"in w&&t(0,n=w.streaming),"pending"in w&&t(7,s=w.pending),"mode"in w&&t(1,l=w.mode),"mirror_webcam"in w&&t(2,o=w.mirror_webcam),"include_audio"in w&&t(8,h=w.include_audio),"i18n"in w&&t(9,u=w.i18n)},[n,l,o,i,_,d,N,s,h,u,W]}class en extends be{constructor(e){super(),ve(this,e,$r,xr,le,{streaming:0,pending:7,mode:1,mirror_webcam:2,include_audio:8,i18n:9})}}const tn=en;/*!
 * Cropper.js v1.5.12
 * https://fengyuanchen.github.io/cropperjs
 *
 * Copyright 2015-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2021-06-12T08:00:17.411Z
 */function ui(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(r,a).enumerable})),t.push.apply(t,i)}return t}function Zi(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ui(Object(t),!0).forEach(function(i){an(r,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):ui(Object(t)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(t,i))})}return r}function yt(r){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?yt=function(e){return typeof e}:yt=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yt(r)}function rn(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function ci(r,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,i.key,i)}}function nn(r,e,t){return e&&ci(r.prototype,e),t&&ci(r,t),r}function an(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function Ki(r){return sn(r)||on(r)||ln(r)||hn()}function sn(r){if(Array.isArray(r))return Lt(r)}function on(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function ln(r,e){if(r){if(typeof r=="string")return Lt(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Lt(r,e)}}function Lt(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=r[t];return i}function hn(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Tt=typeof window<"u"&&typeof window.document<"u",Ce=Tt?window:{},Zt=Tt&&Ce.document.documentElement?"ontouchstart"in Ce.document.documentElement:!1,Kt=Tt?"PointerEvent"in Ce:!1,F="cropper",Qt="all",Qi="crop",Ji="move",xi="zoom",ze="e",Be="w",je="s",Ae="n",xe="ne",$e="nw",et="se",tt="sw",Ht="".concat(F,"-crop"),fi="".concat(F,"-disabled"),me="".concat(F,"-hidden"),di="".concat(F,"-hide"),un="".concat(F,"-invisible"),Dt="".concat(F,"-modal"),Pt="".concat(F,"-move"),nt="".concat(F,"Action"),vt="".concat(F,"Preview"),Jt="crop",$i="move",er="none",Wt="crop",Yt="cropend",Xt="cropmove",Ut="cropstart",mi="dblclick",cn=Zt?"touchstart":"mousedown",fn=Zt?"touchmove":"mousemove",dn=Zt?"touchend touchcancel":"mouseup",gi=Kt?"pointerdown":cn,_i=Kt?"pointermove":fn,pi=Kt?"pointerup pointercancel":dn,bi="ready",vi="resize",wi="wheel",jt="zoom",yi="image/jpeg",mn=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,gn=/^data:/,_n=/^data:image\/jpeg;base64,/,pn=/^img|canvas$/i,tr=200,ir=100,ki={viewMode:0,dragMode:Jt,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:tr,minContainerHeight:ir,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},bn='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>',vn=Number.isNaN||Ce.isNaN;function S(r){return typeof r=="number"&&!vn(r)}var Di=function(e){return e>0&&e<1/0};function zt(r){return typeof r>"u"}function He(r){return yt(r)==="object"&&r!==null}var wn=Object.prototype.hasOwnProperty;function Ve(r){if(!He(r))return!1;try{var e=r.constructor,t=e.prototype;return e&&t&&wn.call(t,"isPrototypeOf")}catch{return!1}}function de(r){return typeof r=="function"}var yn=Array.prototype.slice;function rr(r){return Array.from?Array.from(r):yn.call(r)}function re(r,e){return r&&de(e)&&(Array.isArray(r)||S(r.length)?rr(r).forEach(function(t,i){e.call(r,t,i,r)}):He(r)&&Object.keys(r).forEach(function(t){e.call(r,r[t],t,r)})),r}var Z=Object.assign||function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),a=1;a<t;a++)i[a-1]=arguments[a];return He(e)&&i.length>0&&i.forEach(function(n){He(n)&&Object.keys(n).forEach(function(s){e[s]=n[s]})}),e},kn=/\.\d*(?:0|9){12}\d*$/;function Ge(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return kn.test(r)?Math.round(r*e)/e:r}var Dn=/^width|height|left|top|marginLeft|marginTop$/;function Se(r,e){var t=r.style;re(e,function(i,a){Dn.test(a)&&S(i)&&(i="".concat(i,"px")),t[a]=i})}function En(r,e){return r.classList?r.classList.contains(e):r.className.indexOf(e)>-1}function ae(r,e){if(e){if(S(r.length)){re(r,function(i){ae(i,e)});return}if(r.classList){r.classList.add(e);return}var t=r.className.trim();t?t.indexOf(e)<0&&(r.className="".concat(t," ").concat(e)):r.className=e}}function Te(r,e){if(e){if(S(r.length)){re(r,function(t){Te(t,e)});return}if(r.classList){r.classList.remove(e);return}r.className.indexOf(e)>=0&&(r.className=r.className.replace(e,""))}}function qe(r,e,t){if(e){if(S(r.length)){re(r,function(i){qe(i,e,t)});return}t?ae(r,e):Te(r,e)}}var Mn=/([a-z\d])([A-Z])/g;function xt(r){return r.replace(Mn,"$1-$2").toLowerCase()}function Vt(r,e){return He(r[e])?r[e]:r.dataset?r.dataset[e]:r.getAttribute("data-".concat(xt(e)))}function at(r,e,t){He(t)?r[e]=t:r.dataset?r.dataset[e]=t:r.setAttribute("data-".concat(xt(e)),t)}function On(r,e){if(He(r[e]))try{delete r[e]}catch{r[e]=void 0}else if(r.dataset)try{delete r.dataset[e]}catch{r.dataset[e]=void 0}else r.removeAttribute("data-".concat(xt(e)))}var nr=/\s\s*/,ar=function(){var r=!1;if(Tt){var e=!1,t=function(){},i=Object.defineProperty({},"once",{get:function(){return r=!0,e},set:function(n){e=n}});Ce.addEventListener("test",t,i),Ce.removeEventListener("test",t,i)}return r}();function Ee(r,e,t){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},a=t;e.trim().split(nr).forEach(function(n){if(!ar){var s=r.listeners;s&&s[n]&&s[n][t]&&(a=s[n][t],delete s[n][t],Object.keys(s[n]).length===0&&delete s[n],Object.keys(s).length===0&&delete r.listeners)}r.removeEventListener(n,a,i)})}function De(r,e,t){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},a=t;e.trim().split(nr).forEach(function(n){if(i.once&&!ar){var s=r.listeners,l=s===void 0?{}:s;a=function(){delete l[n][t],r.removeEventListener(n,a,i);for(var h=arguments.length,u=new Array(h),c=0;c<h;c++)u[c]=arguments[c];t.apply(r,u)},l[n]||(l[n]={}),l[n][t]&&r.removeEventListener(n,l[n][t],i),l[n][t]=a,r.listeners=l}r.addEventListener(n,a,i)})}function Fe(r,e,t){var i;return de(Event)&&de(CustomEvent)?i=new CustomEvent(e,{detail:t,bubbles:!0,cancelable:!0}):(i=document.createEvent("CustomEvent"),i.initCustomEvent(e,!0,!0,t)),r.dispatchEvent(i)}function sr(r){var e=r.getBoundingClientRect();return{left:e.left+(window.pageXOffset-document.documentElement.clientLeft),top:e.top+(window.pageYOffset-document.documentElement.clientTop)}}var Bt=Ce.location,Tn=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function Ei(r){var e=r.match(Tn);return e!==null&&(e[1]!==Bt.protocol||e[2]!==Bt.hostname||e[3]!==Bt.port)}function Mi(r){var e="timestamp=".concat(new Date().getTime());return r+(r.indexOf("?")===-1?"?":"&")+e}function it(r){var e=r.rotate,t=r.scaleX,i=r.scaleY,a=r.translateX,n=r.translateY,s=[];S(a)&&a!==0&&s.push("translateX(".concat(a,"px)")),S(n)&&n!==0&&s.push("translateY(".concat(n,"px)")),S(e)&&e!==0&&s.push("rotate(".concat(e,"deg)")),S(t)&&t!==1&&s.push("scaleX(".concat(t,")")),S(i)&&i!==1&&s.push("scaleY(".concat(i,")"));var l=s.length?s.join(" "):"none";return{WebkitTransform:l,msTransform:l,transform:l}}function Cn(r){var e=Zi({},r),t=0;return re(r,function(i,a){delete e[a],re(e,function(n){var s=Math.abs(i.startX-n.startX),l=Math.abs(i.startY-n.startY),o=Math.abs(i.endX-n.endX),h=Math.abs(i.endY-n.endY),u=Math.sqrt(s*s+l*l),c=Math.sqrt(o*o+h*h),f=(c-u)/u;Math.abs(f)>Math.abs(t)&&(t=f)})}),t}function wt(r,e){var t=r.pageX,i=r.pageY,a={endX:t,endY:i};return e?a:Zi({startX:t,startY:i},a)}function Rn(r){var e=0,t=0,i=0;return re(r,function(a){var n=a.startX,s=a.startY;e+=n,t+=s,i+=1}),e/=i,t/=i,{pageX:e,pageY:t}}function Ie(r){var e=r.aspectRatio,t=r.height,i=r.width,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"contain",n=Di(i),s=Di(t);if(n&&s){var l=t*e;a==="contain"&&l>i||a==="cover"&&l<i?t=i/e:i=t*e}else n?t=i/e:s&&(i=t*e);return{width:i,height:t}}function An(r){var e=r.width,t=r.height,i=r.degree;if(i=Math.abs(i)%180,i===90)return{width:t,height:e};var a=i%90*Math.PI/180,n=Math.sin(a),s=Math.cos(a),l=e*s+t*n,o=e*n+t*s;return i>90?{width:o,height:l}:{width:l,height:o}}function Sn(r,e,t,i){var a=e.aspectRatio,n=e.naturalWidth,s=e.naturalHeight,l=e.rotate,o=l===void 0?0:l,h=e.scaleX,u=h===void 0?1:h,c=e.scaleY,f=c===void 0?1:c,d=t.aspectRatio,_=t.naturalWidth,v=t.naturalHeight,D=i.fillColor,I=D===void 0?"transparent":D,A=i.imageSmoothingEnabled,N=A===void 0?!0:A,W=i.imageSmoothingQuality,w=W===void 0?"low":W,g=i.maxWidth,M=g===void 0?1/0:g,R=i.maxHeight,X=R===void 0?1/0:R,B=i.minWidth,te=B===void 0?0:B,se=i.minHeight,U=se===void 0?0:se,x=document.createElement("canvas"),K=x.getContext("2d"),oe=Ie({aspectRatio:d,width:M,height:X}),ce=Ie({aspectRatio:d,width:te,height:U},"cover"),he=Math.min(oe.width,Math.max(ce.width,_)),ue=Math.min(oe.height,Math.max(ce.height,v)),Me=Ie({aspectRatio:a,width:M,height:X}),k=Ie({aspectRatio:a,width:te,height:U},"cover"),ke=Math.min(Me.width,Math.max(k.width,n)),We=Math.min(Me.height,Math.max(k.height,s)),Ye=[-ke/2,-We/2,ke,We];return x.width=Ge(he),x.height=Ge(ue),K.fillStyle=I,K.fillRect(0,0,he,ue),K.save(),K.translate(he/2,ue/2),K.rotate(o*Math.PI/180),K.scale(u,f),K.imageSmoothingEnabled=N,K.imageSmoothingQuality=w,K.drawImage.apply(K,[r].concat(Ki(Ye.map(function(Ke){return Math.floor(Ge(Ke))})))),K.restore(),x}var or=String.fromCharCode;function In(r,e,t){var i="";t+=e;for(var a=e;a<t;a+=1)i+=or(r.getUint8(a));return i}var Nn=/^data:.*,/;function zn(r){var e=r.replace(Nn,""),t=atob(e),i=new ArrayBuffer(t.length),a=new Uint8Array(i);return re(a,function(n,s){a[s]=t.charCodeAt(s)}),i}function Bn(r,e){for(var t=[],i=8192,a=new Uint8Array(r);a.length>0;)t.push(or.apply(null,rr(a.subarray(0,i)))),a=a.subarray(i);return"data:".concat(e,";base64,").concat(btoa(t.join("")))}function Ln(r){var e=new DataView(r),t;try{var i,a,n;if(e.getUint8(0)===255&&e.getUint8(1)===216)for(var s=e.byteLength,l=2;l+1<s;){if(e.getUint8(l)===255&&e.getUint8(l+1)===225){a=l;break}l+=1}if(a){var o=a+4,h=a+10;if(In(e,o,4)==="Exif"){var u=e.getUint16(h);if(i=u===18761,(i||u===19789)&&e.getUint16(h+2,i)===42){var c=e.getUint32(h+4,i);c>=8&&(n=h+c)}}}if(n){var f=e.getUint16(n,i),d,_;for(_=0;_<f;_+=1)if(d=n+_*12+2,e.getUint16(d,i)===274){d+=8,t=e.getUint16(d,i),e.setUint16(d,1,i);break}}}catch{t=1}return t}function Hn(r){var e=0,t=1,i=1;switch(r){case 2:t=-1;break;case 3:e=-180;break;case 4:i=-1;break;case 5:e=90,i=-1;break;case 6:e=90;break;case 7:e=90,t=-1;break;case 8:e=-90;break}return{rotate:e,scaleX:t,scaleY:i}}var Pn={render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var e=this.element,t=this.options,i=this.container,a=this.cropper,n=Number(t.minContainerWidth),s=Number(t.minContainerHeight);ae(a,me),Te(e,me);var l={width:Math.max(i.offsetWidth,n>=0?n:tr),height:Math.max(i.offsetHeight,s>=0?s:ir)};this.containerData=l,Se(a,{width:l.width,height:l.height}),ae(e,me),Te(a,me)},initCanvas:function(){var e=this.containerData,t=this.imageData,i=this.options.viewMode,a=Math.abs(t.rotate)%180===90,n=a?t.naturalHeight:t.naturalWidth,s=a?t.naturalWidth:t.naturalHeight,l=n/s,o=e.width,h=e.height;e.height*l>e.width?i===3?o=e.height*l:h=e.width/l:i===3?h=e.width/l:o=e.height*l;var u={aspectRatio:l,naturalWidth:n,naturalHeight:s,width:o,height:h};this.canvasData=u,this.limited=i===1||i===2,this.limitCanvas(!0,!0),u.width=Math.min(Math.max(u.width,u.minWidth),u.maxWidth),u.height=Math.min(Math.max(u.height,u.minHeight),u.maxHeight),u.left=(e.width-u.width)/2,u.top=(e.height-u.height)/2,u.oldLeft=u.left,u.oldTop=u.top,this.initialCanvasData=Z({},u)},limitCanvas:function(e,t){var i=this.options,a=this.containerData,n=this.canvasData,s=this.cropBoxData,l=i.viewMode,o=n.aspectRatio,h=this.cropped&&s;if(e){var u=Number(i.minCanvasWidth)||0,c=Number(i.minCanvasHeight)||0;l>1?(u=Math.max(u,a.width),c=Math.max(c,a.height),l===3&&(c*o>u?u=c*o:c=u/o)):l>0&&(u?u=Math.max(u,h?s.width:0):c?c=Math.max(c,h?s.height:0):h&&(u=s.width,c=s.height,c*o>u?u=c*o:c=u/o));var f=Ie({aspectRatio:o,width:u,height:c});u=f.width,c=f.height,n.minWidth=u,n.minHeight=c,n.maxWidth=1/0,n.maxHeight=1/0}if(t)if(l>(h?0:1)){var d=a.width-n.width,_=a.height-n.height;n.minLeft=Math.min(0,d),n.minTop=Math.min(0,_),n.maxLeft=Math.max(0,d),n.maxTop=Math.max(0,_),h&&this.limited&&(n.minLeft=Math.min(s.left,s.left+(s.width-n.width)),n.minTop=Math.min(s.top,s.top+(s.height-n.height)),n.maxLeft=s.left,n.maxTop=s.top,l===2&&(n.width>=a.width&&(n.minLeft=Math.min(0,d),n.maxLeft=Math.max(0,d)),n.height>=a.height&&(n.minTop=Math.min(0,_),n.maxTop=Math.max(0,_))))}else n.minLeft=-n.width,n.minTop=-n.height,n.maxLeft=a.width,n.maxTop=a.height},renderCanvas:function(e,t){var i=this.canvasData,a=this.imageData;if(t){var n=An({width:a.naturalWidth*Math.abs(a.scaleX||1),height:a.naturalHeight*Math.abs(a.scaleY||1),degree:a.rotate||0}),s=n.width,l=n.height,o=i.width*(s/i.naturalWidth),h=i.height*(l/i.naturalHeight);i.left-=(o-i.width)/2,i.top-=(h-i.height)/2,i.width=o,i.height=h,i.aspectRatio=s/l,i.naturalWidth=s,i.naturalHeight=l,this.limitCanvas(!0,!1)}(i.width>i.maxWidth||i.width<i.minWidth)&&(i.left=i.oldLeft),(i.height>i.maxHeight||i.height<i.minHeight)&&(i.top=i.oldTop),i.width=Math.min(Math.max(i.width,i.minWidth),i.maxWidth),i.height=Math.min(Math.max(i.height,i.minHeight),i.maxHeight),this.limitCanvas(!1,!0),i.left=Math.min(Math.max(i.left,i.minLeft),i.maxLeft),i.top=Math.min(Math.max(i.top,i.minTop),i.maxTop),i.oldLeft=i.left,i.oldTop=i.top,Se(this.canvas,Z({width:i.width,height:i.height},it({translateX:i.left,translateY:i.top}))),this.renderImage(e),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(e){var t=this.canvasData,i=this.imageData,a=i.naturalWidth*(t.width/t.naturalWidth),n=i.naturalHeight*(t.height/t.naturalHeight);Z(i,{width:a,height:n,left:(t.width-a)/2,top:(t.height-n)/2}),Se(this.image,Z({width:i.width,height:i.height},it(Z({translateX:i.left,translateY:i.top},i)))),e&&this.output()},initCropBox:function(){var e=this.options,t=this.canvasData,i=e.aspectRatio||e.initialAspectRatio,a=Number(e.autoCropArea)||.8,n={width:t.width,height:t.height};i&&(t.height*i>t.width?n.height=n.width/i:n.width=n.height*i),this.cropBoxData=n,this.limitCropBox(!0,!0),n.width=Math.min(Math.max(n.width,n.minWidth),n.maxWidth),n.height=Math.min(Math.max(n.height,n.minHeight),n.maxHeight),n.width=Math.max(n.minWidth,n.width*a),n.height=Math.max(n.minHeight,n.height*a),n.left=t.left+(t.width-n.width)/2,n.top=t.top+(t.height-n.height)/2,n.oldLeft=n.left,n.oldTop=n.top,this.initialCropBoxData=Z({},n)},limitCropBox:function(e,t){var i=this.options,a=this.containerData,n=this.canvasData,s=this.cropBoxData,l=this.limited,o=i.aspectRatio;if(e){var h=Number(i.minCropBoxWidth)||0,u=Number(i.minCropBoxHeight)||0,c=l?Math.min(a.width,n.width,n.width+n.left,a.width-n.left):a.width,f=l?Math.min(a.height,n.height,n.height+n.top,a.height-n.top):a.height;h=Math.min(h,a.width),u=Math.min(u,a.height),o&&(h&&u?u*o>h?u=h/o:h=u*o:h?u=h/o:u&&(h=u*o),f*o>c?f=c/o:c=f*o),s.minWidth=Math.min(h,c),s.minHeight=Math.min(u,f),s.maxWidth=c,s.maxHeight=f}t&&(l?(s.minLeft=Math.max(0,n.left),s.minTop=Math.max(0,n.top),s.maxLeft=Math.min(a.width,n.left+n.width)-s.width,s.maxTop=Math.min(a.height,n.top+n.height)-s.height):(s.minLeft=0,s.minTop=0,s.maxLeft=a.width-s.width,s.maxTop=a.height-s.height))},renderCropBox:function(){var e=this.options,t=this.containerData,i=this.cropBoxData;(i.width>i.maxWidth||i.width<i.minWidth)&&(i.left=i.oldLeft),(i.height>i.maxHeight||i.height<i.minHeight)&&(i.top=i.oldTop),i.width=Math.min(Math.max(i.width,i.minWidth),i.maxWidth),i.height=Math.min(Math.max(i.height,i.minHeight),i.maxHeight),this.limitCropBox(!1,!0),i.left=Math.min(Math.max(i.left,i.minLeft),i.maxLeft),i.top=Math.min(Math.max(i.top,i.minTop),i.maxTop),i.oldLeft=i.left,i.oldTop=i.top,e.movable&&e.cropBoxMovable&&at(this.face,nt,i.width>=t.width&&i.height>=t.height?Ji:Qt),Se(this.cropBox,Z({width:i.width,height:i.height},it({translateX:i.left,translateY:i.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),Fe(this.element,Wt,this.getData())}},Wn={initPreview:function(){var e=this.element,t=this.crossOrigin,i=this.options.preview,a=t?this.crossOriginUrl:this.url,n=e.alt||"The image to preview",s=document.createElement("img");if(t&&(s.crossOrigin=t),s.src=a,s.alt=n,this.viewBox.appendChild(s),this.viewBoxImage=s,!!i){var l=i;typeof i=="string"?l=e.ownerDocument.querySelectorAll(i):i.querySelector&&(l=[i]),this.previews=l,re(l,function(o){var h=document.createElement("img");at(o,vt,{width:o.offsetWidth,height:o.offsetHeight,html:o.innerHTML}),t&&(h.crossOrigin=t),h.src=a,h.alt=n,h.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',o.innerHTML="",o.appendChild(h)})}},resetPreview:function(){re(this.previews,function(e){var t=Vt(e,vt);Se(e,{width:t.width,height:t.height}),e.innerHTML=t.html,On(e,vt)})},preview:function(){var e=this.imageData,t=this.canvasData,i=this.cropBoxData,a=i.width,n=i.height,s=e.width,l=e.height,o=i.left-t.left-e.left,h=i.top-t.top-e.top;!this.cropped||this.disabled||(Se(this.viewBoxImage,Z({width:s,height:l},it(Z({translateX:-o,translateY:-h},e)))),re(this.previews,function(u){var c=Vt(u,vt),f=c.width,d=c.height,_=f,v=d,D=1;a&&(D=f/a,v=n*D),n&&v>d&&(D=d/n,_=a*D,v=d),Se(u,{width:_,height:v}),Se(u.getElementsByTagName("img")[0],Z({width:s*D,height:l*D},it(Z({translateX:-o*D,translateY:-h*D},e))))}))}},Yn={bind:function(){var e=this.element,t=this.options,i=this.cropper;de(t.cropstart)&&De(e,Ut,t.cropstart),de(t.cropmove)&&De(e,Xt,t.cropmove),de(t.cropend)&&De(e,Yt,t.cropend),de(t.crop)&&De(e,Wt,t.crop),de(t.zoom)&&De(e,jt,t.zoom),De(i,gi,this.onCropStart=this.cropStart.bind(this)),t.zoomable&&t.zoomOnWheel&&De(i,wi,this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),t.toggleDragModeOnDblclick&&De(i,mi,this.onDblclick=this.dblclick.bind(this)),De(e.ownerDocument,_i,this.onCropMove=this.cropMove.bind(this)),De(e.ownerDocument,pi,this.onCropEnd=this.cropEnd.bind(this)),t.responsive&&De(window,vi,this.onResize=this.resize.bind(this))},unbind:function(){var e=this.element,t=this.options,i=this.cropper;de(t.cropstart)&&Ee(e,Ut,t.cropstart),de(t.cropmove)&&Ee(e,Xt,t.cropmove),de(t.cropend)&&Ee(e,Yt,t.cropend),de(t.crop)&&Ee(e,Wt,t.crop),de(t.zoom)&&Ee(e,jt,t.zoom),Ee(i,gi,this.onCropStart),t.zoomable&&t.zoomOnWheel&&Ee(i,wi,this.onWheel,{passive:!1,capture:!0}),t.toggleDragModeOnDblclick&&Ee(i,mi,this.onDblclick),Ee(e.ownerDocument,_i,this.onCropMove),Ee(e.ownerDocument,pi,this.onCropEnd),t.responsive&&Ee(window,vi,this.onResize)}},Xn={resize:function(){if(!this.disabled){var e=this.options,t=this.container,i=this.containerData,a=t.offsetWidth/i.width,n=t.offsetHeight/i.height,s=Math.abs(a-1)>Math.abs(n-1)?a:n;if(s!==1){var l,o;e.restore&&(l=this.getCanvasData(),o=this.getCropBoxData()),this.render(),e.restore&&(this.setCanvasData(re(l,function(h,u){l[u]=h*s})),this.setCropBoxData(re(o,function(h,u){o[u]=h*s})))}}},dblclick:function(){this.disabled||this.options.dragMode===er||this.setDragMode(En(this.dragBox,Ht)?$i:Jt)},wheel:function(e){var t=this,i=Number(this.options.wheelZoomRatio)||.1,a=1;this.disabled||(e.preventDefault(),!this.wheeling&&(this.wheeling=!0,setTimeout(function(){t.wheeling=!1},50),e.deltaY?a=e.deltaY>0?1:-1:e.wheelDelta?a=-e.wheelDelta/120:e.detail&&(a=e.detail>0?1:-1),this.zoom(-a*i,e)))},cropStart:function(e){var t=e.buttons,i=e.button;if(!(this.disabled||(e.type==="mousedown"||e.type==="pointerdown"&&e.pointerType==="mouse")&&(S(t)&&t!==1||S(i)&&i!==0||e.ctrlKey))){var a=this.options,n=this.pointers,s;e.changedTouches?re(e.changedTouches,function(l){n[l.identifier]=wt(l)}):n[e.pointerId||0]=wt(e),Object.keys(n).length>1&&a.zoomable&&a.zoomOnTouch?s=xi:s=Vt(e.target,nt),mn.test(s)&&Fe(this.element,Ut,{originalEvent:e,action:s})!==!1&&(e.preventDefault(),this.action=s,this.cropping=!1,s===Qi&&(this.cropping=!0,ae(this.dragBox,Dt)))}},cropMove:function(e){var t=this.action;if(!(this.disabled||!t)){var i=this.pointers;e.preventDefault(),Fe(this.element,Xt,{originalEvent:e,action:t})!==!1&&(e.changedTouches?re(e.changedTouches,function(a){Z(i[a.identifier]||{},wt(a,!0))}):Z(i[e.pointerId||0]||{},wt(e,!0)),this.change(e))}},cropEnd:function(e){if(!this.disabled){var t=this.action,i=this.pointers;e.changedTouches?re(e.changedTouches,function(a){delete i[a.identifier]}):delete i[e.pointerId||0],t&&(e.preventDefault(),Object.keys(i).length||(this.action=""),this.cropping&&(this.cropping=!1,qe(this.dragBox,Dt,this.cropped&&this.options.modal)),Fe(this.element,Yt,{originalEvent:e,action:t}))}}},Un={change:function(e){var t=this.options,i=this.canvasData,a=this.containerData,n=this.cropBoxData,s=this.pointers,l=this.action,o=t.aspectRatio,h=n.left,u=n.top,c=n.width,f=n.height,d=h+c,_=u+f,v=0,D=0,I=a.width,A=a.height,N=!0,W;!o&&e.shiftKey&&(o=c&&f?c/f:1),this.limited&&(v=n.minLeft,D=n.minTop,I=v+Math.min(a.width,i.width,i.left+i.width),A=D+Math.min(a.height,i.height,i.top+i.height));var w=s[Object.keys(s)[0]],g={x:w.endX-w.startX,y:w.endY-w.startY},M=function(X){switch(X){case ze:d+g.x>I&&(g.x=I-d);break;case Be:h+g.x<v&&(g.x=v-h);break;case Ae:u+g.y<D&&(g.y=D-u);break;case je:_+g.y>A&&(g.y=A-_);break}};switch(l){case Qt:h+=g.x,u+=g.y;break;case ze:if(g.x>=0&&(d>=I||o&&(u<=D||_>=A))){N=!1;break}M(ze),c+=g.x,c<0&&(l=Be,c=-c,h-=c),o&&(f=c/o,u+=(n.height-f)/2);break;case Ae:if(g.y<=0&&(u<=D||o&&(h<=v||d>=I))){N=!1;break}M(Ae),f-=g.y,u+=g.y,f<0&&(l=je,f=-f,u-=f),o&&(c=f*o,h+=(n.width-c)/2);break;case Be:if(g.x<=0&&(h<=v||o&&(u<=D||_>=A))){N=!1;break}M(Be),c-=g.x,h+=g.x,c<0&&(l=ze,c=-c,h-=c),o&&(f=c/o,u+=(n.height-f)/2);break;case je:if(g.y>=0&&(_>=A||o&&(h<=v||d>=I))){N=!1;break}M(je),f+=g.y,f<0&&(l=Ae,f=-f,u-=f),o&&(c=f*o,h+=(n.width-c)/2);break;case xe:if(o){if(g.y<=0&&(u<=D||d>=I)){N=!1;break}M(Ae),f-=g.y,u+=g.y,c=f*o}else M(Ae),M(ze),g.x>=0?d<I?c+=g.x:g.y<=0&&u<=D&&(N=!1):c+=g.x,g.y<=0?u>D&&(f-=g.y,u+=g.y):(f-=g.y,u+=g.y);c<0&&f<0?(l=tt,f=-f,c=-c,u-=f,h-=c):c<0?(l=$e,c=-c,h-=c):f<0&&(l=et,f=-f,u-=f);break;case $e:if(o){if(g.y<=0&&(u<=D||h<=v)){N=!1;break}M(Ae),f-=g.y,u+=g.y,c=f*o,h+=n.width-c}else M(Ae),M(Be),g.x<=0?h>v?(c-=g.x,h+=g.x):g.y<=0&&u<=D&&(N=!1):(c-=g.x,h+=g.x),g.y<=0?u>D&&(f-=g.y,u+=g.y):(f-=g.y,u+=g.y);c<0&&f<0?(l=et,f=-f,c=-c,u-=f,h-=c):c<0?(l=xe,c=-c,h-=c):f<0&&(l=tt,f=-f,u-=f);break;case tt:if(o){if(g.x<=0&&(h<=v||_>=A)){N=!1;break}M(Be),c-=g.x,h+=g.x,f=c/o}else M(je),M(Be),g.x<=0?h>v?(c-=g.x,h+=g.x):g.y>=0&&_>=A&&(N=!1):(c-=g.x,h+=g.x),g.y>=0?_<A&&(f+=g.y):f+=g.y;c<0&&f<0?(l=xe,f=-f,c=-c,u-=f,h-=c):c<0?(l=et,c=-c,h-=c):f<0&&(l=$e,f=-f,u-=f);break;case et:if(o){if(g.x>=0&&(d>=I||_>=A)){N=!1;break}M(ze),c+=g.x,f=c/o}else M(je),M(ze),g.x>=0?d<I?c+=g.x:g.y>=0&&_>=A&&(N=!1):c+=g.x,g.y>=0?_<A&&(f+=g.y):f+=g.y;c<0&&f<0?(l=$e,f=-f,c=-c,u-=f,h-=c):c<0?(l=tt,c=-c,h-=c):f<0&&(l=xe,f=-f,u-=f);break;case Ji:this.move(g.x,g.y),N=!1;break;case xi:this.zoom(Cn(s),e),N=!1;break;case Qi:if(!g.x||!g.y){N=!1;break}W=sr(this.cropper),h=w.startX-W.left,u=w.startY-W.top,c=n.minWidth,f=n.minHeight,g.x>0?l=g.y>0?et:xe:g.x<0&&(h-=c,l=g.y>0?tt:$e),g.y<0&&(u-=f),this.cropped||(Te(this.cropBox,me),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0));break}N&&(n.width=c,n.height=f,n.left=h,n.top=u,this.action=l,this.renderCropBox()),re(s,function(R){R.startX=R.endX,R.startY=R.endY})}},jn={crop:function(){return this.ready&&!this.cropped&&!this.disabled&&(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&ae(this.dragBox,Dt),Te(this.cropBox,me),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=Z({},this.initialImageData),this.canvasData=Z({},this.initialCanvasData),this.cropBoxData=Z({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(Z(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),Te(this.dragBox,Dt),ae(this.cropBox,me)),this},replace:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return!this.disabled&&e&&(this.isImg&&(this.element.src=e),t?(this.url=e,this.image.src=e,this.ready&&(this.viewBoxImage.src=e,re(this.previews,function(i){i.getElementsByTagName("img")[0].src=e}))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(e))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,Te(this.cropper,fi)),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,ae(this.cropper,fi)),this},destroy:function(){var e=this.element;return e[F]?(e[F]=void 0,this.isImg&&this.replaced&&(e.src=this.originalUrl),this.uncreate(),this):this},move:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=this.canvasData,a=i.left,n=i.top;return this.moveTo(zt(e)?e:a+Number(e),zt(t)?t:n+Number(t))},moveTo:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=this.canvasData,a=!1;return e=Number(e),t=Number(t),this.ready&&!this.disabled&&this.options.movable&&(S(e)&&(i.left=e,a=!0),S(t)&&(i.top=t,a=!0),a&&this.renderCanvas(!0)),this},zoom:function(e,t){var i=this.canvasData;return e=Number(e),e<0?e=1/(1-e):e=1+e,this.zoomTo(i.width*e/i.naturalWidth,null,t)},zoomTo:function(e,t,i){var a=this.options,n=this.canvasData,s=n.width,l=n.height,o=n.naturalWidth,h=n.naturalHeight;if(e=Number(e),e>=0&&this.ready&&!this.disabled&&a.zoomable){var u=o*e,c=h*e;if(Fe(this.element,jt,{ratio:e,oldRatio:s/o,originalEvent:i})===!1)return this;if(i){var f=this.pointers,d=sr(this.cropper),_=f&&Object.keys(f).length?Rn(f):{pageX:i.pageX,pageY:i.pageY};n.left-=(u-s)*((_.pageX-d.left-n.left)/s),n.top-=(c-l)*((_.pageY-d.top-n.top)/l)}else Ve(t)&&S(t.x)&&S(t.y)?(n.left-=(u-s)*((t.x-n.left)/s),n.top-=(c-l)*((t.y-n.top)/l)):(n.left-=(u-s)/2,n.top-=(c-l)/2);n.width=u,n.height=c,this.renderCanvas(!0)}return this},rotate:function(e){return this.rotateTo((this.imageData.rotate||0)+Number(e))},rotateTo:function(e){return e=Number(e),S(e)&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=e%360,this.renderCanvas(!0,!0)),this},scaleX:function(e){var t=this.imageData.scaleY;return this.scale(e,S(t)?t:1)},scaleY:function(e){var t=this.imageData.scaleX;return this.scale(S(t)?t:1,e)},scale:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=this.imageData,a=!1;return e=Number(e),t=Number(t),this.ready&&!this.disabled&&this.options.scalable&&(S(e)&&(i.scaleX=e,a=!0),S(t)&&(i.scaleY=t,a=!0),a&&this.renderCanvas(!0,!0)),this},getData:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=this.options,i=this.imageData,a=this.canvasData,n=this.cropBoxData,s;if(this.ready&&this.cropped){s={x:n.left-a.left,y:n.top-a.top,width:n.width,height:n.height};var l=i.width/i.naturalWidth;if(re(s,function(u,c){s[c]=u/l}),e){var o=Math.round(s.y+s.height),h=Math.round(s.x+s.width);s.x=Math.round(s.x),s.y=Math.round(s.y),s.width=h-s.x,s.height=o-s.y}}else s={x:0,y:0,width:0,height:0};return t.rotatable&&(s.rotate=i.rotate||0),t.scalable&&(s.scaleX=i.scaleX||1,s.scaleY=i.scaleY||1),s},setData:function(e){var t=this.options,i=this.imageData,a=this.canvasData,n={};if(this.ready&&!this.disabled&&Ve(e)){var s=!1;t.rotatable&&S(e.rotate)&&e.rotate!==i.rotate&&(i.rotate=e.rotate,s=!0),t.scalable&&(S(e.scaleX)&&e.scaleX!==i.scaleX&&(i.scaleX=e.scaleX,s=!0),S(e.scaleY)&&e.scaleY!==i.scaleY&&(i.scaleY=e.scaleY,s=!0)),s&&this.renderCanvas(!0,!0);var l=i.width/i.naturalWidth;S(e.x)&&(n.left=e.x*l+a.left),S(e.y)&&(n.top=e.y*l+a.top),S(e.width)&&(n.width=e.width*l),S(e.height)&&(n.height=e.height*l),this.setCropBoxData(n)}return this},getContainerData:function(){return this.ready?Z({},this.containerData):{}},getImageData:function(){return this.sized?Z({},this.imageData):{}},getCanvasData:function(){var e=this.canvasData,t={};return this.ready&&re(["left","top","width","height","naturalWidth","naturalHeight"],function(i){t[i]=e[i]}),t},setCanvasData:function(e){var t=this.canvasData,i=t.aspectRatio;return this.ready&&!this.disabled&&Ve(e)&&(S(e.left)&&(t.left=e.left),S(e.top)&&(t.top=e.top),S(e.width)?(t.width=e.width,t.height=e.width/i):S(e.height)&&(t.height=e.height,t.width=e.height*i),this.renderCanvas(!0)),this},getCropBoxData:function(){var e=this.cropBoxData,t;return this.ready&&this.cropped&&(t={left:e.left,top:e.top,width:e.width,height:e.height}),t||{}},setCropBoxData:function(e){var t=this.cropBoxData,i=this.options.aspectRatio,a,n;return this.ready&&this.cropped&&!this.disabled&&Ve(e)&&(S(e.left)&&(t.left=e.left),S(e.top)&&(t.top=e.top),S(e.width)&&e.width!==t.width&&(a=!0,t.width=e.width),S(e.height)&&e.height!==t.height&&(n=!0,t.height=e.height),i&&(a?t.height=t.width/i:n&&(t.width=t.height*i)),this.renderCropBox()),this},getCroppedCanvas:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var t=this.canvasData,i=Sn(this.image,this.imageData,t,e);if(!this.cropped)return i;var a=this.getData(),n=a.x,s=a.y,l=a.width,o=a.height,h=i.width/Math.floor(t.naturalWidth);h!==1&&(n*=h,s*=h,l*=h,o*=h);var u=l/o,c=Ie({aspectRatio:u,width:e.maxWidth||1/0,height:e.maxHeight||1/0}),f=Ie({aspectRatio:u,width:e.minWidth||0,height:e.minHeight||0},"cover"),d=Ie({aspectRatio:u,width:e.width||(h!==1?i.width:l),height:e.height||(h!==1?i.height:o)}),_=d.width,v=d.height;_=Math.min(c.width,Math.max(f.width,_)),v=Math.min(c.height,Math.max(f.height,v));var D=document.createElement("canvas"),I=D.getContext("2d");D.width=Ge(_),D.height=Ge(v),I.fillStyle=e.fillColor||"transparent",I.fillRect(0,0,_,v);var A=e.imageSmoothingEnabled,N=A===void 0?!0:A,W=e.imageSmoothingQuality;I.imageSmoothingEnabled=N,W&&(I.imageSmoothingQuality=W);var w=i.width,g=i.height,M=n,R=s,X,B,te,se,U,x;M<=-l||M>w?(M=0,X=0,te=0,U=0):M<=0?(te=-M,M=0,X=Math.min(w,l+M),U=X):M<=w&&(te=0,X=Math.min(l,w-M),U=X),X<=0||R<=-o||R>g?(R=0,B=0,se=0,x=0):R<=0?(se=-R,R=0,B=Math.min(g,o+R),x=B):R<=g&&(se=0,B=Math.min(o,g-R),x=B);var K=[M,R,X,B];if(U>0&&x>0){var oe=_/l;K.push(te*oe,se*oe,U*oe,x*oe)}return I.drawImage.apply(I,[i].concat(Ki(K.map(function(ce){return Math.floor(Ge(ce))})))),D},setAspectRatio:function(e){var t=this.options;return!this.disabled&&!zt(e)&&(t.aspectRatio=Math.max(0,e)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(e){var t=this.options,i=this.dragBox,a=this.face;if(this.ready&&!this.disabled){var n=e===Jt,s=t.movable&&e===$i;e=n||s?e:er,t.dragMode=e,at(i,nt,e),qe(i,Ht,n),qe(i,Pt,s),t.cropBoxMovable||(at(a,nt,e),qe(a,Ht,n),qe(a,Pt,s))}return this}},Vn=Ce.Cropper,lr=function(){function r(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(rn(this,r),!e||!pn.test(e.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=e,this.options=Z({},ki,Ve(t)&&t),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}return nn(r,[{key:"init",value:function(){var t=this.element,i=t.tagName.toLowerCase(),a;if(!t[F]){if(t[F]=this,i==="img"){if(this.isImg=!0,a=t.getAttribute("src")||"",this.originalUrl=a,!a)return;a=t.src}else i==="canvas"&&window.HTMLCanvasElement&&(a=t.toDataURL());this.load(a)}}},{key:"load",value:function(t){var i=this;if(t){this.url=t,this.imageData={};var a=this.element,n=this.options;if(!n.rotatable&&!n.scalable&&(n.checkOrientation=!1),!n.checkOrientation||!window.ArrayBuffer){this.clone();return}if(gn.test(t)){_n.test(t)?this.read(zn(t)):this.clone();return}var s=new XMLHttpRequest,l=this.clone.bind(this);this.reloading=!0,this.xhr=s,s.onabort=l,s.onerror=l,s.ontimeout=l,s.onprogress=function(){s.getResponseHeader("content-type")!==yi&&s.abort()},s.onload=function(){i.read(s.response)},s.onloadend=function(){i.reloading=!1,i.xhr=null},n.checkCrossOrigin&&Ei(t)&&a.crossOrigin&&(t=Mi(t)),s.open("GET",t,!0),s.responseType="arraybuffer",s.withCredentials=a.crossOrigin==="use-credentials",s.send()}}},{key:"read",value:function(t){var i=this.options,a=this.imageData,n=Ln(t),s=0,l=1,o=1;if(n>1){this.url=Bn(t,yi);var h=Hn(n);s=h.rotate,l=h.scaleX,o=h.scaleY}i.rotatable&&(a.rotate=s),i.scalable&&(a.scaleX=l,a.scaleY=o),this.clone()}},{key:"clone",value:function(){var t=this.element,i=this.url,a=t.crossOrigin,n=i;this.options.checkCrossOrigin&&Ei(i)&&(a||(a="anonymous"),n=Mi(i)),this.crossOrigin=a,this.crossOriginUrl=n;var s=document.createElement("img");a&&(s.crossOrigin=a),s.src=n||i,s.alt=t.alt||"The image to crop",this.image=s,s.onload=this.start.bind(this),s.onerror=this.stop.bind(this),ae(s,di),t.parentNode.insertBefore(s,t.nextSibling)}},{key:"start",value:function(){var t=this,i=this.image;i.onload=null,i.onerror=null,this.sizing=!0;var a=Ce.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(Ce.navigator.userAgent),n=function(h,u){Z(t.imageData,{naturalWidth:h,naturalHeight:u,aspectRatio:h/u}),t.initialImageData=Z({},t.imageData),t.sizing=!1,t.sized=!0,t.build()};if(i.naturalWidth&&!a){n(i.naturalWidth,i.naturalHeight);return}var s=document.createElement("img"),l=document.body||document.documentElement;this.sizingImage=s,s.onload=function(){n(s.width,s.height),a||l.removeChild(s)},s.src=i.src,a||(s.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",l.appendChild(s))}},{key:"stop",value:function(){var t=this.image;t.onload=null,t.onerror=null,t.parentNode.removeChild(t),this.image=null}},{key:"build",value:function(){if(!(!this.sized||this.ready)){var t=this.element,i=this.options,a=this.image,n=t.parentNode,s=document.createElement("div");s.innerHTML=bn;var l=s.querySelector(".".concat(F,"-container")),o=l.querySelector(".".concat(F,"-canvas")),h=l.querySelector(".".concat(F,"-drag-box")),u=l.querySelector(".".concat(F,"-crop-box")),c=u.querySelector(".".concat(F,"-face"));this.container=n,this.cropper=l,this.canvas=o,this.dragBox=h,this.cropBox=u,this.viewBox=l.querySelector(".".concat(F,"-view-box")),this.face=c,o.appendChild(a),ae(t,me),n.insertBefore(l,t.nextSibling),this.isImg||Te(a,di),this.initPreview(),this.bind(),i.initialAspectRatio=Math.max(0,i.initialAspectRatio)||NaN,i.aspectRatio=Math.max(0,i.aspectRatio)||NaN,i.viewMode=Math.max(0,Math.min(3,Math.round(i.viewMode)))||0,ae(u,me),i.guides||ae(u.getElementsByClassName("".concat(F,"-dashed")),me),i.center||ae(u.getElementsByClassName("".concat(F,"-center")),me),i.background&&ae(l,"".concat(F,"-bg")),i.highlight||ae(c,un),i.cropBoxMovable&&(ae(c,Pt),at(c,nt,Qt)),i.cropBoxResizable||(ae(u.getElementsByClassName("".concat(F,"-line")),me),ae(u.getElementsByClassName("".concat(F,"-point")),me)),this.render(),this.ready=!0,this.setDragMode(i.dragMode),i.autoCrop&&this.crop(),this.setData(i.data),de(i.ready)&&De(t,bi,i.ready,{once:!0}),Fe(t,bi)}}},{key:"unbuild",value:function(){this.ready&&(this.ready=!1,this.unbind(),this.resetPreview(),this.cropper.parentNode.removeChild(this.cropper),Te(this.element,me))}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}],[{key:"noConflict",value:function(){return window.Cropper=Vn,r}},{key:"setDefaults",value:function(t){Z(ki,Ve(t)&&t)}}]),r}();Z(lr.prototype,Pn,Wn,Yn,Xn,Un,jn);function qn(r){let e,t;return{c(){e=J("img"),ge(e.src,t=r[0])||m(e,"src",t),m(e,"alt","")},m(i,a){O(i,e,a),r[4](e)},p(i,[a]){a&1&&!ge(e.src,t=i[0])&&m(e,"src",t)},i:Y,o:Y,d(i){i&&T(e),r[4](null)}}}function Gn(r,e,t){let{image:i}=e,a;const n=st();let s;function l(){s.destroy()}function o(){s&&l(),s=new lr(a,{autoCropArea:1,cropend(){const u=s.getCroppedCanvas().toDataURL();n("crop",u)}}),n("crop",i)}function h(u){q[u?"unshift":"push"](()=>{a=u,t(1,a)})}return r.$$set=u=>{"image"in u&&t(0,i=u.image)},[i,a,l,o,h]}class hr extends be{constructor(e){super(),ve(this,e,Gn,qn,le,{image:0,destroy:2,create:3})}get image(){return this.$$.ctx[0]}set image(e){this.$$set({image:e}),V()}get destroy(){return this.$$.ctx[2]}get create(){return this.$$.ctx[3]}}class Oi{constructor(e,t){this.x=e,this.y=t}}class Ti extends Oi{update(e){this.x=e.x,this.y=e.y}moveByAngle(e,t){const i=e+Math.PI/2;this.x=this.x+Math.sin(i)*t,this.y=this.y-Math.cos(i)*t}equalsTo(e){return this.x===e.x&&this.y===e.y}getDifferenceTo(e){return new Oi(this.x-e.x,this.y-e.y)}getDistanceTo(e){const t=this.getDifferenceTo(e);return Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2))}getAngleTo(e){const t=this.getDifferenceTo(e);return Math.atan2(t.y,t.x)}toObject(){return{x:this.x,y:this.y}}}const Fn=30;class Zn{constructor({radius:e=Fn,enabled:t=!0,initialPoint:i={x:0,y:0}}={}){this.radius=e,this._isEnabled=t,this.pointer=new Ti(i.x,i.y),this.brush=new Ti(i.x,i.y),this.angle=0,this.distance=0,this._hasMoved=!1}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}isEnabled(){return this._isEnabled}setRadius(e){this.radius=e}getRadius(){return this.radius}getBrushCoordinates(){return this.brush.toObject()}getPointerCoordinates(){return this.pointer.toObject()}getBrush(){return this.brush}getPointer(){return this.pointer}getAngle(){return this.angle}getDistance(){return this.distance}brushHasMoved(){return this._hasMoved}update(e,{both:t=!1}={}){return this._hasMoved=!1,this.pointer.equalsTo(e)&&!t?!1:(this.pointer.update(e),t?(this._hasMoved=!0,this.brush.update(e),!0):(this._isEnabled?(this.distance=this.pointer.getDistanceTo(this.brush),this.angle=this.pointer.getAngleTo(this.brush),this.distance>this.radius&&(this.brush.moveByAngle(this.angle,this.distance-this.radius),this._hasMoved=!0)):(this.distance=0,this.angle=0,this.brush.update(e),this._hasMoved=!0),!0))}}var ur=function(){if(typeof Map<"u")return Map;function r(e,t){var i=-1;return e.some(function(a,n){return a[0]===t?(i=n,!0):!1}),i}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(t){var i=r(this.__entries__,t),a=this.__entries__[i];return a&&a[1]},e.prototype.set=function(t,i){var a=r(this.__entries__,t);~a?this.__entries__[a][1]=i:this.__entries__.push([t,i])},e.prototype.delete=function(t){var i=this.__entries__,a=r(i,t);~a&&i.splice(a,1)},e.prototype.has=function(t){return!!~r(this.__entries__,t)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(t,i){i===void 0&&(i=null);for(var a=0,n=this.__entries__;a<n.length;a++){var s=n[a];t.call(i,s[1],s[0])}},e}()}(),qt=typeof window<"u"&&typeof document<"u"&&window.document===document,Et=function(){return typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()}(),Kn=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(Et):function(r){return setTimeout(function(){return r(Date.now())},1e3/60)}}(),Qn=2;function Jn(r,e){var t=!1,i=!1,a=0;function n(){t&&(t=!1,r()),i&&l()}function s(){Kn(n)}function l(){var o=Date.now();if(t){if(o-a<Qn)return;i=!0}else t=!0,i=!1,setTimeout(s,e);a=o}return l}var xn=20,$n=["top","right","bottom","left","width","height","size","weight"],ea=typeof MutationObserver<"u",ta=function(){function r(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=Jn(this.refresh.bind(this),xn)}return r.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},r.prototype.removeObserver=function(e){var t=this.observers_,i=t.indexOf(e);~i&&t.splice(i,1),!t.length&&this.connected_&&this.disconnect_()},r.prototype.refresh=function(){var e=this.updateObservers_();e&&this.refresh()},r.prototype.updateObservers_=function(){var e=this.observers_.filter(function(t){return t.gatherActive(),t.hasActive()});return e.forEach(function(t){return t.broadcastActive()}),e.length>0},r.prototype.connect_=function(){!qt||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),ea?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},r.prototype.disconnect_=function(){!qt||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},r.prototype.onTransitionEnd_=function(e){var t=e.propertyName,i=t===void 0?"":t,a=$n.some(function(n){return!!~i.indexOf(n)});a&&this.refresh()},r.getInstance=function(){return this.instance_||(this.instance_=new r),this.instance_},r.instance_=null,r}(),cr=function(r,e){for(var t=0,i=Object.keys(e);t<i.length;t++){var a=i[t];Object.defineProperty(r,a,{value:e[a],enumerable:!1,writable:!1,configurable:!0})}return r},Ze=function(r){var e=r&&r.ownerDocument&&r.ownerDocument.defaultView;return e||Et},fr=Ct(0,0,0,0);function Mt(r){return parseFloat(r)||0}function Ci(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return e.reduce(function(i,a){var n=r["border-"+a+"-width"];return i+Mt(n)},0)}function ia(r){for(var e=["top","right","bottom","left"],t={},i=0,a=e;i<a.length;i++){var n=a[i],s=r["padding-"+n];t[n]=Mt(s)}return t}function ra(r){var e=r.getBBox();return Ct(0,0,e.width,e.height)}function na(r){var e=r.clientWidth,t=r.clientHeight;if(!e&&!t)return fr;var i=Ze(r).getComputedStyle(r),a=ia(i),n=a.left+a.right,s=a.top+a.bottom,l=Mt(i.width),o=Mt(i.height);if(i.boxSizing==="border-box"&&(Math.round(l+n)!==e&&(l-=Ci(i,"left","right")+n),Math.round(o+s)!==t&&(o-=Ci(i,"top","bottom")+s)),!sa(r)){var h=Math.round(l+n)-e,u=Math.round(o+s)-t;Math.abs(h)!==1&&(l-=h),Math.abs(u)!==1&&(o-=u)}return Ct(a.left,a.top,l,o)}var aa=function(){return typeof SVGGraphicsElement<"u"?function(r){return r instanceof Ze(r).SVGGraphicsElement}:function(r){return r instanceof Ze(r).SVGElement&&typeof r.getBBox=="function"}}();function sa(r){return r===Ze(r).document.documentElement}function oa(r){return qt?aa(r)?ra(r):na(r):fr}function la(r){var e=r.x,t=r.y,i=r.width,a=r.height,n=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,s=Object.create(n.prototype);return cr(s,{x:e,y:t,width:i,height:a,top:t,right:e+i,bottom:a+t,left:e}),s}function Ct(r,e,t,i){return{x:r,y:e,width:t,height:i}}var ha=function(){function r(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=Ct(0,0,0,0),this.target=e}return r.prototype.isActive=function(){var e=oa(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},r.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},r}(),ua=function(){function r(e,t){var i=la(t);cr(this,{target:e,contentRect:i})}return r}(),ca=function(){function r(e,t,i){if(this.activeObservations_=[],this.observations_=new ur,typeof e!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=i}return r.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof Ze(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new ha(e)),this.controller_.addObserver(this),this.controller_.refresh())}},r.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof Ze(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},r.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},r.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach(function(t){t.isActive()&&e.activeObservations_.push(t)})},r.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map(function(i){return new ua(i.target,i.broadcastRect())});this.callback_.call(e,t,e),this.clearActive()}},r.prototype.clearActive=function(){this.activeObservations_.splice(0)},r.prototype.hasActive=function(){return this.activeObservations_.length>0},r}(),dr=typeof WeakMap<"u"?new WeakMap:new ur,mr=function(){function r(e){if(!(this instanceof r))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var t=ta.getInstance(),i=new ca(e,t,this);dr.set(this,i)}return r}();["observe","unobserve","disconnect"].forEach(function(r){mr.prototype[r]=function(){var e;return(e=dr.get(this))[r].apply(e,arguments)}});var fa=function(){return typeof Et.ResizeObserver<"u"?Et.ResizeObserver:mr}();function Ri(r,e,t){const i=r.slice();return i[61]=e[t].name,i[62]=e[t].zIndex,i[63]=e[t].opacity,i[64]=e,i[65]=t,i}function Ai(r){let e,t,i;return{c(){e=J("div"),e.textContent="Start drawing",m(e,"class","start-prompt svelte-yigbas")},m(a,n){O(a,e,n),i=!0},i(a){i||(a&&Ft(()=>{i&&(t||(t=ni(e,si,{duration:50},!0)),t.run(1))}),i=!0)},o(a){a&&(t||(t=ni(e,si,{duration:50},!1)),t.run(0)),i=!1},d(a){a&&T(e),a&&t&&t.end()}}}function Si(r){let e,t=r[61],i,a;const n=()=>r[31](e,t),s=()=>r[31](null,t);return{c(){e=J("canvas"),m(e,"key",r[61]),ai(e,"z-index",r[62]),m(e,"class","svelte-yigbas"),j(e,"lr",r[5]),j(e,"tb",!r[5]),ai(e,"opacity",r[63])},m(l,o){O(l,e,o),n(),i||(a=[ie(e,"mousedown",r[61]==="interface"?r[7]:void 0),ie(e,"mousemove",r[61]==="interface"?r[8]:void 0),ie(e,"mouseup",r[61]==="interface"?r[9]:void 0),ie(e,"mouseout",r[61]==="interface"?r[9]:void 0),ie(e,"blur",r[61]==="interface"?r[9]:void 0),ie(e,"touchstart",r[61]==="interface"?r[7]:void 0),ie(e,"touchmove",r[61]==="interface"?r[8]:void 0),ie(e,"touchend",r[61]==="interface"?r[9]:void 0),ie(e,"touchcancel",r[61]==="interface"?r[9]:void 0),ie(e,"click",br(r[30]))],i=!0)},p(l,o){r=l,t!==r[61]&&(s(),t=r[61],n()),o[0]&32&&j(e,"lr",r[5]),o[0]&32&&j(e,"tb",!r[5])},d(l){l&&T(e),s(),i=!1,Gi(a)}}}function da(r){let e,t,i,a=r[4]===0&&Ai(),n=ri(r[6]),s=[];for(let l=0;l<n.length;l+=1)s[l]=Si(Ri(r,n,l));return{c(){e=J("div"),a&&a.c(),t=ee();for(let l=0;l<s.length;l+=1)s[l].c();m(e,"class","wrap svelte-yigbas"),Ft(()=>r[33].call(e))},m(l,o){O(l,e,o),a&&a.m(e,null),Q(e,t);for(let h=0;h<s.length;h+=1)s[h]&&s[h].m(e,null);r[32](e),i=qi(e,r[33].bind(e))},p(l,o){if(l[4]===0?a?o[0]&16&&y(a,1):(a=Ai(),a.c(),y(a,1),a.m(e,t)):a&&(we(),E(a,1,1,()=>{a=null}),ye()),o[0]&993){n=ri(l[6]);let h;for(h=0;h<n.length;h+=1){const u=Ri(l,n,h);s[h]?s[h].p(u,o):(s[h]=Si(u),s[h].c(),s[h].m(e,null))}for(;h<s.length;h+=1)s[h].d(1);s.length=n.length}},i(l){y(a)},o(l){E(a)},d(l){l&&T(e),a&&a.d(),_r(s,l),r[32](null),i()}}}let ma="#aaa";function ga(r,e){return{x:r.x+(e.x-r.x)/2,y:r.y+(e.y-r.y)/2}}function _a(r,e,t){let i;const a=st();let{value:n}=e,{value_img:s}=e,{mode:l="sketch"}=e,{brush_color:o="#0b0f19"}=e,{brush_radius:h}=e,{mask_opacity:u=.7}=e,{source:c}=e,{width:f=400}=e,{height:d=200}=e,{container_height:_=200}=e,{shape:v}=e,D,I=f,A=d,N;const W=[{name:"interface",zIndex:15},{name:"mask",zIndex:13,opacity:u},{name:"drawing",zIndex:11},{name:"temp",zIndex:12}];let w={},g={},M=[],R=[],X=!0,B=!0,te=!1,se=!1,U=null,x=null,K=null,oe=0;function ce(){if(!v){g.temp.drawImage(s,0,0,f,d);return}let p=s.naturalWidth,C=s.naturalHeight;const z=v[0]/v[1],ne=p/C;let G=0,fe=0;z<ne?(p=v[1]*ne,C=v[1],G=(v[0]-p)/2):z>ne?(p=v[0],C=v[0]/ne,fe=(v[1]-C)/2):(G=0,fe=0,p=v[0],C=v[1]),g.temp.drawImage(s,G,fe,p,C)}Gt(async()=>{Object.keys(w).forEach(p=>{t(27,g[p]=w[p].getContext("2d"),g)}),await Le(),s&&(s.addEventListener("load",p=>{c==="webcam"?(g.temp.save(),g.temp.translate(f,0),g.temp.scale(-1,1),g.temp.drawImage(s,0,0),g.temp.restore()):ce(),g.drawing.drawImage(w.temp,0,0,f,d),Re()}),setTimeout(()=>{c==="webcam"?(g.temp.save(),g.temp.translate(f,0),g.temp.scale(-1,1),g.temp.drawImage(s,0,0),g.temp.restore()):ce(),g.drawing.drawImage(w.temp,0,0,f,d),ke({lines:R.slice()}),Re()},100)),t(29,U=new Zn({radius:h*.05,enabled:!0,initialPoint:{x:f/2,y:d/2}})),K=new fa((p,C,...z)=>{ct()}),K.observe(x),Qe(),t(25,D=!0),requestAnimationFrame(()=>{he(),requestAnimationFrame(()=>{Ne()})})});function he(){const p=f/2,C=d/2;U.update({x:p,y:C},{both:!0}),U.update({x:p,y:C},{both:!1}),X=!0,B=!0}pr(()=>{t(25,D=!1),K.unobserve(x)});function ue(p){pt(),s&&(c==="webcam"?(g.temp.save(),g.temp.translate(f,0),g.temp.scale(-1,1),g.temp.drawImage(s,0,0),g.temp.restore()):ce(),(!R||!R.length)&&g.drawing.drawImage(w.temp,0,0,f,d)),ke({lines:p}),t(4,oe=p.length),t(28,R=p),g.drawing.drawImage(w.temp,0,0,f,d),R.length==0&&a("clear")}function Me(){ue([]),Re()}function k(){const p=R.slice(0,-1);ue(p),Re()}let ke=({lines:p})=>{p.forEach(C=>{const{points:z,brush_color:ne,brush_radius:G}=C;mt({points:z,brush_color:ne,brush_radius:G,mask:l==="mask"})}),_t(),l==="mask"&&gt()},We=p=>{p.preventDefault(),se=!0;const{x:C,y:z}=ft(p);p.touches&&p.touches.length>0&&U.update({x:C,y:z},{both:!0}),dt(C,z),t(4,oe+=1)},Ye=p=>{p.preventDefault();const{x:C,y:z}=ft(p);dt(C,z)},Ke=p=>{p.preventDefault(),Ye(p),te=!1,se=!1,_t(),l==="mask"&&gt()},ot=0,lt=0,ht=0,ut=!1,ct=async()=>{if(v&&x){const z=x?.getBoundingClientRect(),ne=v[0]/v[1],G=z.width/z.height;t(5,ut=ne<G)}if(f===ot&&d===lt&&ht===_)return;const p={width:f,height:d},C={height:_,width:_*(p.width/p.height)};await Promise.all([Xe(w.interface,p,C),Xe(w.drawing,p,C),Xe(w.temp,p,C),Xe(w.mask,p,C,!1)]),h||t(10,h=20*(p.width/C.width)),Qe({once:!0}),setTimeout(()=>{lt=d,ot=f,ht=_},10),await Le(),Ne()},Xe=async(p,C,z,ne=!0)=>{if(!D)return;await Le();const G=window.devicePixelRatio||1;p.width=C.width*(ne?G:1),p.height=C.height*(ne?G:1);const fe=p.getContext("2d");ne&&fe.scale(G,G),p.style.width=`${z.width}px`,p.style.height=`${z.height}px`},ft=p=>{const C=w.interface.getBoundingClientRect();let z=p.clientX,ne=p.clientY;return p.changedTouches&&p.changedTouches.length>0&&(z=p.changedTouches[0].clientX,ne=p.changedTouches[0].clientY),{x:(z-C.left)/C.width*f,y:(ne-C.top)/C.height*d}},dt=(p,C)=>{U.update({x:p,y:C});const z=!U.isEnabled();(se&&!te||z&&se)&&(te=!0,M.push(U.brush.toObject())),te&&(M.push(U.brush.toObject()),mt({points:M,brush_color:o,brush_radius:h,mask:l==="mask"})),X=!0},mt=({points:p,brush_color:C,brush_radius:z,mask:ne})=>{if(!p||p.length<2)return;let G=ne?g.mask:g.temp;G.lineJoin="round",G.lineCap="round",G.strokeStyle=C,G.lineWidth=z;let fe=p[0],Ue=p[1];G.moveTo(Ue.x,Ue.y),G.beginPath();for(var b=1,Oe=p.length;b<Oe;b++){var ii=ga(fe,Ue);G.quadraticCurveTo(fe.x,fe.y,ii.x,ii.y),fe=p[b],Ue=p[b+1]}G.lineTo(fe.x,fe.y),G.stroke()},gt=()=>{M.length<1||(M.length=0,Re())},_t=()=>{M.length<1||(R.push({points:M.slice(),brush_color:o,brush_radius:h}),l!=="mask"&&(M.length=0),g.drawing.drawImage(w.temp,0,0,f,d),Re())},Re=()=>{const p=bt();a("change",p)};function Ne(){return t(28,R=[]),pt(),t(4,oe=0),!0}function pt(){B=!0,g.temp.clearRect(0,0,f,d),t(27,g.temp.fillStyle=l==="mask"?"transparent":"#FFFFFF",g),g.temp.fillRect(0,0,f,d),l==="mask"&&g.mask.clearRect(0,0,w.mask.width,w.mask.height)}let Qe=({once:p=!1}={})=>{if(X||B){const C=U.getPointerCoordinates(),z=U.getBrushCoordinates();Rt(g.interface,C,z),X=!1,B=!1}p||window.requestAnimationFrame(()=>{Qe()})},Rt=(p,C,z)=>{p.clearRect(0,0,f,d),p.beginPath(),p.fillStyle=o,p.arc(z.x,z.y,h/2,0,Math.PI*2,!0),p.fill(),p.beginPath(),p.fillStyle=ma,p.arc(z.x,z.y,i,0,Math.PI*2,!0),p.fill()};function bt(){return l==="mask"?w.mask.toDataURL("image/png"):w.drawing.toDataURL("image/jpg")}function At(p){Fi.call(this,r,p)}function St(p,C){q[p?"unshift":"push"](()=>{w[C]=p,t(0,w)})}function It(p){q[p?"unshift":"push"](()=>{x=p,t(3,x)})}function Nt(){I=this.offsetWidth,A=this.offsetHeight,t(1,I),t(2,A)}return r.$$set=p=>{"value"in p&&t(13,n=p.value),"value_img"in p&&t(14,s=p.value_img),"mode"in p&&t(15,l=p.mode),"brush_color"in p&&t(16,o=p.brush_color),"brush_radius"in p&&t(10,h=p.brush_radius),"mask_opacity"in p&&t(17,u=p.mask_opacity),"source"in p&&t(18,c=p.source),"width"in p&&t(11,f=p.width),"height"in p&&t(12,d=p.height),"container_height"in p&&t(19,_=p.container_height),"shape"in p&&t(20,v=p.shape)},r.$$.update=()=>{r.$$.dirty[0]&1054720&&v&&(f||d)&&(t(11,f=v[0]),t(12,d=v[1])),r.$$.dirty[0]&33562624&&D&&!n&&Ne(),r.$$.dirty[0]&16384&&console.log(s),r.$$.dirty[0]&503601153&&D&&s!==N&&(t(26,N=s),Ne(),setTimeout(()=>{c==="webcam"?(g.temp.save(),g.temp.translate(f,0),g.temp.scale(-1,1),g.temp.drawImage(s,0,0),g.temp.restore()):ce(),g.drawing.drawImage(w.temp,0,0,f,d),ke({lines:R.slice()}),Re()},50)),r.$$.dirty[0]&536871936&&U&&(he(),U.setRadius(h*.05)),r.$$.dirty[0]&6144&&(f||d)&&ct(),r.$$.dirty[0]&1024&&(i=h*.075)},[w,I,A,x,oe,ut,W,We,Ye,Ke,h,f,d,n,s,l,o,u,c,_,v,Me,k,Ne,bt,D,N,g,R,U,At,St,It,Nt]}class $t extends be{constructor(e){super(),ve(this,e,_a,da,le,{value:13,value_img:14,mode:15,brush_color:16,brush_radius:10,mask_opacity:17,source:18,width:11,height:12,container_height:19,shape:20,clear_mask:21,undo:22,clear:23,get_image_data:24},null,[-1,-1,-1])}get clear_mask(){return this.$$.ctx[21]}get undo(){return this.$$.ctx[22]}get clear(){return this.$$.ctx[23]}get get_image_data(){return this.$$.ctx[24]}}function Ii(r){let e,t;return e=new rt({props:{Icon:Vr,label:"Clear"}}),e.$on("click",r[3]),{c(){L(e.$$.fragment)},m(i,a){H(e,i,a),t=!0},p:Y,i(i){t||(y(e.$$.fragment,i),t=!0)},o(i){E(e.$$.fragment,i),t=!1},d(i){P(e,i)}}}function pa(r){let e,t,i,a,n,s;t=new rt({props:{Icon:Ir,label:"Undo"}}),t.$on("click",r[2]);let l=r[0]&&Ii(r);return n=new rt({props:{Icon:Sr,label:"Remove Image"}}),n.$on("click",r[4]),{c(){e=J("div"),L(t.$$.fragment),i=ee(),l&&l.c(),a=ee(),L(n.$$.fragment),m(e,"class","svelte-s6ybro")},m(o,h){O(o,e,h),H(t,e,null),Q(e,i),l&&l.m(e,null),Q(e,a),H(n,e,null),s=!0},p(o,[h]){o[0]?l?(l.p(o,h),h&1&&y(l,1)):(l=Ii(o),l.c(),y(l,1),l.m(e,a)):l&&(we(),E(l,1,1,()=>{l=null}),ye())},i(o){s||(y(t.$$.fragment,o),y(l),y(n.$$.fragment,o),s=!0)},o(o){E(t.$$.fragment,o),E(l),E(n.$$.fragment,o),s=!1},d(o){o&&T(e),P(t),l&&l.d(),P(n)}}}function ba(r,e,t){const i=st();let{show_eraser:a=!1}=e;const n=()=>i("undo"),s=o=>{i("clear_mask"),o.stopPropagation()},l=o=>{i("remove_image"),o.stopPropagation()};return r.$$set=o=>{"show_eraser"in o&&t(0,a=o.show_eraser)},[a,i,n,s,l]}class ei extends be{constructor(e){super(),ve(this,e,ba,pa,le,{show_eraser:0})}}function Ni(r){let e,t,i,a,n;return{c(){e=J("input"),m(e,"aria-label","Brush radius"),m(e,"type","range"),m(e,"min",t=.5*(r[2]/r[6])),m(e,"max",i=75*(r[2]/r[6])),m(e,"class","svelte-p4aq0j")},m(s,l){O(s,e,l),kt(e,r[0]),a||(n=[ie(e,"change",r[10]),ie(e,"input",r[10])],a=!0)},p(s,l){l&68&&t!==(t=.5*(s[2]/s[6]))&&m(e,"min",t),l&68&&i!==(i=75*(s[2]/s[6]))&&m(e,"max",i),l&1&&kt(e,s[0])},d(s){s&&T(e),a=!1,Gi(n)}}}function zi(r){let e,t,i,a;t=new rt({props:{Icon:Ur,label:"Select brush color"}}),t.$on("click",r[11]);let n=r[5]&&Bi(r);return{c(){e=J("span"),L(t.$$.fragment),i=ee(),n&&n.c(),m(e,"class","col svelte-p4aq0j")},m(s,l){O(s,e,l),H(t,e,null),Q(e,i),n&&n.m(e,null),a=!0},p(s,l){s[5]?n?n.p(s,l):(n=Bi(s),n.c(),n.m(e,null)):n&&(n.d(1),n=null)},i(s){a||(y(t.$$.fragment,s),a=!0)},o(s){E(t.$$.fragment,s),a=!1},d(s){s&&T(e),P(t),n&&n.d()}}}function Bi(r){let e,t,i;return{c(){e=J("input"),m(e,"aria-label","Brush color"),m(e,"type","color"),m(e,"class","svelte-p4aq0j")},m(a,n){O(a,e,n),kt(e,r[1]),t||(i=ie(e,"input",r[12]),t=!0)},p(a,n){n&2&&kt(e,a[1])},d(a){a&&T(e),t=!1,i()}}}function va(r){let e,t,i,a,n,s;i=new rt({props:{Icon:Lr,label:"Use brush"}}),i.$on("click",r[9]);let l=r[4]&&Ni(r),o=r[3]!=="mask"&&zi(r);return{c(){e=J("div"),t=J("span"),L(i.$$.fragment),a=ee(),l&&l.c(),n=ee(),o&&o.c(),m(t,"class","brush svelte-p4aq0j"),m(e,"class","wrap svelte-p4aq0j")},m(h,u){O(h,e,u),Q(e,t),H(i,t,null),Q(t,a),l&&l.m(t,null),Q(e,n),o&&o.m(e,null),s=!0},p(h,[u]){h[4]?l?l.p(h,u):(l=Ni(h),l.c(),l.m(t,null)):l&&(l.d(1),l=null),h[3]!=="mask"?o?(o.p(h,u),u&8&&y(o,1)):(o=zi(h),o.c(),y(o,1),o.m(e,null)):o&&(we(),E(o,1,1,()=>{o=null}),ye())},i(h){s||(y(i.$$.fragment,h),y(o),s=!0)},o(h){E(i.$$.fragment,h),E(o),s=!1},d(h){h&&T(e),P(i),l&&l.d(),o&&o.d()}}}function wa(r,e,t){let i,a=!1,n=!1,{brush_radius:s=20}=e,{brush_color:l="#000"}=e,{container_height:o}=e,{img_width:h}=e,{img_height:u}=e,{mode:c="other"}=e;const f=()=>t(4,a=!a);function d(){s=vr(this.value),t(0,s)}const _=()=>t(5,n=!n);function v(){l=this.value,t(1,l)}return r.$$set=D=>{"brush_radius"in D&&t(0,s=D.brush_radius),"brush_color"in D&&t(1,l=D.brush_color),"container_height"in D&&t(7,o=D.container_height),"img_width"in D&&t(2,h=D.img_width),"img_height"in D&&t(8,u=D.img_height),"mode"in D&&t(3,c=D.mode)},r.$$.update=()=>{r.$$.dirty&388&&t(6,i=o*(h/u))},[s,l,h,c,a,n,i,o,u,f,d,_,v]}class ti extends be{constructor(e){super(),ve(this,e,wa,va,le,{brush_radius:0,brush_color:1,container_height:7,img_width:2,img_height:8,mode:3})}}function ya(r){let e,t,i,a;return{c(){e=J("img"),ge(e.src,t=r[17].image||r[17].data)||m(e,"src",t),m(e,"alt",""),m(e,"loading","lazy"),m(e,"class","svelte-p3y7hu"),j(e,"webcam",r[6]==="webcam"&&r[10]),j(e,"selectable",r[12])},m(n,s){O(n,e,s),i||(a=ie(e,"click",r[33]),i=!0)},p(n,s){s[0]&131072&&!ge(e.src,t=n[17].image||n[17].data)&&m(e,"src",t),s[0]&1088&&j(e,"webcam",n[6]==="webcam"&&n[10]),s[0]&4096&&j(e,"selectable",n[12])},i:Y,o:Y,d(n){n&&T(e),i=!1,a()}}}function ka(r){let e=r[26],t,i,a,n=Li(r),s=r[20]>0&&Hi(r);return{c(){n.c(),t=ee(),s&&s.c(),i=Pe()},m(l,o){n.m(l,o),O(l,t,o),s&&s.m(l,o),O(l,i,o),a=!0},p(l,o){o[0]&67108864&&le(e,e=l[26])?(n.d(1),n=Li(l),n.c(),n.m(t.parentNode,t)):n.p(l,o),l[20]>0?s?(s.p(l,o),o[0]&1048576&&y(s,1)):(s=Hi(l),s.c(),y(s,1),s.m(i.parentNode,i)):s&&(we(),E(s,1,1,()=>{s=null}),ye())},i(l){a||(y(s),a=!0)},o(l){E(s),a=!1},d(l){l&&(T(t),T(i)),n.d(l),s&&s.d(l)}}}function Da(r){let e,t,i,a,n,s,l;return e=new Ot({props:{i18n:r[14],editable:!0}}),e.$on("edit",r[56]),e.$on("clear",r[28]),{c(){L(e.$$.fragment),t=ee(),i=J("img"),ge(i.src,a=r[17])||m(i,"src",a),m(i,"alt",""),m(i,"loading","lazy"),m(i,"class","svelte-p3y7hu"),j(i,"selectable",r[12]),j(i,"webcam",r[6]==="webcam"&&r[10])},m(o,h){H(e,o,h),O(o,t,h),O(o,i,h),n=!0,s||(l=ie(i,"click",r[33]),s=!0)},p(o,h){const u={};h[0]&16384&&(u.i18n=o[14]),e.$set(u),(!n||h[0]&131072&&!ge(i.src,a=o[17]))&&m(i,"src",a),(!n||h[0]&4096)&&j(i,"selectable",o[12]),(!n||h[0]&1088)&&j(i,"webcam",o[6]==="webcam"&&o[10])},i(o){n||(y(e.$$.fragment,o),n=!0)},o(o){E(e.$$.fragment,o),n=!1},d(o){o&&(T(t),T(i)),P(e,o),s=!1,l()}}}function Ea(r){let e,t,i,a,n={image:r[0].data};return e=new hr({props:n}),r[54](e),e.$on("crop",r[29]),i=new Ot({props:{i18n:r[14]}}),i.$on("clear",r[55]),{c(){L(e.$$.fragment),t=ee(),L(i.$$.fragment)},m(s,l){H(e,s,l),O(s,t,l),H(i,s,l),a=!0},p(s,l){const o={};l[0]&1&&(o.image=s[0].data),e.$set(o);const h={};l[0]&16384&&(h.i18n=s[14]),i.$set(h)},i(s){a||(y(e.$$.fragment,s),y(i.$$.fragment,s),a=!0)},o(s){E(e.$$.fragment,s),E(i.$$.fragment,s),a=!1},d(s){s&&T(t),r[54](null),P(e,s),P(i,s)}}}function Ma(r){let e,t,i=r[6]==="webcam"&&!r[26]&&Wi(r);return{c(){i&&i.c(),e=Pe()},m(a,n){i&&i.m(a,n),O(a,e,n),t=!0},p(a,n){a[6]==="webcam"&&!a[26]?i?(i.p(a,n),n[0]&67108928&&y(i,1)):(i=Wi(a),i.c(),y(i,1),i.m(e.parentNode,e)):i&&(we(),E(i,1,1,()=>{i=null}),ye())},i(a){t||(y(i),t=!0)},o(a){E(i),t=!1},d(a){a&&T(e),i&&i.d(a)}}}function Oa(r){let e,t,i,a,n,s,l;e=new ei({}),e.$on("undo",r[46]),e.$on("remove_image",r[31]);let o=r[1]==="color-sketch"&&Yi(r);function h(f){r[49](f)}function u(f){r[50](f)}let c={value:r[0],mode:r[22],width:r[20]||r[25],height:r[19]||r[24],container_height:r[21]||r[24],shape:r[7]};return r[2]!==void 0&&(c.brush_radius=r[2]),r[3]!==void 0&&(c.brush_color=r[3]),a=new $t({props:c}),q.push(()=>_e(a,"brush_radius",h)),q.push(()=>_e(a,"brush_color",u)),r[51](a),a.$on("change",r[29]),a.$on("clear",r[31]),{c(){L(e.$$.fragment),t=ee(),o&&o.c(),i=ee(),L(a.$$.fragment)},m(f,d){H(e,f,d),O(f,t,d),o&&o.m(f,d),O(f,i,d),H(a,f,d),l=!0},p(f,d){f[1]==="color-sketch"?o?(o.p(f,d),d[0]&2&&y(o,1)):(o=Yi(f),o.c(),y(o,1),o.m(i.parentNode,i)):o&&(we(),E(o,1,1,()=>{o=null}),ye());const _={};d[0]&1&&(_.value=f[0]),d[0]&4194304&&(_.mode=f[22]),d[0]&34603008&&(_.width=f[20]||f[25]),d[0]&17301504&&(_.height=f[19]||f[24]),d[0]&18874368&&(_.container_height=f[21]||f[24]),d[0]&128&&(_.shape=f[7]),!n&&d[0]&4&&(n=!0,_.brush_radius=f[2],pe(()=>n=!1)),!s&&d[0]&8&&(s=!0,_.brush_color=f[3],pe(()=>s=!1)),a.$set(_)},i(f){l||(y(e.$$.fragment,f),y(o),y(a.$$.fragment,f),l=!0)},o(f){E(e.$$.fragment,f),E(o),E(a.$$.fragment,f),l=!1},d(f){f&&(T(t),T(i)),P(e,f),o&&o.d(f),r[51](null),P(a,f)}}}function Ta(r){let e,t,i;function a(s){r[45](s)}let n={filetype:"image/*",include_file_metadata:!1,disable_click:!!r[0],root:r[13],$$slots:{default:[Na]},$$scope:{ctx:r}};return r[16]!==void 0&&(n.dragging=r[16]),e=new Nr({props:n}),q.push(()=>_e(e,"dragging",a)),e.$on("load",r[27]),{c(){L(e.$$.fragment)},m(s,l){H(e,s,l),i=!0},p(s,l){const o={};l[0]&1&&(o.disable_click=!!s[0]),l[0]&8192&&(o.root=s[13]),l[0]&134143439|l[2]&8&&(o.$$scope={dirty:l,ctx:s}),!t&&l[0]&65536&&(t=!0,o.dragging=s[16],pe(()=>t=!1)),e.$set(o)},i(s){i||(y(e.$$.fragment,s),i=!0)},o(s){E(e.$$.fragment,s),i=!1},d(s){P(e,s)}}}function Li(r){let e,t,i,a;return{c(){e=J("img"),m(e,"class","absolute-img svelte-p3y7hu"),ge(e.src,t=r[26]||r[17])||m(e,"src",t),m(e,"alt",""),m(e,"loading","lazy"),j(e,"webcam",r[6]==="webcam"&&r[10])},m(n,s){O(n,e,s),r[57](e),i||(a=ie(e,"load",r[30]),i=!0)},p(n,s){s[0]&67239936&&!ge(e.src,t=n[26]||n[17])&&m(e,"src",t),s[0]&1088&&j(e,"webcam",n[6]==="webcam"&&n[10])},d(n){n&&T(e),r[57](null),i=!1,a()}}}function Hi(r){let e,t,i,a,n,s,l,o;function h(d){r[59](d)}function u(d){r[60](d)}let c={value:r[0],mode:r[22],width:r[20]||r[25],height:r[19]||r[24],container_height:r[21]||r[24],value_img:r[23],source:r[6]};r[2]!==void 0&&(c.brush_radius=r[2]),r[3]!==void 0&&(c.brush_color=r[3]),e=new $t({props:c}),r[58](e),q.push(()=>_e(e,"brush_radius",h)),q.push(()=>_e(e,"brush_color",u)),e.$on("change",r[29]),n=new ei({}),n.$on("undo",r[61]),n.$on("remove_image",r[31]);let f=(r[1]==="color-sketch"||r[1]==="sketch")&&Pi(r);return{c(){L(e.$$.fragment),a=ee(),L(n.$$.fragment),s=ee(),f&&f.c(),l=Pe()},m(d,_){H(e,d,_),O(d,a,_),H(n,d,_),O(d,s,_),f&&f.m(d,_),O(d,l,_),o=!0},p(d,_){const v={};_[0]&1&&(v.value=d[0]),_[0]&4194304&&(v.mode=d[22]),_[0]&34603008&&(v.width=d[20]||d[25]),_[0]&17301504&&(v.height=d[19]||d[24]),_[0]&18874368&&(v.container_height=d[21]||d[24]),_[0]&8388608&&(v.value_img=d[23]),_[0]&64&&(v.source=d[6]),!t&&_[0]&4&&(t=!0,v.brush_radius=d[2],pe(()=>t=!1)),!i&&_[0]&8&&(i=!0,v.brush_color=d[3],pe(()=>i=!1)),e.$set(v),d[1]==="color-sketch"||d[1]==="sketch"?f?(f.p(d,_),_[0]&2&&y(f,1)):(f=Pi(d),f.c(),y(f,1),f.m(l.parentNode,l)):f&&(we(),E(f,1,1,()=>{f=null}),ye())},i(d){o||(y(e.$$.fragment,d),y(n.$$.fragment,d),y(f),o=!0)},o(d){E(e.$$.fragment,d),E(n.$$.fragment,d),E(f),o=!1},d(d){d&&(T(a),T(s),T(l)),r[58](null),P(e,d),P(n,d),f&&f.d(d)}}}function Pi(r){let e,t,i,a;function n(o){r[62](o)}function s(o){r[63](o)}let l={container_height:r[21]||r[24],img_width:r[20]||r[25],img_height:r[19]||r[24],mode:r[22]};return r[2]!==void 0&&(l.brush_radius=r[2]),r[3]!==void 0&&(l.brush_color=r[3]),e=new ti({props:l}),q.push(()=>_e(e,"brush_radius",n)),q.push(()=>_e(e,"brush_color",s)),{c(){L(e.$$.fragment)},m(o,h){H(e,o,h),a=!0},p(o,h){const u={};h[0]&18874368&&(u.container_height=o[21]||o[24]),h[0]&34603008&&(u.img_width=o[20]||o[25]),h[0]&17301504&&(u.img_height=o[19]||o[24]),h[0]&4194304&&(u.mode=o[22]),!t&&h[0]&4&&(t=!0,u.brush_radius=o[2],pe(()=>t=!1)),!i&&h[0]&8&&(i=!0,u.brush_color=o[3],pe(()=>i=!1)),e.$set(u)},i(o){a||(y(e.$$.fragment,o),a=!0)},o(o){E(e.$$.fragment,o),a=!1},d(o){P(e,o)}}}function Wi(r){let e,t;return e=new tn({props:{streaming:r[8],pending:r[9],mirror_webcam:r[10]}}),e.$on("capture",r[52]),e.$on("stream",r[29]),e.$on("error",r[53]),{c(){L(e.$$.fragment)},m(i,a){H(e,i,a),t=!0},p(i,a){const n={};a[0]&256&&(n.streaming=i[8]),a[0]&512&&(n.pending=i[9]),a[0]&1024&&(n.mirror_webcam=i[10]),e.$set(n)},i(i){t||(y(e.$$.fragment,i),t=!0)},o(i){E(e.$$.fragment,i),t=!1},d(i){P(e,i)}}}function Yi(r){let e,t,i,a;function n(o){r[47](o)}function s(o){r[48](o)}let l={container_height:r[21]||r[24],img_width:r[20]||r[25],img_height:r[19]||r[24]};return r[2]!==void 0&&(l.brush_radius=r[2]),r[3]!==void 0&&(l.brush_color=r[3]),e=new ti({props:l}),q.push(()=>_e(e,"brush_radius",n)),q.push(()=>_e(e,"brush_color",s)),{c(){L(e.$$.fragment)},m(o,h){H(e,o,h),a=!0},p(o,h){const u={};h[0]&18874368&&(u.container_height=o[21]||o[24]),h[0]&34603008&&(u.img_width=o[20]||o[25]),h[0]&17301504&&(u.img_height=o[19]||o[24]),!t&&h[0]&4&&(t=!0,u.brush_radius=o[2],pe(()=>t=!1)),!i&&h[0]&8&&(i=!0,u.brush_color=o[3],pe(()=>i=!1)),e.$set(u)},i(o){a||(y(e.$$.fragment,o),a=!0)},o(o){E(e.$$.fragment,o),a=!1},d(o){P(e,o)}}}function Ca(r){let e,t,i,a;return{c(){e=J("img"),ge(e.src,t=r[0].image||r[0].data)||m(e,"src",t),m(e,"alt","hello"),m(e,"loading","lazy"),m(e,"class","svelte-p3y7hu"),j(e,"webcam",r[6]==="webcam"&&r[10]),j(e,"selectable",r[12])},m(n,s){O(n,e,s),i||(a=ie(e,"click",r[33]),i=!0)},p(n,s){s[0]&1&&!ge(e.src,t=n[0].image||n[0].data)&&m(e,"src",t),s[0]&1088&&j(e,"webcam",n[6]==="webcam"&&n[10]),s[0]&4096&&j(e,"selectable",n[12])},i:Y,o:Y,d(n){n&&T(e),i=!1,a()}}}function Ra(r){let e=r[26],t,i,a,n=Xi(r),s=r[20]>0&&Ui(r);return{c(){n.c(),t=ee(),s&&s.c(),i=Pe()},m(l,o){n.m(l,o),O(l,t,o),s&&s.m(l,o),O(l,i,o),a=!0},p(l,o){o[0]&67108864&&le(e,e=l[26])?(n.d(1),n=Xi(l),n.c(),n.m(t.parentNode,t)):n.p(l,o),l[20]>0?s?(s.p(l,o),o[0]&1048576&&y(s,1)):(s=Ui(l),s.c(),y(s,1),s.m(i.parentNode,i)):s&&(we(),E(s,1,1,()=>{s=null}),ye())},i(l){a||(y(s),a=!0)},o(l){E(s),a=!1},d(l){l&&(T(t),T(i)),n.d(l),s&&s.d(l)}}}function Aa(r){let e,t,i,a,n,s,l;return e=new Ot({props:{i18n:r[14],editable:!0}}),e.$on("edit",r[37]),e.$on("clear",r[28]),{c(){L(e.$$.fragment),t=ee(),i=J("img"),ge(i.src,a=r[17].data)||m(i,"src",a),m(i,"alt",""),m(i,"loading","lazy"),m(i,"class","svelte-p3y7hu"),j(i,"scale-x-[-1]",r[6]==="webcam"&&r[10]),j(i,"selectable",r[12])},m(o,h){H(e,o,h),O(o,t,h),O(o,i,h),n=!0,s||(l=ie(i,"click",r[33]),s=!0)},p(o,h){const u={};h[0]&16384&&(u.i18n=o[14]),e.$set(u),(!n||h[0]&131072&&!ge(i.src,a=o[17].data))&&m(i,"src",a),(!n||h[0]&1088)&&j(i,"scale-x-[-1]",o[6]==="webcam"&&o[10]),(!n||h[0]&4096)&&j(i,"selectable",o[12])},i(o){n||(y(e.$$.fragment,o),n=!0)},o(o){E(e.$$.fragment,o),n=!1},d(o){o&&(T(t),T(i)),P(e,o),s=!1,l()}}}function Sa(r){let e,t,i,a,n={image:r[17].data};return e=new hr({props:n}),r[35](e),e.$on("crop",r[29]),i=new Ot({props:{i18n:r[14]}}),i.$on("clear",r[36]),{c(){L(e.$$.fragment),t=ee(),L(i.$$.fragment)},m(s,l){H(e,s,l),O(s,t,l),H(i,s,l),a=!0},p(s,l){const o={};l[0]&131072&&(o.image=s[17].data),e.$set(o);const h={};l[0]&16384&&(h.i18n=s[14]),i.$set(h)},i(s){a||(y(e.$$.fragment,s),y(i.$$.fragment,s),a=!0)},o(s){E(e.$$.fragment,s),E(i.$$.fragment,s),a=!1},d(s){s&&T(t),r[35](null),P(e,s),P(i,s)}}}function Ia(r){let e;const t=r[34].default,i=wr(t,r,r[65],null);return{c(){i&&i.c()},m(a,n){i&&i.m(a,n),e=!0},p(a,n){i&&i.p&&(!e||n[2]&8)&&yr(i,t,a,a[65],e?Dr(t,a[65],n,null):kr(a[65]),null)},i(a){e||(y(i,a),e=!0)},o(a){E(i,a),e=!1},d(a){i&&i.d(a)}}}function Xi(r){let e,t,i,a;return{c(){e=J("img"),m(e,"class","absolute-img svelte-p3y7hu"),ge(e.src,t=r[26]||r[0]?.image?.data||r[0]?.data)||m(e,"src",t),m(e,"alt",""),m(e,"loading","lazy"),m(e,"crossorigin","anonymous"),j(e,"webcam",r[6]==="webcam"&&r[10])},m(n,s){O(n,e,s),r[38](e),i||(a=ie(e,"load",r[30]),i=!0)},p(n,s){s[0]&67108865&&!ge(e.src,t=n[26]||n[0]?.image?.data||n[0]?.data)&&m(e,"src",t),s[0]&1088&&j(e,"webcam",n[6]==="webcam"&&n[10])},d(n){n&&T(e),r[38](null),i=!1,a()}}}function Ui(r){let e,t,i,a,n,s,l,o;function h(d){r[40](d)}function u(d){r[41](d)}let c={value:r[0],mask_opacity:r[11],mode:r[22],width:r[20]||r[25],height:r[19]||r[24],container_height:r[21]||r[24],value_img:r[23],source:r[6],shape:r[7]};r[2]!==void 0&&(c.brush_radius=r[2]),r[3]!==void 0&&(c.brush_color=r[3]),e=new $t({props:c}),r[39](e),q.push(()=>_e(e,"brush_radius",h)),q.push(()=>_e(e,"brush_color",u)),e.$on("change",r[29]),n=new ei({props:{show_eraser:r[23]}}),n.$on("undo",r[42]),n.$on("clear_mask",r[32]),n.$on("remove_image",r[31]);let f=(r[1]==="color-sketch"||r[1]==="sketch")&&ji(r);return{c(){L(e.$$.fragment),a=ee(),L(n.$$.fragment),s=ee(),f&&f.c(),l=Pe()},m(d,_){H(e,d,_),O(d,a,_),H(n,d,_),O(d,s,_),f&&f.m(d,_),O(d,l,_),o=!0},p(d,_){const v={};_[0]&1&&(v.value=d[0]),_[0]&2048&&(v.mask_opacity=d[11]),_[0]&4194304&&(v.mode=d[22]),_[0]&34603008&&(v.width=d[20]||d[25]),_[0]&17301504&&(v.height=d[19]||d[24]),_[0]&18874368&&(v.container_height=d[21]||d[24]),_[0]&8388608&&(v.value_img=d[23]),_[0]&64&&(v.source=d[6]),_[0]&128&&(v.shape=d[7]),!t&&_[0]&4&&(t=!0,v.brush_radius=d[2],pe(()=>t=!1)),!i&&_[0]&8&&(i=!0,v.brush_color=d[3],pe(()=>i=!1)),e.$set(v);const D={};_[0]&8388608&&(D.show_eraser=d[23]),n.$set(D),d[1]==="color-sketch"||d[1]==="sketch"?f?(f.p(d,_),_[0]&2&&y(f,1)):(f=ji(d),f.c(),y(f,1),f.m(l.parentNode,l)):f&&(we(),E(f,1,1,()=>{f=null}),ye())},i(d){o||(y(e.$$.fragment,d),y(n.$$.fragment,d),y(f),o=!0)},o(d){E(e.$$.fragment,d),E(n.$$.fragment,d),E(f),o=!1},d(d){d&&(T(a),T(s),T(l)),r[39](null),P(e,d),P(n,d),f&&f.d(d)}}}function ji(r){let e,t,i,a;function n(o){r[43](o)}function s(o){r[44](o)}let l={container_height:r[21]||r[24],img_width:r[20]||r[25],img_height:r[19]||r[24],mode:r[22]};return r[2]!==void 0&&(l.brush_radius=r[2]),r[3]!==void 0&&(l.brush_color=r[3]),e=new ti({props:l}),q.push(()=>_e(e,"brush_radius",n)),q.push(()=>_e(e,"brush_color",s)),{c(){L(e.$$.fragment)},m(o,h){H(e,o,h),a=!0},p(o,h){const u={};h[0]&18874368&&(u.container_height=o[21]||o[24]),h[0]&34603008&&(u.img_width=o[20]||o[25]),h[0]&17301504&&(u.img_height=o[19]||o[24]),h[0]&4194304&&(u.mode=o[22]),!t&&h[0]&4&&(t=!0,u.brush_radius=o[2],pe(()=>t=!1)),!i&&h[0]&8&&(i=!0,u.brush_color=o[3],pe(()=>i=!1)),e.$set(u)},i(o){a||(y(e.$$.fragment,o),a=!0)},o(o){E(e.$$.fragment,o),a=!1},d(o){P(e,o)}}}function Na(r){let e,t,i,a;const n=[Ia,Sa,Aa,Ra,Ca],s=[];function l(o,h){return o[0]===null&&!o[26]||o[8]?0:o[1]==="select"?1:o[1]==="editor"?2:(o[1]==="sketch"||o[1]==="color-sketch")&&(o[0]!==null||o[26])?3:4}return e=l(r),t=s[e]=n[e](r),{c(){t.c(),i=Pe()},m(o,h){s[e].m(o,h),O(o,i,h),a=!0},p(o,h){let u=e;e=l(o),e===u?s[e].p(o,h):(we(),E(s[u],1,1,()=>{s[u]=null}),ye(),t=s[e],t?t.p(o,h):(t=s[e]=n[e](o),t.c()),y(t,1),t.m(i.parentNode,i))},i(o){a||(y(t),a=!0)},o(o){E(t),a=!1},d(o){o&&T(i),s[e].d(o)}}}function za(r){let e,t,i,a,n,s,l;e=new Rr({props:{show_label:r[5],Icon:r[6]==="canvas"?li:oi,label:r[4]||(r[6]==="canvas"?"Sketch":"Image")}});const o=[Ta,Oa,Ma,Ea,Da,ka,ya],h=[];function u(c,f){return c[6]==="upload"?0:c[6]==="canvas"?1:c[0]===null&&!c[26]||c[8]?2:c[1]==="select"?3:c[1]==="editor"?4:(c[1]==="sketch"||c[1]==="color-sketch")&&(c[0]!==null||c[26])?5:6}return a=u(r),n=h[a]=o[a](r),{c(){L(e.$$.fragment),t=ee(),i=J("div"),n.c(),m(i,"data-testid","image"),m(i,"class","image-container svelte-p3y7hu"),Ft(()=>r[64].call(i))},m(c,f){H(e,c,f),O(c,t,f),O(c,i,f),h[a].m(i,null),s=qi(i,r[64].bind(i)),l=!0},p(c,f){const d={};f[0]&32&&(d.show_label=c[5]),f[0]&64&&(d.Icon=c[6]==="canvas"?li:oi),f[0]&80&&(d.label=c[4]||(c[6]==="canvas"?"Sketch":"Image")),e.$set(d);let _=a;a=u(c),a===_?h[a].p(c,f):(we(),E(h[_],1,1,()=>{h[_]=null}),ye(),n=h[a],n?n.p(c,f):(n=h[a]=o[a](c),n.c()),y(n,1),n.m(i,null))},i(c){l||(y(e.$$.fragment,c),y(n),l=!0)},o(c){E(e.$$.fragment,c),E(n),l=!1},d(c){c&&(T(t),T(i)),P(e,c),h[a].d(),s()}}}function Ba(r,e,t){let{$$slots:i={},$$scope:a}=e,{value:n}=e,{label:s=void 0}=e,{show_label:l}=e,{source:o="upload"}=e,{tool:h="editor"}=e,{shape:u}=e,{streaming:c=!1}=e,{pending:f=!1}=e,{mirror_webcam:d}=e,{brush_radius:_}=e,{brush_color:v="#000000"}=e,{mask_opacity:D}=e,{selectable:I=!1}=e,{root:A}=e,{i18n:N}=e,W,w;n&&(o==="upload"||o==="webcam")&&h==="sketch"&&(n={image:n,mask:null});function g({detail:b}){h==="color-sketch"?t(26,ke=Je(b,A,null)?.data):t(0,n=(o==="upload"||o==="webcam")&&h==="sketch"?{image:Je(b,A,null),mask:null}:Je(b,A,null)),X("upload",Je(b,A,null))}function M({detail:b}){t(0,n=null),t(26,ke=void 0),X("clear")}async function R({detail:b},Oe){he==="mask"?o==="webcam"&&Oe?t(0,n={image:b,mask:null}):t(0,n={image:typeof n=="string"?n:n?.image||null,mask:b}):(o==="upload"||o==="webcam")&&h==="sketch"?t(0,n={image:b,mask:null}):t(0,n=b),await Le(),X(c?"stream":"edit")}const X=st();let B=!1,te=null;function se(b){const Oe=b.currentTarget;t(20,oe=Oe.naturalWidth),t(19,K=Oe.naturalHeight),t(21,ce=Oe.getBoundingClientRect().height)}async function U(){X("clear"),W.clear(),await Le(),t(0,n=null),t(26,ke=void 0)}async function x(){W.clear_mask(),await Le()}let K=0,oe=0,ce=0,he,ue,Me,k,ke;Gt(async()=>{h==="color-sketch"&&n&&typeof n=="string"&&(t(26,ke=n),await Le(),se({currentTarget:ue}))});function We(b){let Oe=Ar(b);Oe&&X("select",{index:Oe,value:null})}function Ye(b){q[b?"unshift":"push"](()=>{w=b,t(15,w),t(0,n)})}const Ke=b=>(M(b),t(1,h="editor")),ot=()=>t(1,h="select");function lt(b){q[b?"unshift":"push"](()=>{ue=b,t(23,ue)})}function ht(b){q[b?"unshift":"push"](()=>{W=b,t(18,W)})}function ut(b){_=b,t(2,_)}function ct(b){v=b,t(3,v)}const Xe=()=>W.undo();function ft(b){_=b,t(2,_)}function dt(b){v=b,t(3,v)}function mt(b){B=b,t(16,B)}const gt=()=>W.undo();function _t(b){_=b,t(2,_)}function Re(b){v=b,t(3,v)}function Ne(b){_=b,t(2,_)}function pt(b){v=b,t(3,v)}function Qe(b){q[b?"unshift":"push"](()=>{W=b,t(18,W)})}const Rt=b=>h==="color-sketch"?g(b):R(b,!0);function bt(b){Fi.call(this,r,b)}function At(b){q[b?"unshift":"push"](()=>{w=b,t(15,w),t(0,n)})}const St=b=>(M(b),t(1,h="editor")),It=()=>t(1,h="select");function Nt(b){q[b?"unshift":"push"](()=>{ue=b,t(23,ue)})}function p(b){q[b?"unshift":"push"](()=>{W=b,t(18,W)})}function C(b){_=b,t(2,_)}function z(b){v=b,t(3,v)}const ne=()=>W.undo();function G(b){_=b,t(2,_)}function fe(b){v=b,t(3,v)}function Ue(){Me=this.offsetHeight,k=this.offsetWidth,t(24,Me),t(25,k)}return r.$$set=b=>{"value"in b&&t(0,n=b.value),"label"in b&&t(4,s=b.label),"show_label"in b&&t(5,l=b.show_label),"source"in b&&t(6,o=b.source),"tool"in b&&t(1,h=b.tool),"shape"in b&&t(7,u=b.shape),"streaming"in b&&t(8,c=b.streaming),"pending"in b&&t(9,f=b.pending),"mirror_webcam"in b&&t(10,d=b.mirror_webcam),"brush_radius"in b&&t(2,_=b.brush_radius),"brush_color"in b&&t(3,v=b.brush_color),"mask_opacity"in b&&t(11,D=b.mask_opacity),"selectable"in b&&t(12,I=b.selectable),"root"in b&&t(13,A=b.root),"i18n"in b&&t(14,N=b.i18n),"$$scope"in b&&t(65,a=b.$$scope)},r.$$.update=()=>{r.$$.dirty[0]&65536&&X("drag",B),r.$$.dirty[0]&139265&&n!==te&&(t(17,te=n),Je(te,A,null)),r.$$.dirty[0]&66&&(o==="canvas"&&h==="sketch"?t(22,he="bw-sketch"):h==="color-sketch"?t(22,he="color-sketch"):(o==="upload"||o==="webcam")&&h==="sketch"?t(22,he="mask"):t(22,he="editor")),r.$$.dirty[0]&1&&(n===null||n.image===null&&n.mask===null)&&t(26,ke=void 0),r.$$.dirty[0]&32769&&w&&(n?(t(15,w.image=n,w),w.create()):w.destroy())},[n,h,_,v,s,l,o,u,c,f,d,D,I,A,N,w,B,te,W,K,oe,ce,he,ue,Me,k,ke,g,M,R,se,U,x,We,i,Ye,Ke,ot,lt,ht,ut,ct,Xe,ft,dt,mt,gt,_t,Re,Ne,pt,Qe,Rt,bt,At,St,It,Nt,p,C,z,ne,G,fe,Ue,a]}class La extends be{constructor(e){super(),ve(this,e,Ba,za,le,{value:0,label:4,show_label:5,source:6,tool:1,shape:7,streaming:8,pending:9,mirror_webcam:10,brush_radius:2,brush_color:3,mask_opacity:11,selectable:12,root:13,i18n:14},null,[-1,-1,-1])}}function Ha(r){let e,t;return e=new zr({props:{i18n:r[23].i18n,type:"image"}}),{c(){L(e.$$.fragment)},m(i,a){H(e,i,a),t=!0},p(i,a){const n={};a[0]&8388608&&(n.i18n=i[23].i18n),e.$set(n)},i(i){t||(y(e.$$.fragment,i),t=!0)},o(i){E(e.$$.fragment,i),t=!1},d(i){P(e,i)}}}function Pa(r){let e,t,i,a,n;const s=[{autoscroll:r[23].autoscroll},{i18n:r[23].i18n},r[1]];let l={};for(let u=0;u<s.length;u+=1)l=Er(l,s[u]);e=new Mr({props:l});function o(u){r[25](u)}let h={brush_radius:r[15],brush_color:r[16],shape:r[14],source:r[5],tool:r[6],selectable:r[18],mask_opacity:r[17],root:r[22],label:r[7],show_label:r[8],pending:r[10],streaming:r[9],mirror_webcam:r[13],i18n:r[23].i18n,$$slots:{default:[Ha]},$$scope:{ctx:r}};return r[0]!==void 0&&(h.value=r[0]),i=new La({props:h}),q.push(()=>_e(i,"value",o)),i.$on("edit",r[26]),i.$on("clear",r[27]),i.$on("stream",r[28]),i.$on("drag",r[29]),i.$on("upload",r[30]),i.$on("select",r[31]),i.$on("share",r[32]),i.$on("error",r[33]),{c(){L(e.$$.fragment),t=ee(),L(i.$$.fragment)},m(u,c){H(e,u,c),O(u,t,c),H(i,u,c),n=!0},p(u,c){const f=c[0]&8388610?Or(s,[c[0]&8388608&&{autoscroll:u[23].autoscroll},c[0]&8388608&&{i18n:u[23].i18n},c[0]&2&&Tr(u[1])]):{};e.$set(f);const d={};c[0]&32768&&(d.brush_radius=u[15]),c[0]&65536&&(d.brush_color=u[16]),c[0]&16384&&(d.shape=u[14]),c[0]&32&&(d.source=u[5]),c[0]&64&&(d.tool=u[6]),c[0]&262144&&(d.selectable=u[18]),c[0]&131072&&(d.mask_opacity=u[17]),c[0]&4194304&&(d.root=u[22]),c[0]&128&&(d.label=u[7]),c[0]&256&&(d.show_label=u[8]),c[0]&1024&&(d.pending=u[10]),c[0]&512&&(d.streaming=u[9]),c[0]&8192&&(d.mirror_webcam=u[13]),c[0]&8388608&&(d.i18n=u[23].i18n),c[0]&8388608|c[1]&8&&(d.$$scope={dirty:c,ctx:u}),!a&&c[0]&1&&(a=!0,d.value=u[0],pe(()=>a=!1)),i.$set(d)},i(u){n||(y(e.$$.fragment,u),y(i.$$.fragment,u),n=!0)},o(u){E(e.$$.fragment,u),E(i.$$.fragment,u),n=!1},d(u){u&&T(t),P(e,u),P(i,u)}}}function Wa(r){let e,t;return e=new Cr({props:{visible:r[4],variant:r[0]===null&&r[5]==="upload"?"dashed":"solid",border_mode:r[24]?"focus":"base",padding:!1,elem_id:r[2],elem_classes:r[3],height:r[11]||(r[5]==="webcam"?void 0:Vi),width:r[12],allow_overflow:!1,container:r[19],scale:r[20],min_width:r[21],$$slots:{default:[Pa]},$$scope:{ctx:r}}}),{c(){L(e.$$.fragment)},m(i,a){H(e,i,a),t=!0},p(i,a){const n={};a[0]&16&&(n.visible=i[4]),a[0]&33&&(n.variant=i[0]===null&&i[5]==="upload"?"dashed":"solid"),a[0]&16777216&&(n.border_mode=i[24]?"focus":"base"),a[0]&4&&(n.elem_id=i[2]),a[0]&8&&(n.elem_classes=i[3]),a[0]&2080&&(n.height=i[11]||(i[5]==="webcam"?void 0:Vi)),a[0]&4096&&(n.width=i[12]),a[0]&524288&&(n.container=i[19]),a[0]&1048576&&(n.scale=i[20]),a[0]&2097152&&(n.min_width=i[21]),a[0]&29878243|a[1]&8&&(n.$$scope={dirty:a,ctx:i}),e.$set(n)},i(i){t||(y(e.$$.fragment,i),t=!0)},o(i){E(e.$$.fragment,i),t=!1},d(i){P(e,i)}}}const Vi=240;function Ya(r,e,t){let{elem_id:i=""}=e,{elem_classes:a=[]}=e,{visible:n=!0}=e,{value:s=null}=e,{source:l="upload"}=e,{tool:o="editor"}=e,{label:h}=e,{show_label:u}=e,{streaming:c}=e,{pending:f}=e,{height:d}=e,{width:_}=e,{mirror_webcam:v}=e,{shape:D}=e,{brush_radius:I}=e,{brush_color:A}=e,{mask_opacity:N}=e,{selectable:W=!1}=e,{container:w=!0}=e,{scale:g=null}=e,{min_width:M=void 0}=e,{loading_status:R}=e,{root:X}=e,{gradio:B}=e,te;function se(k){s=k,t(0,s)}const U=()=>B.dispatch("edit"),x=()=>B.dispatch("clear"),K=()=>B.dispatch("stream"),oe=({detail:k})=>t(24,te=k),ce=()=>B.dispatch("upload"),he=({detail:k})=>B.dispatch("select",k),ue=({detail:k})=>B.dispatch("share",k),Me=({detail:k})=>{t(1,R=R||{}),t(1,R.status="error",R),B.dispatch("error",k)};return r.$$set=k=>{"elem_id"in k&&t(2,i=k.elem_id),"elem_classes"in k&&t(3,a=k.elem_classes),"visible"in k&&t(4,n=k.visible),"value"in k&&t(0,s=k.value),"source"in k&&t(5,l=k.source),"tool"in k&&t(6,o=k.tool),"label"in k&&t(7,h=k.label),"show_label"in k&&t(8,u=k.show_label),"streaming"in k&&t(9,c=k.streaming),"pending"in k&&t(10,f=k.pending),"height"in k&&t(11,d=k.height),"width"in k&&t(12,_=k.width),"mirror_webcam"in k&&t(13,v=k.mirror_webcam),"shape"in k&&t(14,D=k.shape),"brush_radius"in k&&t(15,I=k.brush_radius),"brush_color"in k&&t(16,A=k.brush_color),"mask_opacity"in k&&t(17,N=k.mask_opacity),"selectable"in k&&t(18,W=k.selectable),"container"in k&&t(19,w=k.container),"scale"in k&&t(20,g=k.scale),"min_width"in k&&t(21,M=k.min_width),"loading_status"in k&&t(1,R=k.loading_status),"root"in k&&t(22,X=k.root),"gradio"in k&&t(23,B=k.gradio)},r.$$.update=()=>{r.$$.dirty[0]&1&&t(0,s=s||null),r.$$.dirty[0]&8388609&&B.dispatch("change")},[s,R,i,a,n,l,o,h,u,c,f,d,_,v,D,I,A,N,W,w,g,M,X,B,te,se,U,x,K,oe,ce,he,ue,Me]}class Xa extends be{constructor(e){super(),ve(this,e,Ya,Wa,le,{elem_id:2,elem_classes:3,visible:4,value:0,source:5,tool:6,label:7,show_label:8,streaming:9,pending:10,height:11,width:12,mirror_webcam:13,shape:14,brush_radius:15,brush_color:16,mask_opacity:17,selectable:18,container:19,scale:20,min_width:21,loading_status:1,root:22,gradio:23},null,[-1,-1])}get elem_id(){return this.$$.ctx[2]}set elem_id(e){this.$$set({elem_id:e}),V()}get elem_classes(){return this.$$.ctx[3]}set elem_classes(e){this.$$set({elem_classes:e}),V()}get visible(){return this.$$.ctx[4]}set visible(e){this.$$set({visible:e}),V()}get value(){return this.$$.ctx[0]}set value(e){this.$$set({value:e}),V()}get source(){return this.$$.ctx[5]}set source(e){this.$$set({source:e}),V()}get tool(){return this.$$.ctx[6]}set tool(e){this.$$set({tool:e}),V()}get label(){return this.$$.ctx[7]}set label(e){this.$$set({label:e}),V()}get show_label(){return this.$$.ctx[8]}set show_label(e){this.$$set({show_label:e}),V()}get streaming(){return this.$$.ctx[9]}set streaming(e){this.$$set({streaming:e}),V()}get pending(){return this.$$.ctx[10]}set pending(e){this.$$set({pending:e}),V()}get height(){return this.$$.ctx[11]}set height(e){this.$$set({height:e}),V()}get width(){return this.$$.ctx[12]}set width(e){this.$$set({width:e}),V()}get mirror_webcam(){return this.$$.ctx[13]}set mirror_webcam(e){this.$$set({mirror_webcam:e}),V()}get shape(){return this.$$.ctx[14]}set shape(e){this.$$set({shape:e}),V()}get brush_radius(){return this.$$.ctx[15]}set brush_radius(e){this.$$set({brush_radius:e}),V()}get brush_color(){return this.$$.ctx[16]}set brush_color(e){this.$$set({brush_color:e}),V()}get mask_opacity(){return this.$$.ctx[17]}set mask_opacity(e){this.$$set({mask_opacity:e}),V()}get selectable(){return this.$$.ctx[18]}set selectable(e){this.$$set({selectable:e}),V()}get container(){return this.$$.ctx[19]}set container(e){this.$$set({container:e}),V()}get scale(){return this.$$.ctx[20]}set scale(e){this.$$set({scale:e}),V()}get min_width(){return this.$$.ctx[21]}set min_width(e){this.$$set({min_width:e}),V()}get loading_status(){return this.$$.ctx[1]}set loading_status(e){this.$$set({loading_status:e}),V()}get root(){return this.$$.ctx[22]}set root(e){this.$$set({root:e}),V()}get gradio(){return this.$$.ctx[23]}set gradio(e){this.$$set({gradio:e}),V()}}const $a=Xa;export{$a as I,tn as W};
//# sourceMappingURL=InteractiveImage-ae6b87f4.js.map
