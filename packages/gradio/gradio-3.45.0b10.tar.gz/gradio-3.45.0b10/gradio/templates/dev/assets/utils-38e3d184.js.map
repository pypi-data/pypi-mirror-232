{"version":3,"file":"utils-38e3d184.js","sources":["../../../../js/icons/src/Music.svelte","../../../../js/audio/shared/utils.ts"],"sourcesContent":["<svg\n\txmlns=\"http://www.w3.org/2000/svg\"\n\twidth=\"100%\"\n\theight=\"100%\"\n\tviewBox=\"0 0 24 24\"\n\tfill=\"none\"\n\tstroke=\"currentColor\"\n\tstroke-width=\"1.5\"\n\tstroke-linecap=\"round\"\n\tstroke-linejoin=\"round\"\n\tclass=\"feather feather-music\"\n>\n\t<path d=\"M9 18V5l12-2v13\" />\n\t<circle cx=\"6\" cy=\"18\" r=\"3\" />\n\t<circle cx=\"18\" cy=\"16\" r=\"3\" />\n</svg>\n","import type { ActionReturn } from \"svelte/action\";\n\ninterface LoadedParams {\n\tcrop_values?: [number, number];\n\tautoplay?: boolean;\n}\n\nexport function loaded(\n\tnode: HTMLAudioElement,\n\t{ crop_values, autoplay }: LoadedParams = {}\n): ActionReturn {\n\tfunction clamp_playback(): void {\n\t\tif (crop_values === undefined) return;\n\n\t\tconst start_time = (crop_values[0] / 100) * node.duration;\n\t\tconst end_time = (crop_values[1] / 100) * node.duration;\n\n\t\tif (node.currentTime < start_time) {\n\t\t\tnode.currentTime = start_time;\n\t\t}\n\n\t\tif (node.currentTime > end_time) {\n\t\t\tnode.currentTime = start_time;\n\t\t\tnode.pause();\n\t\t}\n\t}\n\n\tasync function handle_playback(): Promise<void> {\n\t\tif (!autoplay) return;\n\n\t\tnode.pause();\n\t\tawait node.play();\n\t}\n\n\tnode.addEventListener(\"loadeddata\", handle_playback);\n\tnode.addEventListener(\"timeupdate\", clamp_playback);\n\n\treturn {\n\t\tdestroy(): void {\n\t\t\tnode.removeEventListener(\"loadeddata\", handle_playback);\n\t\t\tnode.removeEventListener(\"timeupdate\", clamp_playback);\n\t\t}\n\t};\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GAAA,UAeK,CAAA,MAAA,EAAA,GAAA,EAAA,MAAA,CAAA,CAAA;GAHJ,UAA2B,CAAA,GAAA,EAAA,IAAA,CAAA,CAAA;GAC3B,UAA8B,CAAA,GAAA,EAAA,OAAA,CAAA,CAAA;GAC9B,UAA+B,CAAA,GAAA,EAAA,OAAA,CAAA,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACPzB,SAAS,OACf,IACA,EAAA,EAAE,aAAa,QAAS,EAAA,GAAkB,EAC3B,EAAA;AACf,EAAA,SAAS,cAAuB,GAAA;AAC/B,IAAA,IAAI,WAAgB,KAAA,KAAA,CAAA;AAAW,MAAA,OAAA;AAE/B,IAAA,MAAM,UAAc,GAAA,WAAA,CAAY,CAAC,CAAA,GAAI,MAAO,IAAK,CAAA,QAAA,CAAA;AACjD,IAAA,MAAM,QAAY,GAAA,WAAA,CAAY,CAAC,CAAA,GAAI,MAAO,IAAK,CAAA,QAAA,CAAA;AAE/C,IAAI,IAAA,IAAA,CAAK,cAAc,UAAY,EAAA;AAClC,MAAA,IAAA,CAAK,WAAc,GAAA,UAAA,CAAA;AAAA,KACpB;AAEA,IAAI,IAAA,IAAA,CAAK,cAAc,QAAU,EAAA;AAChC,MAAA,IAAA,CAAK,WAAc,GAAA,UAAA,CAAA;AACnB,MAAA,IAAA,CAAK,KAAM,EAAA,CAAA;AAAA,KACZ;AAAA,GACD;AAEA,EAAA,eAAe,eAAiC,GAAA;AAC/C,IAAA,IAAI,CAAC,QAAA;AAAU,MAAA,OAAA;AAEf,IAAA,IAAA,CAAK,KAAM,EAAA,CAAA;AACX,IAAA,MAAM,KAAK,IAAK,EAAA,CAAA;AAAA,GACjB;AAEA,EAAK,IAAA,CAAA,gBAAA,CAAiB,cAAc,eAAe,CAAA,CAAA;AACnD,EAAK,IAAA,CAAA,gBAAA,CAAiB,cAAc,cAAc,CAAA,CAAA;AAElD,EAAO,OAAA;AAAA,IACN,OAAgB,GAAA;AACf,MAAK,IAAA,CAAA,mBAAA,CAAoB,cAAc,eAAe,CAAA,CAAA;AACtD,MAAK,IAAA,CAAA,mBAAA,CAAoB,cAAc,cAAc,CAAA,CAAA;AAAA,KACtD;AAAA,GACD,CAAA;AACD;;;;"}