{"version":3,"file":"Player-e3b17fa3.js","sources":["../../../../js/icons/src/Maximise.svelte","../../../../js/icons/src/Pause.svelte","../../../../js/icons/src/Play.svelte","../../../../js/icons/src/Video.svelte","../../../../js/video/shared/Player.svelte"],"sourcesContent":["<svg\n\txmlns=\"http://www.w3.org/2000/svg\"\n\twidth=\"100%\"\n\theight=\"100%\"\n\tviewBox=\"0 0 24 24\"\n\tfill=\"none\"\n\tstroke=\"currentColor\"\n\tstroke-width=\"1.5\"\n\tstroke-linecap=\"round\"\n\tstroke-linejoin=\"round\"\n>\n\t<path\n\t\td=\"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3\"\n\t/>\n</svg>\n","<svg\n\txmlns=\"http://www.w3.org/2000/svg\"\n\twidth=\"100%\"\n\theight=\"100%\"\n\tviewBox=\"0 0 24 24\"\n\tfill=\"none\"\n\tstroke=\"currentColor\"\n\tstroke-width=\"1.5\"\n\tstroke-linecap=\"round\"\n\tstroke-linejoin=\"round\"\n>\n\t<rect x=\"6\" y=\"4\" width=\"4\" height=\"16\" />\n\t<rect x=\"14\" y=\"4\" width=\"4\" height=\"16\" />\n</svg>\n","<svg\n\txmlns=\"http://www.w3.org/2000/svg\"\n\twidth=\"100%\"\n\theight=\"100%\"\n\tviewBox=\"0 0 24 24\"\n\tfill=\"none\"\n\tstroke=\"currentColor\"\n\tstroke-width=\"1.5\"\n\tstroke-linecap=\"round\"\n\tstroke-linejoin=\"round\"\n>\n\t<polygon points=\"5 3 19 12 5 21 5 3\" />\n</svg>\n","<svg\n\txmlns=\"http://www.w3.org/2000/svg\"\n\twidth=\"100%\"\n\theight=\"100%\"\n\tviewBox=\"0 0 24 24\"\n\tfill=\"none\"\n\tstroke=\"currentColor\"\n\tstroke-width=\"1.5\"\n\tstroke-linecap=\"round\"\n\tstroke-linejoin=\"round\"\n\tclass=\"feather feather-video\"\n>\n\t<polygon points=\"23 7 16 12 23 17 23 7\" />\n\t<rect x=\"1\" y=\"5\" width=\"15\" height=\"14\" rx=\"2\" ry=\"2\" />\n</svg>\n","<script lang=\"ts\">\n\timport { createEventDispatcher } from \"svelte\";\n\timport { Play, Pause, Maximise, Undo } from \"@gradio/icons\";\n\timport { loaded } from \"./utils\";\n\n\texport let src: string;\n\texport let subtitle: string | null = null;\n\texport let mirror: boolean;\n\texport let autoplay: boolean;\n\texport let label = \"test\";\n\n\tconst dispatch = createEventDispatcher<{\n\t\tplay: undefined;\n\t\tpause: undefined;\n\t\tstop: undefined;\n\t\tend: undefined;\n\t}>();\n\n\tlet time = 0;\n\tlet duration: number;\n\tlet paused = true;\n\tlet video: HTMLVideoElement;\n\n\tfunction handleMove(e: TouchEvent | MouseEvent): void {\n\t\tif (!duration) return;\n\n\t\tif (e.type === \"click\") {\n\t\t\thandle_click(e as MouseEvent);\n\t\t\treturn;\n\t\t}\n\n\t\tif (e.type !== \"touchmove\" && !((e as MouseEvent).buttons & 1)) return;\n\n\t\tconst clientX =\n\t\t\te.type === \"touchmove\"\n\t\t\t\t? (e as TouchEvent).touches[0].clientX\n\t\t\t\t: (e as MouseEvent).clientX;\n\t\tconst { left, right } = (\n\t\t\te.currentTarget as HTMLProgressElement\n\t\t).getBoundingClientRect();\n\t\ttime = (duration * (clientX - left)) / (right - left);\n\t}\n\n\tasync function play_pause(): Promise<void> {\n\t\tif (document.fullscreenElement != video) {\n\t\t\tconst isPlaying =\n\t\t\t\tvideo.currentTime > 0 &&\n\t\t\t\t!video.paused &&\n\t\t\t\t!video.ended &&\n\t\t\t\tvideo.readyState > video.HAVE_CURRENT_DATA;\n\n\t\t\tif (!isPlaying) {\n\t\t\t\tawait video.play();\n\t\t\t} else video.pause();\n\t\t}\n\t}\n\n\tfunction handle_click(e: MouseEvent): void {\n\t\tconst { left, right } = (\n\t\t\te.currentTarget as HTMLProgressElement\n\t\t).getBoundingClientRect();\n\t\ttime = (duration * (e.clientX - left)) / (right - left);\n\t}\n\n\tfunction format(seconds: number): string {\n\t\tif (isNaN(seconds) || !isFinite(seconds)) return \"...\";\n\n\t\tconst minutes = Math.floor(seconds / 60);\n\t\tlet _seconds: number | string = Math.floor(seconds % 60);\n\t\tif (_seconds < 10) _seconds = `0${_seconds}`;\n\n\t\treturn `${minutes}:${_seconds}`;\n\t}\n\n\tfunction handle_end(): void {\n\t\tdispatch(\"stop\");\n\t\tdispatch(\"end\");\n\t}\n\n\tfunction open_full_screen(): void {\n\t\tvideo.requestFullscreen();\n\t}\n</script>\n\n<div class=\"wrap\">\n\t<video\n\t\t{src}\n\t\tpreload=\"auto\"\n\t\ton:click={play_pause}\n\t\ton:play\n\t\ton:pause\n\t\ton:ended={handle_end}\n\t\tbind:currentTime={time}\n\t\tbind:duration\n\t\tbind:paused\n\t\tbind:this={video}\n\t\tclass:mirror\n\t\tuse:loaded={{ autoplay }}\n\t\tdata-testid={`${label}-player`}\n\t>\n\t\t<track kind=\"captions\" src={subtitle} default />\n\t</video>\n\n\t<div class=\"controls\">\n\t\t<div class=\"inner\">\n\t\t\t<span\n\t\t\t\trole=\"button\"\n\t\t\t\ttabindex=\"0\"\n\t\t\t\tclass=\"icon\"\n\t\t\t\taria-label=\"play-pause-replay-button\"\n\t\t\t\ton:click={play_pause}\n\t\t\t\ton:keydown={play_pause}\n\t\t\t>\n\t\t\t\t{#if time === duration}\n\t\t\t\t\t<Undo />\n\t\t\t\t{:else if paused}\n\t\t\t\t\t<Play />\n\t\t\t\t{:else}\n\t\t\t\t\t<Pause />\n\t\t\t\t{/if}\n\t\t\t</span>\n\n\t\t\t<span class=\"time\">{format(time)} / {format(duration)}</span>\n\n\t\t\t<!-- TODO: implement accessible video timeline for 4.0 -->\n\t\t\t<!-- svelte-ignore a11y-click-events-have-key-events -->\n\t\t\t<!-- svelte-ignore a11y-no-noninteractive-element-interactions -->\n\t\t\t<progress\n\t\t\t\tvalue={time / duration || 0}\n\t\t\t\ton:mousemove={handleMove}\n\t\t\t\ton:touchmove|preventDefault={handleMove}\n\t\t\t\ton:click|stopPropagation|preventDefault={handle_click}\n\t\t\t/>\n\n\t\t\t<div\n\t\t\t\trole=\"button\"\n\t\t\t\ttabindex=\"0\"\n\t\t\t\tclass=\"icon\"\n\t\t\t\taria-label=\"full-screen\"\n\t\t\t\ton:click={open_full_screen}\n\t\t\t\ton:keypress={open_full_screen}\n\t\t\t>\n\t\t\t\t<Maximise />\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n\n<style lang=\"postcss\">\n\tspan {\n\t\ttext-shadow: 0 0 8px rgba(0, 0, 0, 0.5);\n\t}\n\n\tprogress {\n\t\tmargin-right: var(--size-3);\n\t\tborder-radius: var(--radius-sm);\n\t\twidth: var(--size-full);\n\t\theight: var(--size-2);\n\t}\n\n\tprogress::-webkit-progress-bar {\n\t\tborder-radius: 2px;\n\t\tbackground-color: rgba(255, 255, 255, 0.2);\n\t\toverflow: hidden;\n\t}\n\n\tprogress::-webkit-progress-value {\n\t\tbackground-color: rgba(255, 255, 255, 0.9);\n\t}\n\n\tvideo {\n\t\tposition: inherit;\n\t\tbackground-color: black;\n\t\twidth: var(--size-full);\n\t\theight: var(--size-full);\n\t\tobject-fit: contain;\n\t}\n\n\t.mirror {\n\t\ttransform: scaleX(-1);\n\t}\n\n\t.controls {\n\t\tposition: absolute;\n\t\tbottom: 0;\n\t\topacity: 0;\n\t\ttransition: 500ms;\n\t\tmargin: var(--size-2);\n\t\tborder-radius: var(--radius-md);\n\t\tbackground: var(--color-grey-800);\n\t\tpadding: var(--size-2) var(--size-1);\n\t\twidth: calc(100% - 0.375rem * 2);\n\t\twidth: calc(100% - var(--size-2) * 2);\n\t}\n\t.wrap:hover .controls {\n\t\topacity: 1;\n\t}\n\n\t.inner {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tpadding-right: var(--size-2);\n\t\tpadding-left: var(--size-2);\n\t\twidth: var(--size-full);\n\t\theight: var(--size-full);\n\t}\n\n\t.icon {\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\tcursor: pointer;\n\t\twidth: var(--size-6);\n\t\tcolor: white;\n\t}\n\n\t.time {\n\t\tflex-shrink: 0;\n\t\tmargin-right: var(--size-3);\n\t\tmargin-left: var(--size-3);\n\t\tcolor: white;\n\t\tfont-size: var(--text-sm);\n\t\tfont-family: var(--font-mono);\n\t}\n\t.wrap {\n\t\tposition: relative;\n\t\tbackground-color: var(--background-fill-secondary);\n\t\theight: var(--size-full);\n\t\twidth: var(--size-full);\n\t}\n</style>\n"],"names":[],"mappings":"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"}