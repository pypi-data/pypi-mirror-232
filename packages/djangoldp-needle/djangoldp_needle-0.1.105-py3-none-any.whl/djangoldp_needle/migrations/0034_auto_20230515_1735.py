# Generated by Django 2.2.28 on 2023-05-15 17:35

from django.db import migrations
from django.conf import settings

def update_urlids(apps, schema_editor):
    if not schema_editor.connection.vendor.startswith('postgres'):
        return
    schema_editor.execute("UPDATE djangoldp_account_account a SET slug = u.slug FROM djangoldp_account_ldpuser u WHERE u.id = user_id");
    schema_editor.execute("UPDATE djangoldp_account_account SET urlid = '" + getattr(settings, 'BASE_URL') + "' || '/accounts/' || slug || '/'");

class Migration(migrations.Migration):

    dependencies = [
        ('djangoldp_needle', '0033_auto_20230509_1434'),
    ]

    operations = [
        migrations.RunPython(update_urlids),
    ]
