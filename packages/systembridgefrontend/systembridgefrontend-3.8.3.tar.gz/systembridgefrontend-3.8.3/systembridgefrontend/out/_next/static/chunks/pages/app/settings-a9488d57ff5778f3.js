(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[877],{4768:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/app/settings",function(){return i(1186)}])},1696:function(e,t,i){"use strict";i.d(t,{Z:function(){return Z}});var n=i(5893),s=i(7294),a=i(1163),o=i(9008),r=i.n(o),l=i(3946),c=i(8849),d=i(5317),u=i(8298),p=i(2734),h=i(2293),g=i(5582),x=i(155),y=i(6886),m=i(9417),j=i(5861),f=i(7357);function v(e){let{children:t}=e,i=(0,u.Z)({disableHysteresis:!0,threshold:24});return(0,s.cloneElement)(t,{elevation:i?4:0})}var k=function(){let[e,t]=(0,s.useState)(!1);(0,s.useCallback)(()=>{t(!e)},[e]);let i=(0,p.Z)();return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(v,{children:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(h.Z,{color:"transparent",elevation:0,children:(0,n.jsx)(g.Z,{maxWidth:"xl",sx:{padding:0},children:(0,n.jsx)(x.Z,{sx:{minHeight:50,maxHeight:50,padding:0,flex:1,alignItems:"center",justifyContent:"space-between",display:"flex",flexWrap:"nowrap"},children:(0,n.jsx)(y.ZP,{item:!0,children:(0,n.jsx)(m.Z,{href:"https://system-bridge.timmo.dev",target:"_blank",children:(0,n.jsx)(j.Z,{component:"div",variant:"h4",sx:{textTransform:"none",userSelect:"none",color:i.palette.primary.contrastText},children:"System Bridge"})})})})})}),(0,n.jsx)(f.Z,{sx:{height:i.spacing(18)}})]})})})};let b=!1;var Z=function(e){let t=(0,a.useRouter)();return(0,s.useEffect)(()=>{if(t.isReady&&!b){var e,i,n,s;b=!0;let a=(null===(e=t.query)||void 0===e?void 0:e.apiKey)||"",o=(null===(i=t.query)||void 0===i?void 0:i.apiPort)||"9170",r=!1;if((null===(n=t.query)||void 0===n?void 0:n.apiKey)||(r=!0,a=window.prompt("Please enter your API key",a)),(null===(s=t.query)||void 0===s?void 0:s.apiPort)||(r=!0,o=window.prompt("Please enter your API port (default: 9170)",o)),r&&a&&o){let e=t.asPath.split("?")[0];t.replace({pathname:e.includes(".html")?e:"".concat(e,".html"),query:{...t.query,apiKey:a,apiPort:o}})}}},[t]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(r(),{children:[(0,n.jsx)("title",{children:e.title?"".concat(e.title," - System Bridge"):"System Bridge"}),(0,n.jsx)("link",{rel:"canonical",href:e.url}),(0,n.jsx)("meta",{name:"description",content:e.description?"".concat(e.description):e.title?"".concat(e.title," - System Bridge"):"System Bridge"}),(0,n.jsx)("meta",{name:"keywords",content:e.keywords?"".concat(e.keywords):"system-bridge, system, bridge, typescript"})]}),!e.noHeader&&(0,n.jsx)(k,{}),e.closeButton&&(0,n.jsx)(l.Z,{size:"small",sx:{position:"absolute",top:4,right:4,zIndex:1e3},onClick:()=>{window.location.href="http://close.window"},children:(0,n.jsx)(c.Icon,{id:"close",path:d.r5M,size:1})}),e.children]})}},6551:function(e,t,i){"use strict";i.d(t,{D:function(){return a},X:function(){return s}});var n=i(7294);function s(e){navigator.permissions.query({name:"clipboard-write"}).then(t=>{("granted"===t.state||"prompt"===t.state)&&navigator.clipboard.writeText(e)})}function a(e){let t=(0,n.useRef)();return(0,n.useEffect)(()=>{t.current=e}),t.current}},5705:function(e,t,i){"use strict";i.d(t,{C:function(){return n}});class n{close(){this.websocket&&this.websocket.readyState===this.websocket.OPEN&&this.websocket.close()}async connect(){let e=new WebSocket("ws://".concat(window.location.hostname||"localhost",":").concat(this.port,"/api/websocket"));return await new Promise(t=>{e.onopen=()=>t()}),e.onmessage=e=>{if("string"==typeof e.data){let t=JSON.parse(e.data);t&&this.onEvent&&this.onEvent(t)}},e}isConnected(){var e;return(null===(e=this.websocket)||void 0===e?void 0:e.readyState)===WebSocket.OPEN}getData(e){this.websocket&&this.websocket.readyState===this.websocket.OPEN&&(console.log("Get data:",e),this.websocket.send(JSON.stringify({api_key:this.apiKey,event:"GET_DATA",modules:e})))}getSettings(){this.websocket&&this.websocket.readyState===this.websocket.OPEN&&(console.log("Get settings"),this.websocket.send(JSON.stringify({api_key:this.apiKey,event:"GET_SETTINGS"})))}registerDataListener(e){this.websocket&&this.websocket.readyState===this.websocket.OPEN&&(console.log("Register data listener:",e),this.websocket.send(JSON.stringify({api_key:this.apiKey,event:"REGISTER_DATA_LISTENER",modules:e})))}sendPlayerStatus(e){this.websocket&&this.websocket.readyState===this.websocket.OPEN&&this.websocket.send(JSON.stringify({api_key:this.apiKey,event:"MEDIA_STATUS",status:e}))}updateSetting(e,t){this.websocket&&this.websocket.readyState===this.websocket.OPEN&&(console.log("Update setting:",{key:e,value:t}),this.websocket.send(JSON.stringify({api_key:this.apiKey,event:"UPDATE_SETTING",setting:e,value:t})))}constructor(e,t,i){this.port=e||9170,this.apiKey=t,(async()=>{this.websocket=await this.connect(),i&&this.websocket&&this.websocket.readyState===this.websocket.OPEN&&i()})()}}},1186:function(e,t,i){"use strict";let n;i.r(t),i.d(t,{default:function(){return M}});var s=i(5893),a=i(7294),o=i(5582),r=i(1696),l=i(2734),c=i(6886),d=i(8456),u=i(1163),p=i(5317),h=i(9598),g=i(5705),x=i(7632),y=i(8619),m=i(9294),j=i(796),f=i(9953),v=i(3395),k=i(9653),b=i(4054),Z=i(7709),w=i(7109),S=i(3946),P=i(6443),C=i(699),E=i(8849),_=i(6551),I=i(8396),N=i(657),A=i(7645),O=i(8951),T=i(6514),R=i(8462),z=i(1425),D=i(9417),W=i(6486),G=i.n(W);let K={additional_media_directories:{name:"Name",value:"Path"},keyboard_hotkeys:{name:"Hotkey",value:"Action"}};var L=function(e){let{id:t,setting:i,listIn:n,open:o,setOpen:r,handleChanged:d}=e,[u,h]=(0,a.useState)([]),{name:g,description:x,icon:v}=i;(0,a.useEffect)(()=>{!o&&n&&h(n)},[n,o]);let k=(0,l.Z)(),b=(0,I.Z)(k.breakpoints.down("md"));return(0,s.jsxs)(N.Z,{fullScreen:b,fullWidth:!0,maxWidth:"lg",open:o,scroll:"paper",PaperProps:{style:{background:k.palette.background.paper}},children:[(0,s.jsxs)(A.Z,{children:[(0,s.jsx)(E.Icon,{id:"copy-to-clipboard",title:"Copy to clipboard",size:.7,path:v,style:{marginRight:k.spacing(1)}}),g]}),(0,s.jsx)(O.Z,{sx:{margin:k.spacing(0,3)},children:x}),(0,s.jsx)(T.Z,{children:(0,s.jsxs)(R.Z,{children:[u.map((e,i)=>{var n,a;return(0,s.jsx)(m.ZP,{children:(0,s.jsxs)(c.ZP,{container:!0,alignItems:"center",children:[(0,s.jsx)(c.ZP,{item:!0,xs:4,sx:{marginRight:k.spacing(1)},children:(0,s.jsx)(C.Z,{id:"name",label:(null===(n=K[t])||void 0===n?void 0:n.name)||"Name",fullWidth:!0,variant:"outlined",value:e.name,onChange:e=>{let t=G().cloneDeep(u);console.log("Update name:",i,t,t[i]),t&&t[i]&&(t[i].name=e.target.value,h(t))}})}),(0,s.jsx)(c.ZP,{item:!0,xs:!0,sx:{marginLeft:k.spacing(1)},children:(0,s.jsx)(C.Z,{id:"value",label:(null===(a=K[t])||void 0===a?void 0:a.value)||"Value",fullWidth:!0,variant:"outlined",value:e.value,onChange:e=>{let t=G().cloneDeep(u);console.log("Update value:",i,t,t[i]),t&&t[i]&&(t[i].value=e.target.value,h(t))}})}),(0,s.jsx)(c.ZP,{item:!0,children:(0,s.jsx)(S.Z,{"aria-label":"Remove",size:"large",onClick:()=>{let e=G().cloneDeep(u);e.splice(i,1),h(e)},children:(0,s.jsx)(E.Icon,{id:"remove-item",title:"Remove",size:.8,path:p.S6N})})})]})},i)}),(0,s.jsxs)(y.Z,{onClick:()=>{let e=G().cloneDeep(u);e.push({name:"",value:""}),h(e)},children:[(0,s.jsx)(j.Z,{children:(0,s.jsx)(E.Icon,{id:"add",title:"Add",size:1,path:p.qX5})}),(0,s.jsx)(f.Z,{primary:"Add",secondary:"Add a new item"})]})]})}),(0,s.jsxs)(z.Z,{children:[(0,s.jsx)(D.Z,{onClick:()=>{r(!1)},color:"primary",variant:"outlined",children:"Cancel"}),(0,s.jsx)(D.Z,{onClick:()=>{r(!1),d(u)},color:"primary",variant:"outlined",children:"Save"})]})]})},q=function(e){let{keyIn:t,valueIn:i,handleChanged:n}=e,[o,r]=(0,a.useState)(!1),[d,u]=(0,a.useState)(!1),[h,g]=(0,a.useState)(i);function I(e){g(e.target.value)}let N=(0,a.useMemo)(()=>i!==h,[i,h]),{name:A,description:O,icon:T,containerDisabled:R,isList:z,isPassword:D,minimum:W}=U[t],G=(0,l.Z)();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e=>{let{children:t}=e;return z?(0,s.jsx)(y.Z,{onClick:()=>r(!0),children:t}):(0,s.jsx)(m.ZP,{children:t})},{children:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(j.Z,{children:(0,s.jsx)(E.Icon,{id:"icon",title:A,size:1,path:T})}),(0,s.jsx)(f.Z,{primary:A,secondary:O,sx:{maxWidth:"64%",userSelect:"none"}}),z?"":(0,s.jsx)(v.Z,{sx:{width:420,textAlign:"end"},children:(0,s.jsxs)(c.ZP,{container:!0,alignItems:"center",justifyContent:"flex-end",children:[(0,s.jsx)(c.ZP,{item:!0,children:"boolean"==typeof h?(0,s.jsx)(k.Z,{edge:"end",disabled:R,checked:h,onChange:function(e,t){g(t)}}):"string"==typeof i&&"api_key"===t?(0,s.jsx)(b.Z,{fullWidth:!0,variant:"outlined",children:(0,s.jsx)(Z.Z,{type:"text",disabled:!0,value:h,endAdornment:(0,s.jsxs)(w.Z,{position:"end",children:[(0,s.jsx)(S.Z,{"aria-label":"Generate Api Key",onClick:function(){g((0,x.Z)())},edge:"end",size:"large",sx:{margin:G.spacing(-1,-.5)},children:(0,s.jsx)(E.Icon,{id:"generate-api-key",title:"Generate API Key",size:1,path:p.VmU})}),(0,s.jsx)(S.Z,{"aria-label":"Copy to clipboard",onClick:()=>(0,_.X)(String(h)),size:"large",sx:{margin:G.spacing(-1,-.5)},children:(0,s.jsx)(E.Icon,{id:"copy-to-clipboard",title:"Copy to clipboard",size:.8,path:p.a0Z})})]})})}):"string"==typeof i&&"string"==typeof h&&"log_level"===t?(0,s.jsx)(P.Z,{id:t,options:["DEBUG","INFO","WARNING","ERROR","CRITICAL"],renderInput:e=>(0,s.jsx)(C.Z,{...e,variant:"outlined"}),onChange:function(e,t){t&&g(t)},sx:{width:210},value:h}):"string"==typeof i&&D?(0,s.jsx)(b.Z,{variant:"outlined",children:(0,s.jsx)(Z.Z,{type:d?"text":"password",defaultValue:h,onChange:I,endAdornment:(0,s.jsx)(w.Z,{position:"end",children:(0,s.jsx)(S.Z,{"aria-label":"Toggle visibility",onClick:function(){u(!d)},onMouseDown:function(e){e.preventDefault()},size:"large",children:(0,s.jsx)(E.Icon,{id:"copy-to-clipboard",title:"Copy to clipboard",size:.8,path:d?p.rgx:p.DqW})})})})}):"string"==typeof i?(0,s.jsx)(C.Z,{type:"text",defaultValue:h,disabled:R,onChange:I,variant:"outlined"}):"number"==typeof i?(0,s.jsx)(C.Z,{error:!!W&&Number(h)<W,type:"number",disabled:R,inputProps:{minimum:W},defaultValue:h,onChange:I,variant:"outlined"}):""}),(0,s.jsx)(c.ZP,{item:!0,children:(0,s.jsx)(S.Z,{disabled:!1===N,onClick:()=>{n(t,h)},sx:{margin:G.spacing(1)},children:(0,s.jsx)(E.Icon,{id:"save",title:"Save",size:1,path:p.JTj,style:{opacity:N?1:.25}})})})]})})]})}),z&&Array.isArray(h)?(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(L,{id:t,setting:U[t],listIn:h,open:o,setOpen:r,handleChanged:e=>{g(e),n(t,JSON.stringify(e))}})}):""]})},F=i(5861),B=i(629),J=function(e){let{name:t,description:i,children:n}=e;return(0,s.jsxs)(c.ZP,{container:!0,direction:"row",item:!0,xs:12,children:[(0,s.jsxs)(c.ZP,{item:!0,xs:4,style:{userSelect:"none"},children:[(0,s.jsx)(F.Z,{component:"h3",variant:"h5",children:t}),(0,s.jsx)(F.Z,{variant:"subtitle1",children:i})]}),(0,s.jsx)(c.ZP,{item:!0,xs:8,children:(0,s.jsx)(B.Z,{children:(0,s.jsx)(R.Z,{children:n})})})]})};let U={autostart:{name:"Autostart",description:"Automatically start the application on startup",icon:p.USr},log_level:{name:"Log Level",description:"Log level for the application",icon:p.eLz},port_api:{name:"API Port",description:"Port for the API and WebSocket",icon:p.A0p},additional_media_directories:{name:"Additional Media Directories",description:"Additional media directories for the media endpoint",icon:p.Rmq,isList:!0},keyboard_hotkeys:{name:"Keyboard Hotkeys",description:"Setup hotkeys for triggering actions",icon:p.Wpj,isList:!0}};var H=function(){let[e,t]=(0,h.r)(),[i,o]=(0,a.useState)(!1),r=(0,u.useRouter)().query,p=(0,a.useCallback)(e=>{if(console.log("Event:",e),"SETTINGS_RESULT"===e.type){console.log("Settings result data:",e.data);let i={};console.log("settingsMap:",U);let n=Object.keys(U);e.data.sort((e,t)=>n.indexOf(e.key)>n.indexOf(t.key)?1:-1).forEach(e=>{var t;(null===(t=U[e.key])||void 0===t?void 0:t.isList)&&"string"==typeof e.value?i[e.key]=JSON.parse(e.value):i[e.key]=e.value}),console.log("Settings:",i),t(i)}},[t]),x=(0,a.useCallback)((e,t)=>{console.log("Setup WebSocketConnection"),(n=new g.C(e,t,async()=>{n.getSettings()})).onEvent=p},[p]),y=(0,a.useCallback)((i,s)=>{n.updateSetting(i,s),t({...e,[i]:s})},[e,t]);(0,a.useEffect)(()=>{!i&&r&&r.apiKey&&(o(!0),x(Number(r.apiPort)||9170,String(r.apiKey)))},[i,x,r]);let m=(0,l.Z)();return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(c.ZP,{container:!0,direction:"column",spacing:2,alignItems:"stretch",sx:{marginBottom:m.spacing(8),padding:m.spacing(2)},children:e?(0,s.jsx)(J,{name:"General",description:"General settings",children:(0,s.jsx)(s.Fragment,{children:Object.keys(e).map((t,i)=>(0,s.jsx)(q,{keyIn:t,valueIn:e[t],handleChanged:y},i))})}):(0,s.jsx)(c.ZP,{container:!0,direction:"row",justifyContent:"center",sx:{margin:m.spacing(2,0,10)},children:(0,s.jsx)(d.Z,{})})})})},M=function(){return(0,s.jsx)(r.Z,{title:"Settings",url:"https://system-bridge.timmo.dev",description:"Frontend for System Bridge",children:(0,s.jsx)(o.Z,{component:"article",maxWidth:"xl",children:(0,s.jsx)(H,{})})})}}},function(e){e.O(0,[702,662,920,67,8,699,443,767,826,774,888,179],function(){return e(e.s=4768)}),_N_E=e.O()}]);