[project]
authors = [
    { name = "SoulMelody", email = "yjxrtzyx@gmail.com" },
]
requires-python = ">=3.9,<3.12"
dependencies = [
    "charset-normalizer<4.0.0,>=3.2.0",
    "construct-typing<1.0.0,>=0.6.2",
    "drawsvg<3.0.0,>=2.3.0",
    "jinja2<4.0.0,>=3.1.2",
    "loguru<1.0.0,>=0.7.2",
    "mido-fix<2.0.0,>=1.2.12",
    "more-itertools<11.0.0,>=10.1.0",
    "omegaconf<3.0.0,>=2.3.0",
    "packaging<24.0,>=23.1",
    "platformdirs<4.0.0,>=3.10.0",
    "portion<3.0.0,>=2.4.1",
    "pure-protobuf<4.0,>=3.0a5",
    "pydantic<3.0.0,>=2.3.0",
    "pydantic-extra-types<3.0.0,>=2.1.0",
    "pymediainfo<7.0.0,>=6.0.1; sys_platform != \"linux\"",
    "pymediainfo-lambda<1.0.0,>=0.0.13; sys_platform == \"linux\"",
    "pypinyin<1.0.0,>=0.49.0",
    "regex<2024.0.0,>=2023.8.8",
    "srt<4.0.0,>=3.5.3",
    "textx<4.0.0,>=3.1.1",
    "typer[all]<1.0.0,>=0.9.0",
    "universal-pathlib<1.0.0,>=0.1.3",
    "wanakana-python<2.0.0,>=1.2.2",
    "xsdata<24.0,>=23.8",
    "zstandard>=0.21.0",
]
name = "libresvip"
version = "0.9.1"
description = "Universal Converter for Singing Voice Projects"
readme = "README.md"

[project.license]
text = "MIT"

[project.urls]
repository = "https://github.com/SoulMelody/LibreSVIP"

[project.optional-dependencies]
ujson = [
    "ujson>=5.8.0",
]
webui = [
    "nicegui[native]>=1.3.14",
]
desktop = [
    "pyside6>6.5.0",
    "qmlease>=3.0.3",
    "lk-utils<3.0.0,>=2.5.5,!=2.6.0",
    "qtpy<3.0.0,>=2.4.0",
    "qtawesome>=1.2.3",
    "qtinter>=0.11.0",
    "httpx>=0.24.1",
    "desktop-notifier>=3.5.6; platform_python_implementation == \"CPython\"",
    "pywin32>=306; sys_platform == \"win32\"",
]

[tool.pdm.dev-dependencies]
code_gen = [
    "datamodel-code-generator>=0.22.0",
    "xsdata[cli]>=23.8",
]
i18n = [
    "translate-toolkit>=3.10.1",
    "babel>=2.12.1",
]
linting = [
    "isort>=5.12.0",
    "pre-commit>=3.4.0",
    "ruff>=0.0.291",
    "black>=23.9.1",
    "mypy>=1.5.1",
    "sourcery>=1.10.0",
]
packaging = [
    "cx-freeze>=6.15.8",
]
docs = [
    "mkdocs-material<10.0.0,>=9.4.1",
]
test = [
    "pytest>=7.4.2",
    "pytest-datadir>=1.4.1",
]
typing_stubs = [
    "types-pyyaml>=6.0.12.12",
    "types-regex>=2023.8.8.0",
    "types-ujson>=5.8.0.1",
]

[tool.pdm.resolution.overrides]
regex = "<2024.0.0,>=2023.8.8"

[tool.pdm.build]
includes = []
excludes = [
    "tests",
    "libresvip/plugins/*/*.po",
]

[tool.pdm.scripts.libresvip-cli]
call = "libresvip.cli.__main__:app"

[tool.pdm.scripts.libresvip-gui]
call = "libresvip.gui.__main__:run"

[tool.pdm.scripts.libresvip-web]
call = "libresvip.web.__main__:main"

[tool.pytest.ini_options]
addopts = "-s -p no:warnings"
testpaths = "tests"

[tool.isort]
line_length = 100
profile = "black"

[tool.ruff]
target-version = "py39"
src = [
    "libresvip",
    "tests",
]
select = [
    "A",
    "ASYNC",
    "C4",
    "E",
    "EM",
    "EXE",
    "F",
    "G",
    "I",
    "INT",
    "N",
    "PIE",
    "PGH",
    "PLC",
    "PLE",
    "PT",
    "PTH",
    "T10",
    "T20",
    "TCH",
    "TRY",
    "W",
    "YTT",
]
ignore = [
    "C408",
    "E402",
    "E501",
    "E731",
    "N802",
    "N806",
]
line-length = 100
fix = true

[tool.ruff.isort]
known-first-party = [
    "libresvip",
    "tests",
]
known-third-party = [
    "srt",
]

[tool.mypy]
plugins = [
    "pydantic.mypy",
]
always_true = "PYSIDE6"
follow_imports = "silent"
disable_error_code = "method-assign,operator,override"
warn_redundant_casts = true
warn_unused_ignores = true
disallow_any_generics = true
check_untyped_defs = true
no_implicit_reexport = true
disallow_untyped_defs = true
warn_no_return = false

[tool.pydantic-mypy]
init_forbid_extra = true
init_typed = true
warn_required_dynamic_aliases = true

[build-system]
requires = [
    "pdm-backend",
    "setuptools",
    "wheel",
]
build-backend = "pdm.backend"
