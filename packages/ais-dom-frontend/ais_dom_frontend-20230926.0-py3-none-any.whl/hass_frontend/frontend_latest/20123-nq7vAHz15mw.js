export const id=20123;export const ids=[20123,92587];export const modules={72043:(e,t,i)=>{i.d(t,{A:()=>n});var o=i(23158),s=i(25101),a=i(66477);const n=(e,t,i,n,r)=>i.time_zone===a.c_.server?((e,t,i,a)=>{const n=i((0,o.Z)(e,t),a);return(0,s.Z)(n,t)})(e,n.time_zone,t,r):t(e,r)},92306:(e,t,i)=>{i.d(t,{v:()=>o});const o=(e,t)=>{const i={};for(const o of e){const e=t(o);e in i?i[e].push(o):i[e]=[o]}return i}},50424:(e,t,i)=>{i.d(t,{n:()=>o});const o=(e,t)=>{const i=new Promise(((t,i)=>{setTimeout((()=>{i(`Timed out in ${e} ms.`)}),e)}));return Promise.race([t,i])}},8330:(e,t,i)=>{i.d(t,{P:()=>o});const o=(e,t,i=!0,o=!0)=>{let s,a=0;const n=(...n)=>{const r=()=>{a=!1===i?0:Date.now(),s=void 0,e(...n)},c=Date.now();a||!1!==i||(a=c);const d=t-(c-a);d<=0||d>t?(s&&(clearTimeout(s),s=void 0),a=c,e(...n)):s||!1===o||(s=window.setTimeout(r,d))};return n.cancel=()=>{clearTimeout(s),s=void 0,a=0},n}},22098:(e,t,i)=>{var o=i(17463),s=i(68144),a=i(79932);(0,o.Z)([(0,a.Mo)("ha-card")],(function(e,t){return{F:class extends t{constructor(...t){super(...t),e(this)}},d:[{kind:"field",decorators:[(0,a.Cb)()],key:"header",value:void 0},{kind:"field",decorators:[(0,a.Cb)({type:Boolean,reflect:!0})],key:"raised",value:()=>!1},{kind:"get",static:!0,key:"styles",value:function(){return s.iv`:host{background:var(--ha-card-background,var(--card-background-color,#fff));box-shadow:var(--ha-card-box-shadow,none);box-sizing:border-box;border-radius:var(--ha-card-border-radius,12px);border-width:var(--ha-card-border-width,1px);border-style:solid;border-color:var(--ha-card-border-color,var(--divider-color,#e0e0e0));color:var(--primary-text-color);display:block;transition:all .3s ease-out;position:relative}:host([raised]){border:none;box-shadow:var(--ha-card-box-shadow,0px 2px 1px -1px rgba(0,0,0,.2),0px 1px 1px 0px rgba(0,0,0,.14),0px 1px 3px 0px rgba(0,0,0,.12))}.card-header,:host ::slotted(.card-header){color:var(--ha-card-header-color,--primary-text-color);font-family:var(--ha-card-header-font-family,inherit);font-size:var(--ha-card-header-font-size,24px);letter-spacing:-.012em;line-height:48px;padding:12px 16px 16px;display:block;margin-block-start:0px;margin-block-end:0px;font-weight:400}:host ::slotted(.card-content:not(:first-child)),slot:not(:first-child)::slotted(.card-content){padding-top:0px;margin-top:-8px}:host ::slotted(.card-content){padding:16px}:host ::slotted(.card-actions){border-top:1px solid var(--divider-color,#e8e8e8);padding:5px 16px}`}},{kind:"method",key:"render",value:function(){return s.dy` ${this.header?s.dy`<h1 class="card-header">${this.header}</h1>`:s.Ld} <slot></slot> `}}]}}),s.oi)},10983:(e,t,i)=>{i.d(t,{$:()=>r});var o=i(17463),s=(i(20210),i(68144)),a=i(79932),n=i(30153);i(52039);let r=(0,o.Z)([(0,a.Mo)("ha-icon-button")],(function(e,t){return{F:class extends t{constructor(...t){super(...t),e(this)}},d:[{kind:"field",decorators:[(0,a.Cb)({type:Boolean,reflect:!0})],key:"disabled",value:()=>!1},{kind:"field",decorators:[(0,a.Cb)({type:String})],key:"path",value:void 0},{kind:"field",decorators:[(0,a.Cb)({type:String})],key:"label",value:void 0},{kind:"field",decorators:[(0,a.Cb)({type:String,attribute:"aria-haspopup"})],key:"ariaHasPopup",value:void 0},{kind:"field",decorators:[(0,a.Cb)({type:Boolean})],key:"hideTitle",value:()=>!1},{kind:"field",decorators:[(0,a.IO)("mwc-icon-button",!0)],key:"_button",value:void 0},{kind:"method",key:"focus",value:function(){var e;null===(e=this._button)||void 0===e||e.focus()}},{kind:"field",static:!0,key:"shadowRootOptions",value:()=>({mode:"open",delegatesFocus:!0})},{kind:"method",key:"render",value:function(){return s.dy` <mwc-icon-button aria-label="${(0,n.o)(this.label)}" title="${(0,n.o)(this.hideTitle?void 0:this.label)}" aria-haspopup="${(0,n.o)(this.ariaHasPopup)}" .disabled="${this.disabled}"> ${this.path?s.dy`<ha-svg-icon .path="${this.path}"></ha-svg-icon>`:s.dy`<slot></slot>`} </mwc-icon-button> `}},{kind:"get",static:!0,key:"styles",value:function(){return s.iv`:host{display:inline-block;outline:0}:host([disabled]){pointer-events:none}mwc-icon-button{--mdc-theme-on-primary:currentColor;--mdc-theme-text-disabled-on-light:var(--disabled-text-color)}`}}]}}),s.oi)},81312:(e,t,i)=>{var o=i(17463),s=i(34541),a=i(47838),n=i(68144),r=i(79932),c=i(47181),d=i(38346),l=i(49594),h=i(82160),f=i(50424);const u=JSON.parse('{"version":"7.2.96","parts":[{"file":"d87dfde6b001dc98006e5435433aa52098bcd9b3"},{"start":"account-t","file":"711267e0e34d87a39adbfd9994efcb08ae9f414f"},{"start":"alpha-w","file":"54cbd04c11f21883589007adda0f7e0adf5bca8f"},{"start":"arrow-e","file":"df11ea369e3501567ce20b7098e01b793c023db7"},{"start":"bacteria-","file":"d1011650961da9c291c4d6bdcb553d90d6038760"},{"start":"battery-sync-","file":"892a846dbff0a6d1dbb5b08fc6afac527f3e49ba"},{"start":"book-ar","file":"c05c137221445dd9b05a089ff18a23582e306846"},{"start":"briefcase-o","file":"331f33b2ccdd7301a3dc674620489dfac4f90d4d"},{"start":"call-r","file":"cb567027ea724063ce0164f40bd7568251209025"},{"start":"car-sel","file":"c11556ab885055075b57cc97d8b99885c7f622da"},{"start":"chair-s","file":"18e315eff3251a9507c62ff18da211142d407d4f"},{"start":"clipboard-edit-","file":"a43a9dbccb1f476132685436550acc1276a56094"},{"start":"cloud-p","file":"1aa915e013afb2d901709c07f2086ca7b2b3020a"},{"start":"comment-arrow-right-","file":"fe1bb57c6bc111cc99d7172a0c369beb5f609e85"},{"start":"cookie-remove-","file":"443c52a071b533a9b33054ad0ff0682d5a1db9a1"},{"start":"cylinder-","file":"982f12e1107769eafdfe591f8b7cb4b461cf20b0"},{"start":"dice-6","file":"e4169900a6cacce69b5378ca824acde800dec684"},{"start":"earth-r","file":"22af9c284626fdc1914da005a32512595787667a"},{"start":"ev-plug-ch","file":"a64697c64914caca6a2560a1588a877f62dd9ef7"},{"start":"fi","file":"badc1da5056af376dc4c1c93be343687146520cb"},{"start":"filter-multiple-","file":"8e512b1384d62c810308c1599e61e8914f089689"},{"start":"folder-cancel-","file":"5264596776f134735107fcccdc6a5146b170cf50"},{"start":"format-list-g","file":"f6b50f3b3519ca6df05f98f821a39847f014a133"},{"start":"gesture-swipe-","file":"865fe94947631b7d206f978e84d9c69dc93e3d62"},{"start":"hamburger-m","file":"3f236139e446612908b6de7f707fc7a33a1d6869"},{"start":"heart-o","file":"3e1fabefef34c80e7f761e3237e930b98275ba30"},{"start":"human-male-f","file":"bf11dd0acd8de12349b3df2d682ee6ee815e0286"},{"start":"ju","file":"9f00e9eb8ede75e82ec41ddd027f352c331fe6d6"},{"start":"language-s","file":"8f2268719d6457d86fd424907d87a722420123af"},{"start":"loc","file":"b7258452cb18eee262e46925eff5fdccf470d85c"},{"start":"mes","file":"253efe87d5688adfb29da33b6946419f272cf478"},{"start":"monitor-ey","file":"8d0b1e5ab037eb6b4dcb012e5656aa2e1ef51e0f"},{"start":"needle-","file":"1c8f1c7533dea102b01fbbf48bac5d2d4de16302"},{"start":"office-building-mi","file":"d395c3117f89ff47cd90e7682c2385a7ff9b170a"},{"start":"pe","file":"3b7823b3f610d41dd7603e4f27919415ae98fd49"},{"start":"pine","file":"b4a7c4c9c25f35ada808babc93f21d2743e28365"},{"start":"printer-w","file":"fe3e876fa31e2129f5343696d449c2580b60ff77"},{"start":"receipt-t","file":"1abb583ca6db916b62b29647bcc232f9395a75b7"},{"start":"rocket-o","file":"6413ebc0507e6f0329449b7ed61f66f1dc3c3216"},{"start":"select-m","file":"91fb7f662fa2ac81ca6f9fc5f27058b49ccb77c6"},{"start":"shovel-","file":"8ac5c60009481b18684394a69b88bfb4c1843fbe"},{"start":"so","file":"c0cc319aa3b361807e183459ad41512a9f0fa69a"},{"start":"star-box-","file":"936ce1dfa22375eaf554d7e0b62601db2705aa01"},{"start":"sun-co","file":"8accbf66829d255aa1973a9b48905114dab8bcfb"},{"start":"tap","file":"b53829b66b52f2d3024399b07092d66945474973"},{"start":"timer-e","file":"2736e07a78f432d83f76ed0939841296bf314a5a"},{"start":"tras","file":"157e5129d89c420f949f58ff62c7932953ac0565"},{"start":"vh","file":"d26e7d970b03ccd5a167167b13bfe55c78afac7e"},{"start":"waves-arrow-u","file":"602e33cc68638fea964e71a15aa03187a7c4c731"},{"start":"wifi-arrow-left-","file":"de64808a78929c2e21f2f77cda85adbaa3b5d33e"}]}'),p=(0,h.MT)("hass-icon-db","mdi-icon-store"),b=["mdi","hass","hassio","hademo"];let y=[];i(52039);const _={},v={};(async()=>{const e=await(0,h.U2)("_version",p);e?e!==u.version&&(await(0,h.ZH)(p),(0,h.t8)("_version",u.version,p)):(0,h.t8)("_version",u.version,p)})();const g=(0,d.D)((()=>(async e=>{const t=Object.keys(e),i=await Promise.all(Object.values(e));p("readwrite",(o=>{i.forEach(((i,s)=>{Object.entries(i).forEach((([e,t])=>{o.put(t,e)})),delete e[t[s]]}))}))})(v)),2e3),m={};(0,o.Z)([(0,r.Mo)("ha-icon")],(function(e,t){class o extends t{constructor(...t){super(...t),e(this)}}return{F:o,d:[{kind:"field",decorators:[(0,r.Cb)()],key:"icon",value:void 0},{kind:"field",decorators:[(0,r.SB)()],key:"_path",value:void 0},{kind:"field",decorators:[(0,r.SB)()],key:"_viewBox",value:void 0},{kind:"field",decorators:[(0,r.SB)()],key:"_legacy",value:()=>!1},{kind:"method",key:"willUpdate",value:function(e){(0,s.Z)((0,a.Z)(o.prototype),"willUpdate",this).call(this,e),e.has("icon")&&(this._path=void 0,this._viewBox=void 0,this._loadIcon())}},{kind:"method",key:"render",value:function(){return this.icon?this._legacy?n.dy` <iron-icon .icon="${this.icon}"></iron-icon>`:n.dy`<ha-svg-icon .path="${this._path}" .viewBox="${this._viewBox}"></ha-svg-icon>`:n.Ld}},{kind:"method",key:"_loadIcon",value:async function(){if(!this.icon)return;const e=this.icon,[t,o]=this.icon.split(":",2);let s,a=o;if(!t||!a)return;if(!b.includes(t)){const i=l.g[t];return i?void(i&&"function"==typeof i.getIcon&&this._setCustomPath(i.getIcon(a),e)):void(this._legacy=!0)}if(this._legacy=!1,a in _){const e=_[a];let i;e.newName?(i=`Icon ${t}:${a} was renamed to ${t}:${e.newName}, please change your config, it will be removed in version ${e.removeIn}.`,a=e.newName):i=`Icon ${t}:${a} was removed from MDI, please replace this icon with an other icon in your config, it will be removed in version ${e.removeIn}.`,console.warn(i),(0,c.B)(this,"write_log",{level:"warning",message:i})}if(a in m)return void(this._path=m[a]);if("home-assistant"===a){const t=(await i.e(30008).then(i.bind(i,30008))).mdiHomeAssistant;return this.icon===e&&(this._path=t),void(m[a]=t)}try{s=await(e=>new Promise(((t,i)=>{y.push([e,t,i]),y.length>1||(0,f.n)(1e3,p("readonly",(e=>{for(const[t,i,o]of y)(0,h.RV)(e.get(t)).then((e=>i(e))).catch((e=>o(e)));y=[]}))).catch((e=>{for(const[,,t]of y)t(e);y=[]}))})))(a)}catch(e){s=void 0}if(s)return this.icon===e&&(this._path=s),void(m[a]=s);const n=(e=>{let t;for(const i of u.parts){if(void 0!==i.start&&e<i.start)break;t=i}return t.file})(a);if(n in v)return void this._setPath(v[n],a,e);const r=fetch(`/static/mdi/${n}.json`).then((e=>e.json()));v[n]=r,this._setPath(r,a,e),g()}},{kind:"method",key:"_setCustomPath",value:async function(e,t){const i=await e;this.icon===t&&(this._path=i.path,this._viewBox=i.viewBox)}},{kind:"method",key:"_setPath",value:async function(e,t,i){const o=await e;this.icon===i&&(this._path=o[t]),m[t]=o[t]}},{kind:"get",static:!0,key:"styles",value:function(){return n.iv`:host{fill:currentcolor}`}}]}}),n.oi)},48932:(e,t,i)=>{var o=i(17463),s=i(34541),a=i(47838),n=i(68144),r=i(79932),c=i(47181),d=i(6936);i(10983);(0,o.Z)([(0,r.Mo)("ha-menu-button")],(function(e,t){class i extends t{constructor(...t){super(...t),e(this)}}return{F:i,d:[{kind:"field",decorators:[(0,r.Cb)({type:Boolean})],key:"hassio",value:()=>!1},{kind:"field",decorators:[(0,r.Cb)()],key:"narrow",value:void 0},{kind:"field",decorators:[(0,r.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,r.SB)()],key:"_hasNotifications",value:()=>!1},{kind:"field",decorators:[(0,r.SB)()],key:"_show",value:()=>!1},{kind:"field",key:"_alwaysVisible",value:()=>!1},{kind:"field",key:"_attachNotifOnConnect",value:()=>!1},{kind:"field",key:"_unsubNotifications",value:void 0},{kind:"method",key:"connectedCallback",value:function(){(0,s.Z)((0,a.Z)(i.prototype),"connectedCallback",this).call(this),this._attachNotifOnConnect&&(this._attachNotifOnConnect=!1,this._subscribeNotifications())}},{kind:"method",key:"disconnectedCallback",value:function(){(0,s.Z)((0,a.Z)(i.prototype),"disconnectedCallback",this).call(this),this._unsubNotifications&&(this._attachNotifOnConnect=!0,this._unsubNotifications(),this._unsubNotifications=void 0)}},{kind:"method",key:"render",value:function(){if(!this._show)return n.Ld;const e=this._hasNotifications&&(this.narrow||"always_hidden"===this.hass.dockedSidebar);return n.dy` <ha-icon-button .label="${this.hass.localize("ui.sidebar.sidebar_toggle")}" .path="${"M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z"}" @click="${this._toggleMenu}"></ha-icon-button> ${e?n.dy`<div class="dot"></div>`:""} `}},{kind:"method",key:"firstUpdated",value:function(e){(0,s.Z)((0,a.Z)(i.prototype),"firstUpdated",this).call(this,e),this.hassio&&(this._alwaysVisible=(Number(window.parent.frontendVersion)||0)<20190710)}},{kind:"method",key:"willUpdate",value:function(e){if((0,s.Z)((0,a.Z)(i.prototype),"willUpdate",this).call(this,e),!e.has("narrow")&&!e.has("hass"))return;const t=e.has("hass")?e.get("hass"):this.hass,o=(e.has("narrow")?e.get("narrow"):this.narrow)||"always_hidden"===(null==t?void 0:t.dockedSidebar),n=this.narrow||"always_hidden"===this.hass.dockedSidebar;this.hasUpdated&&o===n||(this._show=n||this._alwaysVisible,n?this._subscribeNotifications():this._unsubNotifications&&(this._unsubNotifications(),this._unsubNotifications=void 0))}},{kind:"method",key:"_subscribeNotifications",value:function(){if(this._unsubNotifications)throw new Error("Already subscribed");this._unsubNotifications=(0,d.r)(this.hass.connection,(e=>{this._hasNotifications=e.length>0}))}},{kind:"method",key:"_toggleMenu",value:function(){(0,c.B)(this,"hass-toggle-menu")}},{kind:"get",static:!0,key:"styles",value:function(){return n.iv`:host{position:relative}.dot{pointer-events:none;position:absolute;background-color:var(--accent-color);width:12px;height:12px;top:9px;right:7px;border-radius:50%;border:2px solid var(--app-header-background-color)}`}}]}}),n.oi)},52039:(e,t,i)=>{i.d(t,{C:()=>n});var o=i(17463),s=i(68144),a=i(79932);let n=(0,o.Z)([(0,a.Mo)("ha-svg-icon")],(function(e,t){return{F:class extends t{constructor(...t){super(...t),e(this)}},d:[{kind:"field",decorators:[(0,a.Cb)()],key:"path",value:void 0},{kind:"field",decorators:[(0,a.Cb)()],key:"viewBox",value:void 0},{kind:"method",key:"render",value:function(){return s.YP` <svg viewBox="${this.viewBox||"0 0 24 24"}" preserveAspectRatio="xMidYMid meet" focusable="false" role="img" aria-hidden="true"> <g> ${this.path?s.YP`<path d="${this.path}"></path>`:""} </g> </svg>`}},{kind:"get",static:!0,key:"styles",value:function(){return s.iv`:host{display:var(--ha-icon-display,inline-flex);align-items:center;justify-content:center;position:relative;vertical-align:middle;fill:currentcolor;width:var(--mdc-icon-size,24px);height:var(--mdc-icon-size,24px)}svg{width:100%;height:100%;pointer-events:none;display:block}`}}]}}),s.oi)},36226:(e,t,i)=>{var o=i(17463),s=i(73968),a=i(71711),n=i(68144),r=i(79932);(0,o.Z)([(0,r.Mo)("ha-top-app-bar-fixed")],(function(e,t){return{F:class extends t{constructor(...t){super(...t),e(this)}},d:[{kind:"field",static:!0,key:"styles",value:()=>[a.W,n.iv`.mdc-top-app-bar__row{height:var(--header-height);border-bottom:var(--app-header-border-bottom)}.mdc-top-app-bar--fixed-adjust{padding-top:var(--header-height)}.mdc-top-app-bar{--mdc-typography-headline6-font-weight:400;color:var(--app-header-text-color,var(--mdc-theme-on-primary,#fff));background-color:var(--app-header-background-color,var(--mdc-theme-primary))}`]}]}}),s.s)},81582:(e,t,i)=>{i.d(t,{DJ:()=>a,LZ:()=>o,Nn:()=>l,Ny:()=>h,Pk:()=>u,Q4:()=>s,RQ:()=>r,SO:()=>c,T0:()=>f,iJ:()=>d,pB:()=>n});const o=32143==i.j?["migration_error","setup_error","setup_retry"]:null,s=32143==i.j?["not_loaded","loaded","setup_error","setup_retry"]:null,a=(e,t,i)=>{const o={type:"config_entries/subscribe"};return i&&i.type&&(o.type_filter=i.type),e.connection.subscribeMessage((e=>t(e)),o)},n=(e,t)=>{const i={};return t&&(t.type&&(i.type_filter=t.type),t.domain&&(i.domain=t.domain)),e.callWS({type:"config_entries/get",...i})},r=(e,t)=>e.callWS({type:"config_entries/get_single",entry_id:t}),c=(e,t,i)=>e.callWS({type:"config_entries/update",entry_id:t,...i}),d=(e,t)=>e.callApi("DELETE",`config/config_entries/entry/${t}`),l=(e,t)=>e.callApi("POST",`config/config_entries/entry/${t}/reload`),h=(e,t)=>e.callWS({type:"config_entries/disable",entry_id:t,disabled_by:"user"}),f=(e,t)=>e.callWS({type:"config_entries/disable",entry_id:t,disabled_by:null}),u=(e,t)=>{const i=[...e],o=e=>{const i=t[e.domain];return"helper"===(null==i?void 0:i.integration_type)?-1:1};return i.sort(((e,t)=>o(t)-o(e)))}},49594:(e,t,i)=>{i.d(t,{g:()=>n});const o=window;"customIconsets"in o||(o.customIconsets={});const s=o.customIconsets,a=window;"customIcons"in a||(a.customIcons={});const n=new Proxy(a.customIcons,{get:(e,t)=>{var i;return null!==(i=e[t])&&void 0!==i?i:s[t]?{getIcon:s[t]}:void 0}})},55424:(e,t,i)=>{i.a(e,(async(e,o)=>{try{i.d(t,{Bm:()=>g,Cj:()=>C,G9:()=>I,Jj:()=>T,KU:()=>Z,P:()=>x,UB:()=>L,ZC:()=>S,_Z:()=>B,b:()=>j,gy:()=>D,iK:()=>k,jB:()=>N,o1:()=>m,rl:()=>w,vE:()=>z,xZ:()=>$,yH:()=>M});var s=i(24112),a=i(32182),n=i(79021),r=i(39244),c=i(59429),d=i(93752),l=i(59699),h=i(97330),f=i(72043),u=i(49684),p=i(92306),b=i(81582),y=i(38014),_=e([u]);u=(_.then?(await _)():_)[0];const v=[],g=()=>({stat_energy_from:"",stat_cost:null,entity_energy_price:null,number_energy_price:null}),m=()=>({stat_energy_to:"",stat_compensation:null,entity_energy_price:null,number_energy_price:null}),k=()=>({type:"grid",flow_from:[],flow_to:[],cost_adjustment_day:0}),w=()=>({type:"solar",stat_energy_from:"",config_entry_solar_forecast:null}),x=()=>({type:"battery",stat_energy_from:"",stat_energy_to:""}),Z=()=>({type:"gas",stat_energy_from:"",stat_cost:null,entity_energy_price:null,number_energy_price:null}),C=()=>({type:"water",stat_energy_from:"",stat_cost:null,entity_energy_price:null,number_energy_price:null}),$=e=>e.callWS({type:"energy/info"}),D=async e=>(await e.loadBackendTranslation("issues","energy"),e.callWS({type:"energy/validate"})),S=e=>e.callWS({type:"energy/get_prefs"}),B=async(e,t)=>{const i=e.callWS({type:"energy/save_prefs",...t});return H(e),i},P=async(e,t,i,o,s,a="hour")=>e.callWS({type:"energy/fossil_energy_consumption",start_time:t.toISOString(),end_time:null==s?void 0:s.toISOString(),energy_statistic_ids:i,co2_statistic_id:o,period:a}),T=e=>(0,p.v)(e.energy_sources,(e=>e.type)),M=(e,t,i)=>{const o=[];for(const s of e.energy_sources)if(!i||i.includes(s.type))if("solar"!==s.type)if("gas"!==s.type&&"water"!==s.type)if("battery"!==s.type){for(const e of s.flow_from){o.push(e.stat_energy_from),e.stat_cost&&o.push(e.stat_cost);const i=t.cost_sensors[e.stat_energy_from];i&&o.push(i)}for(const e of s.flow_to){o.push(e.stat_energy_to),e.stat_compensation&&o.push(e.stat_compensation);const i=t.cost_sensors[e.stat_energy_to];i&&o.push(i)}}else o.push(s.stat_energy_from),o.push(s.stat_energy_to);else{o.push(s.stat_energy_from),s.stat_cost&&o.push(s.stat_cost);const e=t.cost_sensors[s.stat_energy_from];e&&o.push(e)}else o.push(s.stat_energy_from);return o},V=async(e,t,i,o,c)=>{const[d,l]=await Promise.all([(0,b.pB)(e,{domain:"co2signal"}),$(e)]),h=d.length?d[0]:void 0;let f;if(h)for(const t of Object.values(e.entities)){if("co2signal"!==t.platform)continue;const i=e.states[t.entity_id];if(i&&"%"===i.attributes.unit_of_measurement){f=i.entity_id;break}}const u=[];for(const e of t.energy_sources)if("grid"===e.type)for(const t of e.flow_from)u.push(t.stat_energy_from);const p=M(t,l,["grid","solar","battery","gas"]),_=M(t,l,["water"]),v=[...p,..._],g=(0,s.Z)(o||new Date,i),m=g>35?"month":g>2?"day":"hour",k=e.config.unit_system.length||"",w={energy:"kWh",volume:"km"===k?"m³":"ft³"},x={volume:"km"===k?"L":"gal"},Z=p.length?(0,y.dL)(e,i,o,p,m,w,["change"]):{},C=_.length?(0,y.dL)(e,i,o,_,m,x,["change"]):{};let D,S,B,T,V,H={},L={};c&&(S=g>27&&g<32?(0,a.Z)(i,-1):(0,n.Z)(i,-1*(g+1)),B=(0,r.Z)(i,-1),p.length&&(H=(0,y.dL)(e,S,B,p,m,w,["change"])),_.length&&(L=(0,y.dL)(e,S,B,_,m,x,["change"]))),void 0!==f&&(T=P(e,i,u,f,o,g>35?"month":g>2?"day":"hour"),c&&(V=P(e,S,u,f,B,g>35?"month":g>2?"day":"hour")));const N={},A=v.length?(0,y.Py)(e,v):[],[I,z,j,O,E,W,U]=await Promise.all([Z,C,H,L,A,T,V]),F={...I,...z};c&&(D={...j,...O}),v.length&&E.forEach((e=>{N[e.statistic_id]=e}));return{start:i,end:o,startCompare:S,endCompare:B,info:l,prefs:t,stats:F,statsMetadata:N,statsCompare:D,co2SignalConfigEntry:h,co2SignalEntity:f,fossilEnergyConsumption:W,fossilEnergyConsumptionCompare:U}},H=e=>{v.forEach((t=>{const i=L(e,{key:t});i.clearPrefs(),i._active&&i.refresh()}))},L=(e,t={})=>{let i="_energy";if(t.key){if(!t.key.startsWith("energy_"))throw new Error("Key need to start with energy_");i=`_${t.key}`}if(e.connection[i])return e.connection[i];v.push(t.key);const o=(0,h._)(e.connection,i,(async()=>{if(o.prefs||(o.prefs=await S(e)),o._refreshTimeout&&clearTimeout(o._refreshTimeout),o._active&&(!o.end||o.end>new Date)){const e=new Date;e.getMinutes()>=20&&e.setHours(e.getHours()+1),e.setMinutes(20,0,0),o._refreshTimeout=window.setTimeout((()=>o.refresh()),e.getTime()-Date.now())}return V(e,o.prefs,o.start,o.end,o.compare)})),s=o.subscribe;o.subscribe=e=>{const t=s(e);return o._active++,()=>{o._active--,o._active<1&&(clearTimeout(o._refreshTimeout),o._refreshTimeout=void 0),t()}},o._active=0,o.prefs=t.prefs;const a=new Date,r=(0,u.Zs)(a,e.locale,e.config).split(":")[0];o.start=(0,f.A)("0"===r?(0,n.Z)(a,-1):a,c.Z,e.locale,e.config),o.end=(0,f.A)("0"===r?(0,n.Z)(a,-1):a,d.Z,e.locale,e.config);const p=()=>{o._updatePeriodTimeout=window.setTimeout((()=>{o.start=(0,f.A)(new Date,c.Z,e.locale,e.config),o.end=(0,f.A)(new Date,d.Z,e.locale,e.config),p()}),(0,l.Z)((0,f.A)(a,d.Z,e.locale,e.config),1).getTime()-Date.now())};return p(),o.clearPrefs=()=>{o.prefs=void 0},o.setPeriod=(t,i)=>{var s;o.start=t,o.end=i,o.start.getTime()!==(0,f.A)(new Date,c.Z,e.locale,e.config).getTime()||(null===(s=o.end)||void 0===s?void 0:s.getTime())!==(0,f.A)(new Date,d.Z,e.locale,e.config).getTime()||o._updatePeriodTimeout?o._updatePeriodTimeout&&(clearTimeout(o._updatePeriodTimeout),o._updatePeriodTimeout=void 0):p()},o.setCompare=e=>{o.compare=e},o},N=e=>e.callWS({type:"energy/solar_forecast"}),A=["volume","energy"],I=(e,t={},i)=>{for(const o of e.energy_sources){if("gas"!==o.type)continue;if(i&&i===o.stat_energy_from)continue;const e=t[o.stat_energy_from];if(A.includes(null==e?void 0:e.unit_class))return e.unit_class}},z=(e,t,i={})=>{const o=I(t,i);if(void 0!==o)return"energy"===o?"kWh":"km"===e.config.unit_system.length?"m³":"ft³"},j=e=>"km"===e.config.unit_system.length?"L":"gal";o()}catch(e){o(e)}}))},6936:(e,t,i)=>{i.d(t,{r:()=>o});const o=(e,t)=>{const i=new s,o=e.subscribeMessage((e=>t(i.processMessage(e))),{type:"persistent_notification/subscribe"});return()=>{o.then((e=>null==e?void 0:e()))}};class s{constructor(){this.notifications=void 0,this.notifications={}}processMessage(e){if("removed"===e.type)for(const t of Object.keys(e.notifications))delete this.notifications[t];else this.notifications={...this.notifications,...e.notifications};return Object.values(this.notifications)}}},73826:(e,t,i)=>{i.d(t,{f:()=>r});var o=i(17463),s=i(34541),a=i(47838),n=i(79932);const r=e=>(0,o.Z)(null,(function(e,t){class i extends t{constructor(...t){super(...t),e(this)}}return{F:i,d:[{kind:"field",decorators:[(0,n.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",key:"hassSubscribeRequiredHostProps",value:void 0},{kind:"field",key:"__unsubs",value:void 0},{kind:"method",key:"connectedCallback",value:function(){(0,s.Z)((0,a.Z)(i.prototype),"connectedCallback",this).call(this),this.__checkSubscribed()}},{kind:"method",key:"disconnectedCallback",value:function(){if((0,s.Z)((0,a.Z)(i.prototype),"disconnectedCallback",this).call(this),this.__unsubs){for(;this.__unsubs.length;){const e=this.__unsubs.pop();e instanceof Promise?e.then((e=>e())):e()}this.__unsubs=void 0}}},{kind:"method",key:"updated",value:function(e){if((0,s.Z)((0,a.Z)(i.prototype),"updated",this).call(this,e),e.has("hass"))this.__checkSubscribed();else if(this.hassSubscribeRequiredHostProps)for(const t of e.keys())if(this.hassSubscribeRequiredHostProps.includes(t))return void this.__checkSubscribed()}},{kind:"method",key:"hassSubscribe",value:function(){return[]}},{kind:"method",key:"__checkSubscribed",value:function(){var e;void 0!==this.__unsubs||!this.isConnected||void 0===this.hass||null!==(e=this.hassSubscribeRequiredHostProps)&&void 0!==e&&e.some((e=>void 0===this[e]))||(this.__unsubs=this.hassSubscribe())}}]}}),e)},40003:(e,t,i)=>{i.a(e,(async(e,o)=>{try{i.r(t);var s=i(17463),a=i(68144),n=i(79932),r=(i(48932),i(11654)),c=i(23754),d=i(10009),l=(i(36226),e([c,d]));[c,d]=l.then?(await l)():l;const h={views:[{strategy:{type:"energy"}}]};(0,s.Z)([(0,n.Mo)("ha-panel-energy")],(function(e,t){return{F:class extends t{constructor(...t){super(...t),e(this)}},d:[{kind:"field",decorators:[(0,n.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,n.Cb)({type:Boolean,reflect:!0})],key:"narrow",value:void 0},{kind:"field",decorators:[(0,n.SB)()],key:"_viewIndex",value:()=>0},{kind:"field",decorators:[(0,n.SB)()],key:"_lovelace",value:void 0},{kind:"method",key:"willUpdate",value:function(e){if(this.hasUpdated||this.hass.loadFragmentTranslation("lovelace"),!e.has("hass"))return;const t=e.get("hass");(null==t?void 0:t.locale)!==this.hass.locale&&this._setLovelace()}},{kind:"method",key:"updated",value:function(e){e.has("narrow")&&void 0!==e.get("narrow")&&this._reloadView()}},{kind:"method",key:"render",value:function(){return a.dy` <ha-top-app-bar-fixed> <ha-menu-button slot="navigationIcon" .hass="${this.hass}" .narrow="${this.narrow}"></ha-menu-button> <div slot="title">${this.hass.localize("panel.energy")}</div> ${this.narrow?"":a.dy` <hui-energy-period-selector slot="actionItems" .hass="${this.hass}" collectionKey="energy_dashboard" .narrow="${!1}"></hui-energy-period-selector> `} <hui-view .hass="${this.hass}" .narrow="${this.narrow}" .lovelace="${this._lovelace}" .index="${this._viewIndex}" @reload-energy-panel="${this._reloadView}"></hui-view> </ha-top-app-bar-fixed> `}},{kind:"method",key:"_setLovelace",value:function(){this._lovelace={config:h,rawConfig:h,editMode:!1,urlPath:"energy",mode:"generated",locale:this.hass.locale,enableFullEditMode:()=>{},saveConfig:async()=>{},deleteConfig:async()=>{},setEditMode:()=>{}}}},{kind:"method",key:"_reloadView",value:function(){const e=this._lovelace.config;this._lovelace={...this._lovelace,config:{...e,views:[{...e.views[0]}]}}}},{kind:"get",static:!0,key:"styles",value:function(){return[r.Qx,a.iv`hui-energy-period-selector{width:100%;padding-left:16px;padding-inline-start:16px;--disabled-text-color:rgba(var(--rgb-text-primary-color), 0.5);direction:var(--direction)}`]}}]}}),a.oi);o()}catch(e){o(e)}}))},23754:(e,t,i)=>{i.a(e,(async(e,t)=>{try{var o=i(17463),s=i(34541),a=i(47838),n=(i(14271),i(27088)),r=i(82045),c=i(70390),d=i(59429),l=i(59401),h=i(13250),f=i(69388),u=i(79021),p=i(33651),b=i(32182),y=i(27605),_=i(93752),v=i(59281),g=i(1905),m=i(70451),k=i(24112),w=i(68144),x=i(79932),Z=i(72043),C=i(26410),$=i(12198),D=i(70518),S=i(87744),B=(i(42657),i(10983),i(14471),i(17623),i(55424)),P=i(73826),T=e([C,$,B]);[C,$,B]=T.then?(await T)():T;const M="M19,3H14V5H19V18L14,12V21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3M10,18H5L10,12M10,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H10V23H12V1H10V3Z",V="M19 5H14V3H19C20.1 3 21 3.9 21 5V13.4C20.4 13.2 19.7 13 19 13V5M10 1H12V23H10V21H5C3.9 21 3 20.1 3 19V5C3 3.9 3.9 3 5 3H10V1M10 12L5 18H10V12M15.7 14L14 12V15.7C14.4 15 15 14.5 15.7 14M21.1 15.5L19 17.6L16.9 15.5L15.5 16.9L17.6 19L15.5 21.1L16.9 22.5L19 20.4L21.1 22.5L22.5 21.1L20.4 19L22.5 16.9L21.1 15.5Z";(0,o.Z)([(0,x.Mo)("hui-energy-period-selector")],(function(e,t){class i extends t{constructor(...t){super(...t),e(this)}}return{F:i,d:[{kind:"field",decorators:[(0,x.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,x.Cb)()],key:"collectionKey",value:void 0},{kind:"field",decorators:[(0,x.Cb)({type:Boolean,reflect:!0})],key:"narrow",value:void 0},{kind:"field",decorators:[(0,x.SB)()],key:"_startDate",value:void 0},{kind:"field",decorators:[(0,x.SB)()],key:"_endDate",value:void 0},{kind:"field",decorators:[(0,x.SB)()],key:"_period",value:void 0},{kind:"field",decorators:[(0,x.SB)()],key:"_compare",value:()=>!1},{kind:"method",key:"connectedCallback",value:function(){(0,s.Z)((0,a.Z)(i.prototype),"connectedCallback",this).call(this),!1!==this.narrow&&(0,D.X)(this,"narrow",this.offsetWidth<600)}},{kind:"method",key:"hassSubscribe",value:function(){return[(0,B.UB)(this.hass,{key:this.collectionKey}).subscribe((e=>this._updateDates(e)))]}},{kind:"method",key:"render",value:function(){if(!this.hass||!this._startDate)return w.Ld;const e=[{label:this.hass.localize("ui.panel.lovelace.components.energy_period_selector.day"),value:"day"},{label:this.hass.localize("ui.panel.lovelace.components.energy_period_selector.week"),value:"week"},{label:this.hass.localize("ui.panel.lovelace.components.energy_period_selector.month"),value:"month"},{label:this.hass.localize("ui.panel.lovelace.components.energy_period_selector.year"),value:"year"}];return w.dy` <div class="row"> <div class="label"> ${"day"===this._period?(0,$.p6)(this._startDate,this.hass.locale,this.hass.config):"month"===this._period?(0,$.NC)(this._startDate,this.hass.locale,this.hass.config):"year"===this._period?(0,$.yQ)(this._startDate,this.hass.locale,this.hass.config):`${(0,$.mn)(this._startDate,this.hass.locale,this.hass.config)} – ${(0,$.mn)(this._endDate||new Date,this.hass.locale,this.hass.config)}`} <ha-icon-button-prev .label="${this.hass.localize("ui.panel.lovelace.components.energy_period_selector.previous")}" @click="${this._pickPrevious}"></ha-icon-button-prev> <ha-icon-button-next .label="${this.hass.localize("ui.panel.lovelace.components.energy_period_selector.next")}" @click="${this._pickNext}"></ha-icon-button-next> <mwc-button dense outlined @click="${this._pickToday}"> ${this.hass.localize("ui.panel.lovelace.components.energy_period_selector.today")} </mwc-button> </div> <div class="period"> <ha-button-toggle-group .buttons="${e}" .active="${this._period}" dense @value-changed="${this._handleView}" .dir="${(0,S.Zu)(this.hass)}"></ha-button-toggle-group> ${this.narrow?w.dy`<ha-icon-button class="compare ${this._compare?"active":""}" .path="${this._compare?V:M}" @click="${this._toggleCompare}" dense outlined> ${this.hass.localize("ui.panel.lovelace.components.energy_period_selector.compare")} </ha-icon-button>`:w.dy`<mwc-button class="compare ${this._compare?"active":""}" @click="${this._toggleCompare}" dense outlined> ${this.hass.localize("ui.panel.lovelace.components.energy_period_selector.compare")} </mwc-button>`} </div> </div> `}},{kind:"method",key:"_handleView",value:function(e){this._period=e.detail.value;const t=(0,n.Z)(),i=!this._startDate||(0,r.Z)(t,{start:this._startDate,end:this._endDate||(0,c.Z)()})?t:this._startDate,o=(0,C.Bt)(this.hass.locale);this._setDate("day"===this._period?(0,Z.A)(i,d.Z,this.hass.locale,this.hass.config):"week"===this._period?(0,Z.A)(i,l.Z,this.hass.locale,this.hass.config,{weekStartsOn:o}):"month"===this._period?(0,Z.A)(i,h.Z,this.hass.locale,this.hass.config):(0,Z.A)(i,f.Z,this.hass.locale,this.hass.config))}},{kind:"method",key:"_pickToday",value:function(){const e=(0,C.Bt)(this.hass.locale);this._setDate("day"===this._period?(0,Z.A)(new Date,d.Z,this.hass.locale,this.hass.config):"week"===this._period?(0,Z.A)(new Date,l.Z,this.hass.locale,this.hass.config,{weekStartsOn:e}):"month"===this._period?(0,Z.A)(new Date,h.Z,this.hass.locale,this.hass.config):(0,Z.A)(new Date,f.Z,this.hass.locale,this.hass.config))}},{kind:"method",key:"_pickPrevious",value:function(){const e="day"===this._period?(0,u.Z)(this._startDate,-1):"week"===this._period?(0,p.Z)(this._startDate,-1):"month"===this._period?(0,b.Z)(this._startDate,-1):(0,y.Z)(this._startDate,-1);this._setDate(e)}},{kind:"method",key:"_pickNext",value:function(){const e="day"===this._period?(0,u.Z)(this._startDate,1):"week"===this._period?(0,p.Z)(this._startDate,1):"month"===this._period?(0,b.Z)(this._startDate,1):(0,y.Z)(this._startDate,1);this._setDate(e)}},{kind:"method",key:"_setDate",value:function(e){const t=(0,C.Bt)(this.hass.locale),i="day"===this._period?(0,Z.A)(e,_.Z,this.hass.locale,this.hass.config):"week"===this._period?(0,Z.A)(e,v.Z,this.hass.locale,this.hass.config,{weekStartsOn:t}):"month"===this._period?(0,Z.A)(e,g.Z,this.hass.locale,this.hass.config):(0,Z.A)(e,m.Z,this.hass.locale,this.hass.config),o=(0,B.UB)(this.hass,{key:this.collectionKey});o.setPeriod(e,i),o.refresh()}},{kind:"method",key:"_updateDates",value:function(e){this._compare=void 0!==e.startCompare,this._startDate=e.start,this._endDate=e.end||(0,c.Z)();const t=(0,k.Z)(this._endDate,this._startDate);this._period=t<1?"day":6===t?"week":t>26&&t<31?"month":364===t||365===t?"year":void 0}},{kind:"method",key:"_toggleCompare",value:function(){this._compare=!this._compare;const e=(0,B.UB)(this.hass,{key:this.collectionKey});e.setCompare(this._compare),e.refresh()}},{kind:"get",static:!0,key:"styles",value:function(){return w.iv`.row{display:flex;justify-content:flex-end}:host([narrow]) .row{flex-direction:column-reverse}.label{display:flex;justify-content:flex-end;align-items:center;font-size:20px}.period{display:flex;flex-wrap:wrap;justify-content:flex-end;align-items:center}:host([narrow]) .period{margin-bottom:8px}mwc-button{margin-left:8px}ha-icon-button{margin-left:4px;--mdc-icon-size:20px}ha-icon-button.active::before,mwc-button.active::before{top:0;left:0;width:100%;height:100%;position:absolute;background-color:currentColor;opacity:0;pointer-events:none;content:"";transition:opacity 15ms linear,background-color 15ms linear;opacity:var(--mdc-icon-button-ripple-opacity,.12)}ha-icon-button.active::before{border-radius:50%}.compare{position:relative}:host{--mdc-button-outline-color:currentColor;--primary-color:currentColor;--mdc-theme-primary:currentColor;--mdc-theme-on-primary:currentColor;--mdc-button-disabled-outline-color:var(--disabled-text-color);--mdc-button-disabled-ink-color:var(--disabled-text-color);--mdc-icon-button-ripple-opacity:0.2}ha-icon-button{--mdc-icon-button-size:28px}ha-button-toggle-group{padding-left:8px;padding-inline-start:8px;direction:var(--direction)}mwc-button{flex-shrink:0}`}}]}}),(0,P.f)(w.oi));t()}catch(e){t(e)}}))}};
//# sourceMappingURL=20123-nq7vAHz15mw.js.map