â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘áµ‰Ë¢â·Ë¢           SHELL PARAMETER              î‚¿ expansion exm. î‚¿ param  î‚¿ param  î‚¿ param is â•‘
â•‘             EXPANSION (bash v5.0)           î‚¿ EXPR â†“  OUTP â†˜ î‚¿  =1486 î‚¿  =null î‚¿  unset  â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ if param is emptyÂ¹,              Use Default â”‚ ${param:-2023} â”‚  1486  â”‚  2023  â”‚  2023  â•‘ Â¹ the first form with ":"
â•‘ put default value instead                    â”‚ ${param-2023}  â”‚  1486  â”‚  null  â”‚  2023  â•‘   treats  as  empty  both 
â•‘â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•‘   unset vars,  as well as
â•‘ if param is empty,            Assign Default â”‚ ${param:=2023} â”‚  1486  â”‚  2023  â”‚  2023  â•‘   zero-length strings (or 
â•‘ set param=default and put it                 â”‚ ${param=2023}  â”‚  1486  â”‚  null  â”‚  2023  â•‘   nulls); the second form
â•‘â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•‘   replaces only unset va- 
â•‘ if param is empty,               Throw Error â”‚ ${param:?ERRO} â”‚  1486  â”‚  ERRO  â”‚  ERRO  â•‘   riables, while 0-length 
â•‘ echo error_msg and exit                      â”‚ ${param?ERRO}  â”‚  1486  â”‚  null  â”‚  ERRO  â•‘   strings are kept as is.
â•‘â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•‘
â•‘ if param is NOT empty,       Use Alternative â”‚ ${param:+0000} â”‚  0000  â”‚  null  â”‚  null  â•‘ Â²áµƒ pattern starting with
â•‘ put alter value instead                      â”‚ ${param+0000}  â”‚  0000  â”‚  0000  â”‚  null  â•‘    "#" must match at the
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£    start of expan. value;
â•‘ ${param:offset}        â”‚ ${param/pattern/string} â”‚ ${!name[@]}     â”‚ ${!prefix*}         â•‘ Â²áµ‡ pattern starting with
â•‘ ${param:offset:length} â”‚    Pattern substitutionÂ²â”‚ ${!name[*]}     â”‚ ${!prefix@}         â•‘    "%" must match at the
â•‘    Substring Expansion â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ Array keys list â”‚ Names match. prefix â•‘    end of expanded value.
â•‘â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ ${#param}               â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•‘
â•‘ ${param#pattern}       â”‚        Parameter length â”‚ ${param@operator}           Parameter â•‘ Â³ "^" converts  the  case
â•‘ ${param##pattern}      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                        transformation â•‘   of first character from
â•‘   Remove match. prefix â”‚ ${param^pattern}        â”‚ Q â”‚ in form for input                 â•‘   each  match  from lower
â•‘â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ ${param^^pattern}       â”‚ E â”‚ \ escape seq. expansion           â•‘   case to upper; "," does
â•‘ ${param%pattern}       â”‚ ${param,pattern}        â”‚ a â”‚ param attributes                  â•‘   the same but from upper
â•‘ ${param%%pattern}      â”‚ ${param,,pattern}       â”‚ A â”‚ in form for assignment     â•”â•â•â•â•â•â•â•   case to  lower; whereas
â•‘   Remove match. suffix â”‚       Case modificationÂ³â”‚ P â”‚ prompt string expansion    â•‘ áµ£â‚‘áµ¥39    "doubled" versions con-
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• Ë¢áµ‰áµ–23    vert the whole matches.
([â•‘â”‚â”¤]?\s+)([A-Zb-z]\b|(na|tra|[A-Z])[A-Za-z0-9. -]+|(?<=â”‚ )a(?= â”‚))		\1[97;1m\2[39;22m
(\$\{)([^${}]+)(\})			[33m\1[39m\2[33m\3[39m
([^[])([@*]+)				\1[35;1m\2[39;22m
(\[)([*@])(\])				[93m\1[97m\2[93m\3
(param)						[97m\1[39m
([!:#%/^+?\\]|-\b|,+\b)		[35;1m\1[39;22m
(\")(.)(\")					\1[35;3;1m\2[39;23m\3
(pattern|name|offset|operator|default|alter)|(string|prefix|length)([^ .])		[34;4m\1\2[39;24m\3
(error_msg)					[31;4m\1[39;24m
(ERROR?)					[91;1m\1[39;22m
1486						[95m1487[39m
(null)						[3;2m\1[22;23m
(unset)						[3;2m\1[22;23m
([Â¹Â²Â³])						[1;97m\1[22;39m
([â”‚â”€â”Œâ”¬â”â”œâ”¼â”¤â””â”´â”˜â•·î‚¿]+)			[37;2m\1[22;39m
([â•‘â•â•¤â•§â•ªâ• â•Ÿâ•¢â•”â•¦â•—â• â•¬â•£â•šâ•©â•]+)		[97;1m\1[22;39m
([â•‘â•â•”â• â•š]+)(.+)([â•—â•£â•â•‘â”‚])		[48;5;16m\1\2\3[m
(áµ£â‚‘áµ¥..)						[2m\1[22m
(Ë¢áµ‰áµ–)(..)					[53m\1\2[55m


#!/usr/bin/bash
# ------------------------------------------------------------------------------
# es7s/core (G1/legacy)
# (c) 2022-2023 A. Shavykin <0.delameter@gmail.com>
# -----------------------------------------------------------------------------
# shellcheck disable=SC2119,SC2016
# shellcheck source=../../data/es7s-shell-commons.sh
#__E7SL() { local c="$(realpath "$(dirname "$(readlink -f "$0")")")" ; local l=\
#"es7s-shell-commons.sh" ; local p=( "$ES7S_SHELL_COMMONS" "$HOME/.es7s/data/$l"
#"$c/../$l" ); while [[ ! $(type -t __es7s_com) =~ ^fu ]];do [[ -f "${p[0]}" ]]\
#&& source "${p[0]}"; p=("${p[@]:1}"); [[ "${#p[@]}" -gt 0 ]] && continue; echo\
#'ERROR: es7s/commons is missing (ES7S_SHELL_COMMONS)'; exit 57; done } ; __E7SL
## ------------------------------------------------------------- loader v.3B ---

#[[ $* =~ --help ]] && exit 0
#[[ $# -gt 0 ]] && echo "No arguments allowed" && exit 2
#
#function pvalue() {
#    local v="$*"
#    [[ -z $v ]] && echo "$nullstr" || echo "$v"
#}
#function try_1() {
#    if (pvalue "${!1?$2}") 2> /dev/null ; then return ; fi
#    pvalue "$2"
# }
#function try_2() {
#    if (pvalue "${!1:?$2}") 2> /dev/null ; then return ; fi
#    pvalue "$2"
# }
## -----------------------------------------------------------------------------
#C_RST=$_f
#C_BOLD=$(_cs $I_BOLD)
#C_ULINE=$(_cs $I_UNDERL)
#function _mr() { echo     "$(_m "$IH_RED" ${*})" ; }
#function _my() { echo  "$(_m "$IH_YELLOW" ${*})" ; }
#function _mg() { echo   "$(_m "$IH_GREEN" ${*})" ; }
#function _mb() { echo    "$(_m "$IH_BLUE" ${*})" ; }
#function _mm() { echo "$(_m "$IH_MAGNETA" ${*})" ; }
#function  _m() { echo          "$(_cs ${1})${*:2}${C_RST}" ; }
#function  _i() { echo  "$(_cs ${1}  $I_INV)${*:2}${C_RST}" ; }
#function  _b() { echo  "$(_cs ${1} $I_BOLD)${*:2}${C_RST}" ; }
#function  _c() { echo "$(alignc ${1} "${*:2}")" ; }
#function  _l() { echo "$(alignl ${1} "${*:2}")" ; }
#function  _r() { echo "$(alignr ${1} "${*:2}")" ; }
#C_TABLE=$(_cs $IH_GRAY )
#pl_sc=$(_b "$I_MAGNETA" ':')
#mn_sc=$(_b "$I_MAGNETA" ':')
#eq_sc=$(_b "$I_MAGNETA" ':')
#qs_sc=$(_b "$I_MAGNETA" ':')
#pl_op=$(_b "$I_MAGNETA" '+')
#mn_op=$(_b "$I_MAGNETA" '-')
#eq_op=$(_b "$I_MAGNETA" '=')
#qs_op=$(_b "$I_MAGNETA" '?')
#pl_param=$(_mb "alt_v")
#mn_param=$(_my "def_v")
#eq_param=$(_mg "def_v")
#qs_param=$(_mr "err_v")
#nullstr=$(_m "37 3" "null")
#pl_p=$(_mb "A")
#mn_p=$(_my "D")
#eq_p=$(_mg "D")
#qs_p=$(_mr "E")
#v=$(_mm 1486)
#vnull=$(_m "3 37" "(null)")
#vunset=$(_m "3 37" "(unset)")
#p_v=param=
#p_e=param=
#expct=$(_mr "err_v")
#p_ns=$'\u2205'
## -----------------------------------------------------------------------------
#a=$(_mm 1486)
#b=
#unset c
## -----------------------------------------------------------------------------
#printf "$C_TABLE"'â•” %---------58s â•¤ %-27s â•—' '' '' | sed "s/ /â•/g"
#
#printf "\n$C_TABLE"'â•‘ %---------58s â”‚ %-27s â•‘' "$(_c 58 "${C_RST}${_b}Shell parameter${_f}$C_TABLE")" \
#                                                               "$(_l 27 "param=")"
#
#printf "\n$C_TABLE"'â•‘ %---------58s â”‚ %-7s â”‚ %-7s â”‚ %-7s â•‘' "$(_c 58 "${C_RST}${_b}expansion (bash)${_f}$C_TABLE")" "$C_RST$(_r 7 "$v")$C_TABLE"\
#                                                               "$C_RST$(_r 7 "$vnull")$C_TABLE"\
#                                                               "$C_RST$(_r 7 "$vunset")$C_TABLE"
#
#printf "\n$C_TABLE"'â•Ÿ %--36s   %-20sâ”¼ %-7s â”¼ %-7s â”¼ %-7s â•¢' '' '' '' '' '' | sed "s/ /â”€/g"
#
#printf "\n$C_TABLE"'â•‘ %--36s     %-20s%-7s â”‚ %-7s â”‚ %-7s â•‘'  "$C_RST$(_l 36 "${C_BOLD}Use Default:${C_RST} if unset ($mn_op) or empty ($mn_sc$mn_op),")"\
#                                                             "$(_r 20 "\${${C_TABLE}param${C_RST}$mn_op$mn_param}${C_TABLE}=>${C_RST}")"\
#                                                             "$C_RST$(_r 7 "$(pvalue ${a-$mn_param})")$C_TABLE"\
#                                                             "$C_RST$(_r 7 "$(pvalue ${b-$mn_param})")$C_TABLE"\
#                                                             "$C_RST$(_r 7 "$(pvalue ${c-$mn_param})")$C_TABLE"
#
#printf "\n$C_TABLE"'â•‘ %--36s     %-20s%-7s â”‚ %-7s â”‚ %-7s â•‘'  "$C_RST$(_l 36 ", use $(_my "def_v") instead")"\
#                                                             "$(_r 20 "\${${C_TABLE}param${C_RST}$mn_sc$mn_op$mn_param}${C_TABLE}=>${C_RST}")$C_TABLE"\
#                                                             "$C_RST$(_r 7 "$(pvalue "${a:-$mn_param}")")$C_TABLE"\
#                                                             "$C_RST$(_r 7 "$(pvalue "${b:-$mn_param}")")$C_TABLE"\
#                                                             "$C_RST$(_r 7 "$(pvalue "${c:-$mn_param}")")$C_TABLE"
#
#printf "\n$C_TABLE"'â•Ÿ %--36s   %-20sâ”¼ %-7s â”¼ %-7s â”¼ %-7s â•¢' '' | sed "s/ /â”€/g"
#
#printf "\n$C_TABLE"'â•‘ %--36s  %-20s%-7s â”‚ %-7s â”‚ %-7s â•‘'  "$C_RST$(_l 36 "${C_BOLD}Assign Default:${C_RST} if unset ($eq_op) or empty ($eq_sc$eq_op),")"\
#                                                             "$(_r 20 "\${${C_TABLE}param${C_RST}$eq_op$eq_param}${C_TABLE}=>${C_RST}")"\
#                                                             "$C_RST$(_r 7 "$(pvalue "${a=$eq_param}")")$C_TABLE"\
#                                                             "$C_RST$(_r 7 "$(pvalue "${b=$eq_param}")")$C_TABLE"\
#                                                             "$C_RST$(_r 7 "$(pvalue "${c=$eq_param}")")$C_TABLE"
#
#printf "\n$C_TABLE"'â•‘ %--36s     %--20s%-7s â”‚ %-7s â”‚ %-7s â•‘'  "$C_RST$(_l 36 "${C_BOLD}$(_mg assign)${C_RST} param=$(_mg def_v) and use")"\
#                                                              "$(_r 20 "\${${C_TABLE}param${C_RST}$eq_sc$eq_op$eq_param}${C_TABLE}=>${C_RST}")"\
#                                                              "$C_RST$(_r 7 "$(pvalue "${a:=$eq_param}")")$C_TABLE"\
#                                                              "$C_RST$(_r 7 "$(pvalue "${b:=$eq_param}")")$C_TABLE"\
#                                                              "$C_RST$(_r 7 "$(pvalue "${c:=$eq_param}")")$C_TABLE"
#
#printf "\n$C_TABLE"'â•Ÿ %---------58s â”¼ %-7s â”¼ %-7s â”¼ %-7s â•¢' '' | sed "s/ /â”€/g"
#
#printf "\n$C_TABLE"'â•‘ %--36s     %-20s%-7s â”‚ %-7s â”‚ %-7s â•‘'  "$C_RST$(_l 36 "${C_BOLD}Throw Error:${C_RST} if unset ($qs_op) or empty ($qs_sc$qs_op),")"\
#                                                             "$(_r 20 "\${${C_TABLE}param${C_RST}$qs_op$qs_param}${C_TABLE}=>${C_RST}")"\
#                                                             "$C_RST$(_r 7 "$(try_1 "a" "$qs_param")")$C_TABLE"\
#                                                             "$C_RST$(_r 7 "$(try_1 "b" "$qs_param")")$C_TABLE"\
#                                                             "$C_RST$(_r 7 "$(try_1 "c" "$qs_param")")$C_TABLE"
#
#printf "\n$C_TABLE"'â•‘ %--36s     %-20s%-7s â”‚ %-7s â”‚ %-7s â•‘'  "$C_RST$(_l 36 ", print $(_m "$IH_RED" 'err_v') and ${C_BOLD}$(_m "$IH_RED" 'exit')${C_RST}")"\
#                                                             "$(_r 20 "\${${C_TABLE}param${C_RST}$qs_sc$qs_op$qs_param}${C_TABLE}=>${C_RST}")"\
#                                                             "$C_RST$(_r 7 "$(try_2 "a" $qs_param)")$C_TABLE"\
#                                                             "$C_RST$(_r 7 "$(try_2 "b" $qs_param)")$C_TABLE"\
#                                                             "$C_RST$(_r 7 "$(try_2 "c" $qs_param)")$C_TABLE"
#
#printf "\n$C_TABLE"'â•Ÿ %------ --58s â”¼ %-7s â”¼ %-7s â”¼ %-7s â•¢' '' | sed "s/ /â”€/g"
#
#printf "\n$C_TABLE"'â•‘ %--36s%-20s%-7s â”‚ %-7s â”‚ %-7s â•‘'  "$C_RST$(_l 36 "${C_BOLD}Use Alternative:${C_RST} if unset ($pl_op) or empty ($pl_sc$pl_op)")" \
#                                                             "$(_r 18 "\${${C_TABLE}param${C_RST}$pl_op$pl_param}${C_TABLE}=>${C_RST}")"\
#                                                             "$C_RST$(_r 7 "$(pvalue "${a+$pl_param}")")$C_TABLE"\
#                                                             "$C_RST$(_r 7 "$(pvalue "${b+$pl_param}")")$C_TABLE"\
#                                                             "$C_RST$(_r 7 "$(pvalue "${c+$pl_param}")")$C_TABLE"
#
#printf "\n$C_TABLE"'â•‘ %--36s %-20s%-7s â”‚ %-7s â”‚ %-7s â•‘'  "$C_RST$(_r 36 "use $nullstr; ${C_BOLD}$(_m "$IH_BLUE" 'otherwise')${C_RST} use $(_mb alt_v)")"\
#                                                             "$(_r 19 "\${${C_TABLE}param${C_RST}$pl_sc$pl_op$pl_param}${C_TABLE}=>${C_RST}")"\
#                                                             "$C_RST$(_r 7 "$(pvalue "${a:+$pl_param}")")$C_TABLE"\
#                                                             "$C_RST$(_r 7 "$(pvalue "${b:+$pl_param}")")$C_TABLE"\
#                                                             "$C_RST$(_r 7 "$(pvalue "${c:+$pl_param}")")$C_TABLE"
#printn
# -----------------------------------------------------------------------------
